[
["index.html", "SSD PINT analyses Chapter 1 The index page", " SSD PINT analyses Erin Dickie 2020-02-13 Chapter 1 The index page "],
["mangle-participant-demographics.html", "Chapter 2 Mangle participant demographics 2.1 Coding ZHH data by session 2.2 Note - re picking motion cutoffs 2.3 Now looking at what we have from COBRE 2.4 Now looking at the CNP we have.. 2.5 add where are is the CMH demographic info.. 2.6 extra little bit for traking down “missing” COBRE", " Chapter 2 Mangle participant demographics 2.0.0.1 Note: this chapter uses the resticted (unshared) phenotypic data. So can only be run on a CAMH computer.. We output the file data/phenotypic/simple_pheno_20200202.csv which is carrier forward to the next script.. The code chunks below where run on the kimel lab system and not only echo when rest of the notebooks are run.. (i.e. eval = FALSE) and now it starts let’s get some idea of what data we have There are now Four/ish Center’s sites from which we are pooling data for this project CAMH data (pooling across ASDD, RTMSWM, PNSC, SPINS studies..) COBRE data CNP data ZHH older data For all sites we want: the preprosessed data the MRIQC metrics scanner age sex education diagnosis 2.0.0.2 Starting with ZHH library(foreign) library(tidyverse) library(readxl) library(here) ZHH_SZ = read.spss(here(&#39;data/raw/restricted_pheno/ZHH/phenotypic/Patient\\ Sample\\ 7-30-18.sav&#39;), to.data.frame=TRUE) ZHH_CRTL = read.spss(here(&#39;data/raw/restricted_pheno/ZHH/phenotypic/Control Sample 7-30-18.sav&#39;), to.data.frame=TRUE) qryHC_NewResting_15_40 &lt;- read_excel(here(&quot;data/raw/restricted_pheno/ZHH/demographics/qryHC_NewResting_15-40.xlsx&quot;)) Putting together the simplest stuff vars_from_both &lt;- c(&quot;GRID&quot;, &quot;SessNo&quot;,&quot;MRI_Date&quot;, &quot;Age&quot;, &quot;Sex&quot;, &quot;DX&quot;, &quot;Edu&quot;) mangle_CTRL_ZHH &lt;- qryHC_NewResting_15_40 %&gt;% select(SessNo, sex) %&gt;% right_join(ZHH_CRTL, by = &quot;SessNo&quot;) %&gt;% mutate(Sex = factor(sex, levels = c(1,2), labels = c(&quot;M&quot;, &quot;F&quot;)), DX = &quot;CTRL&quot;, Edu = EducatPtHighest) %&gt;% select(one_of(vars_from_both)) mangle_SZ_ZHH &lt;- ZHH_SZ %&gt;% mutate(GRID = grid, Sex = factor(sex, levels = c(&quot;male&quot;, &quot;female&quot;), labels = c(&quot;M&quot;, &quot;F&quot;)), DX = &quot;SSD&quot;, Edu = EducationPatient) %&gt;% rename(isFEP = Type) %&gt;% select(one_of(vars_from_both), isFEP) ZHH_pheno &lt;-bind_rows(mangle_SZ_ZHH, mangle_CTRL_ZHH) %&gt;% rename(zhh_session_id = SessNo) %&gt;% mutate(subject = str_c(&#39;sub-&#39;,GRID), dataset = &quot;ZHH&quot;, Site = &quot;ZHH&quot;, Scanner = &quot;ZHH&quot;) rm(mangle_CTRL_ZHH, mangle_SZ_ZHH) GRIDs_w_cerebellum_cutoff &lt;- c(7793, 7834, 9405) 2.1 Coding ZHH data by session When the ZHH data was converted to BIDS, we renamed the session ids in order. But the phenotypic data we have is coded by the original session ids. So lets map the original session ids to the ZHH data. Note: looking at Dayton’s scripts - he first joined the participants demographics witha list of what scans we have available.. then he sorted , within participant, by GRID session id and labeled those in orders (i.e 01, 02, 03 etc.) orig_rest_HC &lt;- tibble(files = list.files(here(&#39;data/raw/restricted_pheno/ZHH/raw/HC/rsfmri/&#39;))) %&gt;% separate(files, into = c(&#39;SessNo&#39;, &#39;therest&#39;) , sep = &#39;_&#39;, extra = &quot;merge&quot;) orig_T1w_HC &lt;- tibble(files = list.files(here(&#39;data/raw/restricted_pheno/ZHH/raw/HC/struct/&#39;))) %&gt;% separate(files, into = c(&#39;SessNo&#39;, &#39;therest&#39;) , sep = &#39;_&#39;, extra = &quot;merge&quot;) orig_rest_SZ &lt;- tibble(files = list.files(here(&#39;data/raw/restricted_pheno/ZHH/raw/SCZ/rsfmri/&#39;))) %&gt;% separate(files, into = c(&#39;SessNo&#39;, &#39;therest&#39;) , sep = &#39;_&#39;, extra = &quot;merge&quot;) orig_T1w_SZ &lt;- tibble(files = list.files(here(&#39;data/raw/restricted_pheno/ZHH/raw/SCZ/struct/&#39;))) %&gt;% separate(files, into = c(&#39;SessNo&#39;, &#39;therest&#39;) , sep = &#39;_&#39;, extra = &quot;merge&quot;) orig_rest_both = bind_rows(orig_rest_HC, orig_rest_SZ) orig_T1w_both = bind_rows(orig_T1w_HC, orig_T1w_SZ) orig_both = inner_join(orig_rest_both, orig_T1w_both, by = &quot;SessNo&quot;) 2.1.0.1 the COBRE cohort cobre_participants &lt;- read_delim(here(&quot;data/raw/phenotypic/cobre_participants.tsv&quot;), &quot;\\t&quot;, escape_double = FALSE, trim_ws = TRUE) %&gt;% rename(Age = age) %&gt;% mutate(Sex = case_when( gender == &quot;male&quot; ~ &quot;M&quot;, gender == &quot;female&quot; ~ &quot;F&quot;), DX = case_when(diagnosis == &quot;Schizophrenia_Strict&quot; ~ &quot;SSD&quot;, diagnosis == &quot;Schizoaffective&quot; ~ &quot;SSD&quot;, diagnosis == &quot;No_Known_Disorder&quot; ~ &quot;CTRL&quot;), dataset = &quot;COBRE&quot;, Site = &quot;COBRE&quot;, subject = str_c(&#39;sub-&#39;, subjectid), Scanner = &quot;COBRE&quot;) %&gt;% select(subject, Age, Sex, DX, dataset, Site, Scanner) 2.1.0.2 the ds00030 cohort This dems were read from teh participants.tsv distributed with the ds000030_R1.0.5 release on openmri.org. ds00030_participants &lt;- read_delim(here(&quot;data/raw/bids/ds000030/participants.tsv&quot;), &quot;\\t&quot;, escape_double = FALSE, trim_ws = TRUE) %&gt;% filter(T1w != &quot;n/a&quot;, rest != &quot;n/a&quot;, diagnosis %in% c(&quot;CONTROL&quot;, &quot;SCHZ&quot;)) %&gt;% rename(Sex = gender, subject = participant_id) %&gt;% mutate(DX = case_when(diagnosis == &quot;CONTROL&quot; ~ &quot;CTRL&quot;, diagnosis == &quot;SCHZ&quot; ~ &quot;SSD&quot;), dataset = &quot;ds000030_R1.0.5&quot;, Site = &quot;ds000030&quot;, Scanner = str_c(&quot;ds000030&quot;, ScannerSerialNumber), Age = age) %&gt;% select(subject, Age, DX, Sex, Scanner, ghost_NoGhost, dataset, Site) 2.1.0.3 the CAMH cohorts old_pheno &lt;- read_csv(here(&quot;/data/raw/phenotypic/NEWallSubjects_completeData3_DM_not_sexmatched.csv&quot;)) CMH_pheno &lt;- old_pheno %&gt;% filter(site == 1) %&gt;% separate(subid, into = c(&quot;Study&quot;, &quot;Site&quot;, &quot;SUBJ&quot;, &quot;cmh_session_id&quot;)) %&gt;% unite(subject_id, Site, SUBJ, sep = &quot;&quot;) %&gt;% mutate(DX = case_when(DX_GROUP == 2 ~ &quot;CTRL&quot;, DX_GROUP == 1 ~ &quot;SSD&quot;), Sex = case_when(sex.x == 1 ~ &quot;M&quot;, sex.x == 2 ~ &quot;F&quot;), dataset = case_when(Study == &quot;SPN01&quot; ~ &quot;SPINS&quot;, Study == &quot;RTMSWM&quot; ~ &quot;RTMSWM&quot;, Study == &quot;ASDD&quot; ~ &quot;ASDD&quot;, Study == &quot;DTI&quot; ~ &quot;DTI3T&quot;, Study == &quot;PNS&quot; ~ &quot;PNSC&quot;), subject = str_c(&quot;sub-&quot;, subject_id), Scanner = &quot;CMH&quot;, Site = &quot;CMH&quot;, Age = age) %&gt;% select(subject, cmh_session_id, DX, Age, Sex, dataset, Site, Scanner) 2.1.0.4 Combine and write out simple_pheno = bind_rows(CMH_pheno, ZHH_pheno, ds00030_participants, cobre_participants) write_csv(simple_pheno, here(&quot;data/processed/pheno/simple_pheno_20200202.csv&quot;)) 2.2 Note - re picking motion cutoffs Based on our looking at the mriqc outputs, any visual QC issues are associated with high motion (mean fd &gt; 0.6mm percent &gt; 48%) 2.3 Now looking at what we have from COBRE From the COBRE data dictionary we see that: CODEM_6: Highest Level of Education for Primary Caretaker until 18 years old CODEM_7: Highest Level of Education for Secondary Caretaker until subject was 18 years old There is also a smoking scale and hours of sleep night before scan There is a medictions scale as well (COMED) And a PANSS Neuropsych includes the (CNP cols) WTAR, WASI, and Matrics.. 2.4 Now looking at the CNP we have.. wais, sans, medication, bprs, education, smoking status. cpt 2.5 add where are is the CMH demographic info.. 2.6 extra little bit for traking down “missing” COBRE "],
["check-completion-and-add-mr-qa.html", "Chapter 3 Check completion and add MR QA 3.1 Get a list of available bold and T1w files (from the mriqc outputs) 3.2 now glob for all of the PINT outputs 3.3 read in the combined demographics from the last chapter 3.4 also read in an concatenate all the surface area info from freesurfer 3.5 anti-join the pheno data with the usable scan data to see if we have everything.. 3.6 Setting the motion threshold: 3.7 who is still missing a PINT output? 3.8 Selecting scans with least motion 3.9 final mangle of the phenotypic data (transforming variables)", " Chapter 3 Check completion and add MR QA This section of the code checks to make sure that we have preprocessed data available for all expected partcipants. Then, for participants with more than one run/session of bold data it picks the best run per participant for the next analysis The final output is the QAed phenotypic file is data/phenotypic/20200202_pheno_qapass.csv which is the input for all of the rest of the analyses. library(tidyverse) ## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ ggplot2 3.1.0 ✔ purrr 0.2.5 ## ✔ tibble 2.0.1 ✔ dplyr 0.8.0.1 ## ✔ tidyr 0.8.2 ✔ stringr 1.3.1 ## ✔ readr 1.3.0 ✔ forcats 0.3.0 ## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(here) ## here() starts at /mnt/tigrlab/projects/edickie/code/SZ_PINT processed_mri_dir &lt;- here(&quot;data/processed/mri/&quot;) 3.1 Get a list of available bold and T1w files (from the mriqc outputs) sub_projects = c(&quot;ZHH&quot;, &quot;COBRE&quot;, &quot;ASDD&quot;, &quot;ASDD&quot;, &quot;DTI3T&quot; , &quot;RTMSWM&quot;, &quot;PNSC&quot;, &quot;SPINS&quot;, &quot;ds000030_R1.0.5&quot;) read_mriqc_bold &lt;- function(studyname) { bold &lt;- read_csv(str_c(processed_mri_dir, studyname, &quot;/out/mriqc/bold.csv&quot;)) %&gt;% mutate(subject_id = as.character(subject_id)) if (&quot;session_id&quot; %in% names(bold)) { bold &lt;- bold %&gt;% mutate(session_id = as.character(session_id)) } return(bold) } all_the_bolds &lt;- tibble(dataset = sub_projects) %&gt;% mutate(boldqc = map(dataset, function(x) { read_mriqc_bold(x) })) %&gt;% unnest() %&gt;% filter(task_id == &quot;rest&quot;) bolds_condensed &lt;- all_the_bolds %&gt;% select(dataset, ends_with(&#39;_id&#39;), starts_with(&#39;fd_&#39;), starts_with(&#39;size&#39;), starts_with(&#39;spacing&#39;)) %&gt;% mutate(subject = str_c(&quot;sub-&quot;, subject_id), session = str_c(&quot;ses-&quot;,session_id)) read_mriqc_t1w &lt;- function(studyname) { bold &lt;- read_csv(str_c(processed_mri_dir, studyname, &quot;/out/mriqc/T1w.csv&quot;)) %&gt;% mutate(subject_id = as.character(subject_id)) if (&quot;session_id&quot; %in% names(bold)) { bold &lt;- bold %&gt;% mutate(session_id = as.character(session_id)) } return(bold) } all_the_T1w &lt;- tibble(dataset = sub_projects) %&gt;% mutate(t1wqc = map(dataset, function(x) { read_mriqc_t1w(x) })) %&gt;% unnest() %&gt;% group_by(dataset, subject_id) %&gt;% summarise(num_t1w = n()) 3.1.1 the list of usable scans is all participants with both T1w and bold data usable_scans &lt;- all_the_bolds %&gt;% group_by(dataset, subject_id, task_id) %&gt;% summarise(num_rest = n()) %&gt;% full_join(all_the_T1w, by = c(&quot;subject_id&quot;, &quot;dataset&quot;)) %&gt;% mutate(num_scans = num_rest + num_t1w, subject = str_c(&quot;sub-&quot;, subject_id)) %&gt;% ungroup() usable_scans %&gt;% ungroup() %&gt;% select(subject_id, dataset, num_scans) %&gt;% drop_na(num_scans) %&gt;% distinct() %&gt;% count() ## # A tibble: 1 x 1 ## n ## &lt;int&gt; ## 1 704 3.2 now glob for all of the PINT outputs pint_summarys_wses &lt;- Sys.glob(str_c(processed_mri_dir, &quot;/*/out/ciftify_PINT/sub*/ses*/*summary.csv&quot;)) pint_summarys_nses &lt;- Sys.glob(str_c(processed_mri_dir, &quot;/*/out/ciftify_PINT/sub*/*summary.csv&quot;)) pintdf_nses &lt;- tibble(filepath = pint_summarys_nses) %&gt;% transmute(filepath = str_remove(filepath, processed_mri_dir)) %&gt;% separate(filepath, into = c(&quot;1&quot;,&#39;dataset&#39;,&#39;4&#39;,&#39;5&#39;,&#39;subject&#39;, &#39;filename&#39;), sep = .Platform$file.sep) %&gt;% select(dataset, subject, filename) pintdf_wses &lt;- tibble(filepath = pint_summarys_wses) %&gt;% transmute(filepath = str_remove(filepath, processed_mri_dir)) %&gt;% separate(filepath, into = c(&quot;1&quot;, &#39;dataset&#39;,&#39;4&#39;,&#39;5&#39;,&#39;subject&#39;, &#39;session&#39;, &#39;filename&#39;), sep = .Platform$file.sep) %&gt;% select(dataset, subject, session, filename) pintdf &lt;- bind_rows(pintdf_wses, pintdf_nses) rm(pint_summarys_nses, pint_summarys_wses, pintdf_nses, pintdf_wses) 3.3 read in the combined demographics from the last chapter # removing session id column because it is redundant simple_pheno &lt;- read_csv(here(&#39;data/processed/pheno/simple_pheno_20200202.csv&#39;)) ## Parsed with column specification: ## cols( ## subject = col_character(), ## cmh_session_id = col_character(), ## DX = col_character(), ## Age = col_double(), ## Sex = col_character(), ## dataset = col_character(), ## Site = col_character(), ## Scanner = col_character(), ## GRID = col_double(), ## zhh_session_id = col_double(), ## MRI_Date = col_double(), ## Edu = col_double(), ## isFEP = col_character(), ## ghost_NoGhost = col_character() ## ) 3.4 also read in an concatenate all the surface area info from freesurfer all_surfs &lt;- tibble(dataset = sub_projects) %&gt;% mutate(data = map(dataset, ~read_csv(str_c(processed_mri_dir,.x, &#39;/out/freesurfer/CorticalMeasuresENIGMA_SurfAvg.csv&#39;), col_types = cols( .default = col_double(), SubjID = col_character())))) %&gt;% unnest() %&gt;% select(dataset, SubjID, LSurfArea, RSurfArea) %&gt;% mutate(SurfArea = LSurfArea + RSurfArea) 3.5 anti-join the pheno data with the usable scan data to see if we have everything.. usable_scans %&gt;% anti_join(simple_pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% drop_na(num_scans) ## # A tibble: 1 x 7 ## dataset subject_id task_id num_rest num_t1w num_scans subject ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; ## 1 SPINS CMHAA2102 rest 1 1 2 sub-CMHAA2102 3.5.0.1 we see that the only people we have bold info but no phenotype for is that one VIPR participant in SPINS and the 5 people from ds00030 who don’t have a T1w scan 3.6 Setting the motion threshold: We have set the motion threshold to: Mean FD &lt; 0.5mm and No more than 50% of the scan with motion &gt; 0.2mm mean_fd_thres &lt;- 0.5 perc_fd_thres &lt;- 50 pre_qa &lt;- bolds_condensed %&gt;% inner_join(select(usable_scans, -task_id, -subject_id), by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% drop_na(num_scans) %&gt;% inner_join(simple_pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% inner_join(all_surfs %&gt;% rename(subject = SubjID), by = c(&quot;subject&quot;, &quot;dataset&quot;)) pre_qa_counts &lt;- pre_qa %&gt;% select(subject, dataset, DX) %&gt;% distinct() %&gt;% count(DX) qa_passes_pheno &lt;- pre_qa %&gt;% filter(fd_mean &lt; 0.5, fd_perc &lt; 50, size_t &gt; 100) qa_passes_pheno %&gt;% select(subject, dataset, DX) %&gt;% distinct() %&gt;% count(DX) %&gt;% inner_join(pre_qa_counts, by = &quot;DX&quot;, suffix = c(&quot;_after_qa&quot;, &quot;_before_qa&quot;)) ## # A tibble: 3 x 3 ## DX n_after_qa n_before_qa ## &lt;chr&gt; &lt;int&gt; &lt;int&gt; ## 1 &lt;NA&gt; 2 9 ## 2 CTRL 294 377 ## 3 SSD 203 317 3.7 who is still missing a PINT output? anti_join(qa_passes_pheno, pintdf, by = c(&quot;dataset&quot;, &quot;subject&quot;, &quot;session&quot;)) ## # A tibble: 0 x 37 ## # … with 37 variables: dataset &lt;chr&gt;, subject_id &lt;chr&gt;, session_id &lt;chr&gt;, ## # task_id &lt;chr&gt;, run_id &lt;chr&gt;, acq_id &lt;chr&gt;, fd_mean &lt;dbl&gt;, ## # fd_num &lt;dbl&gt;, fd_perc &lt;dbl&gt;, size_t &lt;dbl&gt;, size_x &lt;dbl&gt;, size_y &lt;dbl&gt;, ## # size_z &lt;dbl&gt;, spacing_tr &lt;dbl&gt;, spacing_x &lt;dbl&gt;, spacing_y &lt;dbl&gt;, ## # spacing_z &lt;dbl&gt;, subject &lt;chr&gt;, session &lt;chr&gt;, num_rest &lt;int&gt;, ## # num_t1w &lt;int&gt;, num_scans &lt;int&gt;, cmh_session_id &lt;chr&gt;, DX &lt;chr&gt;, ## # Age &lt;dbl&gt;, Sex &lt;chr&gt;, Site &lt;chr&gt;, Scanner &lt;chr&gt;, GRID &lt;dbl&gt;, ## # zhh_session_id &lt;dbl&gt;, MRI_Date &lt;dbl&gt;, Edu &lt;dbl&gt;, isFEP &lt;chr&gt;, ## # ghost_NoGhost &lt;chr&gt;, LSurfArea &lt;dbl&gt;, RSurfArea &lt;dbl&gt;, SurfArea &lt;dbl&gt; 3.8 Selecting scans with least motion # select the scan for each participant with the least motion pheno &lt;- qa_passes_pheno %&gt;% select(-ends_with(&quot;_x&quot;), -ends_with(&quot;_y&quot;)) %&gt;% left_join(pintdf, by = c(&quot;dataset&quot;, &quot;subject&quot;, &quot;session&quot;)) %&gt;% filter(!is.na(filename)) %&gt;% group_by(subject, dataset) %&gt;% arrange(fd_perc) %&gt;% slice(1) %&gt;% ungroup() pheno %&gt;% ggplot(aes(x = Age, y = SurfArea)) + geom_point(aes(color = Site)) + geom_smooth(method = &quot;lm&quot;) 3.9 final mangle of the phenotypic data (transforming variables) transform_to_normal &lt;- function(X) { # calculate the best exponent using powerTransform: pT &lt;- car::powerTransform(X) # apply the power transform and save the result to a new variable X_pT &lt;- X^pT$lambda ## note ^ is exponent in r xout = scales::rescale(X_pT) return(X_pT) } # transform age and fd_mean to normality pheno &lt;- pheno %&gt;% mutate(Age_pt = transform_to_normal(Age), fd_mean_pt = transform_to_normal(fd_mean), SurfArea_pt = transform_to_normal(SurfArea)) pheno %&gt;% select(subject, dataset, DX) %&gt;% distinct() %&gt;% count(DX) %&gt;% inner_join(pre_qa_counts, by = &quot;DX&quot;, suffix = c(&quot;_after_qa&quot;, &quot;_before_qa&quot;)) ## # A tibble: 3 x 3 ## DX n_after_qa n_before_qa ## &lt;chr&gt; &lt;int&gt; &lt;int&gt; ## 1 &lt;NA&gt; 2 9 ## 2 CTRL 294 377 ## 3 SSD 203 317 pheno %&gt;% group_by(Site, DX) %&gt;% summarise(n = n(), nMale = sum(Sex == &quot;M&quot;), perc_male = nMale/n()*100, age_mean = mean(Age, na.rm = T), age_sd = sd(Age, na.rm = T), age_min = min(Age, na.rm = T), age_max = max(Age, na.rm = T)) %&gt;% mutate(age_report =sprintf(&quot;%0.1f(%0.1f) %0.0f - %0.0f&quot;, age_mean, age_sd, age_min, age_max), sex_report = str_c(nMale, &#39;(&#39;, sprintf(&quot;%0.1f&quot;, perc_male), &#39;%)&#39;)) %&gt;% select(Site, DX, n, age_report, sex_report) ## # A tibble: 9 x 5 ## # Groups: Site [4] ## Site DX n age_report sex_report ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; ## 1 CMH CTRL 41 26.4(6.7) 18 - 49 22(53.7%) ## 2 CMH SSD 67 32.2(8.5) 18 - 50 40(59.7%) ## 3 COBRE &lt;NA&gt; 2 40.0(2.8) 38 - 42 1(50.0%) ## 4 COBRE CTRL 35 33.2(9.0) 18 - 51 23(65.7%) ## 5 COBRE SSD 22 29.5(12.1) 19 - 55 19(86.4%) ## 6 ds000030 CTRL 107 30.4(8.1) 21 - 50 55(51.4%) ## 7 ds000030 SSD 31 35.2(9.3) 22 - 49 24(77.4%) ## 8 ZHH CTRL 111 25.1(6.6) 15 - 41 48(43.2%) ## 9 ZHH SSD 83 25.8(9.0) 15 - 57 63(75.9%) qa_passes_pheno %&gt;% mutate(scan_length = size_t*2/60, spacing_x_round = round(spacing_x, 3), spacing_z_round = round(spacing_z,3)) %&gt;% group_by(subject) %&gt;% sample_n(1) %&gt;% ungroup() %&gt;% group_by(Site, size_t, size_x, size_y, size_z, spacing_x_round, spacing_z_round, scan_length) %&gt;% count() %&gt;% ungroup() %&gt;% group_by(Site) %&gt;% arrange(-n) %&gt;% slice(1) %&gt;% t() ## [,1] [,2] [,3] [,4] ## Site &quot;CMH&quot; &quot;COBRE&quot; &quot;ds000030&quot; &quot;ZHH&quot; ## size_t &quot;208&quot; &quot;149&quot; &quot;152&quot; &quot;148&quot; ## size_x &quot;64&quot; &quot;64&quot; &quot;64&quot; &quot;64&quot; ## size_y &quot;64&quot; &quot;64&quot; &quot;64&quot; &quot;64&quot; ## size_z &quot;40&quot; &quot;33&quot; &quot;34&quot; &quot;40&quot; ## spacing_x_round &quot;3.125&quot; &quot;3.750&quot; &quot;3.000&quot; &quot;3.750&quot; ## spacing_z_round &quot;4.00&quot; &quot;4.55&quot; &quot;4.00&quot; &quot;3.00&quot; ## scan_length &quot;6.933333&quot; &quot;4.966667&quot; &quot;5.066667&quot; &quot;4.933333&quot; ## n &quot; 98&quot; &quot; 36&quot; &quot;124&quot; &quot;148&quot; write_csv(pheno, here(&#39;data/processed/pheno/20200202_pheno_qapass.csv&#39;)) pheno %&gt;% filter(!is.na(DX)) %&gt;% count(Site, DX) ## # A tibble: 8 x 3 ## Site DX n ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; ## 1 CMH CTRL 41 ## 2 CMH SSD 67 ## 3 COBRE CTRL 35 ## 4 COBRE SSD 22 ## 5 ds000030 CTRL 107 ## 6 ds000030 SSD 31 ## 7 ZHH CTRL 111 ## 8 ZHH SSD 83 ASDD is done! ZHH is done! (note that the TR for scans without a TR was set to 2s by Saba and Dayton) RTMSWM is done! PNSC is done DTI3T is done! SPINS has one extra bold (CMHAA2102 - from VIPR - disregard) COBRE is done (enough) - but half of it never downloaded ds00030 5 subjects need to rerun ciftify.. "],
["stats-on-the-pint-summary-displacement-values.html", "Chapter 4 Stats on the PINT summary displacement values 4.1 The paths to data 4.2 run for the whole head 4.3 run linear model per edge", " Chapter 4 Stats on the PINT summary displacement values library(tidyverse) ## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ ggplot2 3.1.0 ✔ purrr 0.2.5 ## ✔ tibble 2.0.1 ✔ dplyr 0.8.0.1 ## ✔ tidyr 0.8.2 ✔ stringr 1.3.1 ## ✔ readr 1.3.0 ✔ forcats 0.3.0 ## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(broom) library(here) ## here() starts at /mnt/tigrlab/projects/edickie/code/SZ_PINT 4.1 The paths to data source(here(&#39;code/R/settings_helpers.R&#39;)) Yeo7_2011_80verts &lt;- read_Yeo72011_template() YeoNet_colours = define_Yeo7_colours() ## adding a subid that matches what the concatenation script adds.. pheno &lt;- read_pheno_file() %&gt;% mutate(subid = str_replace(filename, &#39;_summary.csv&#39;,&#39;&#39;)) %&gt;% drop_na(DX) ## Parsed with column specification: ## cols( ## .default = col_double(), ## dataset = col_character(), ## subject_id = col_character(), ## session_id = col_character(), ## task_id = col_character(), ## run_id = col_character(), ## acq_id = col_character(), ## subject = col_character(), ## session = col_character(), ## cmh_session_id = col_character(), ## DX = col_character(), ## Sex = col_character(), ## Site = col_character(), ## Scanner = col_character(), ## isFEP = col_character(), ## ghost_NoGhost = col_character(), ## filename = col_character() ## ) ## See spec(...) for full column specifications. pint_concat &lt;- read_csv(file.path(output_base,&#39;postPINT1_concat_all_qa_passes.csv&#39;)) ## Parsed with column specification: ## cols( ## subid = col_character(), ## hemi = col_character(), ## NETWORK = col_double(), ## roiidx = col_double(), ## tvertex = col_double(), ## pvertex = col_double(), ## dist_49 = col_double(), ## vertex_48 = col_double(), ## std_distance = col_double() ## ) pheno %&gt;% select(subject, dataset) %&gt;% distinct() %&gt;% count() ## # A tibble: 1 x 1 ## n ## &lt;int&gt; ## 1 497 ana_data &lt;- pheno %&gt;% inner_join(pint_concat, by = &quot;subid&quot;) %&gt;% inner_join(Yeo7_2011_80verts, by = &quot;roiidx&quot;) %&gt;% mutate(network = str_sub(SHORTNAME, 1,2)) 4.2 run for the whole head dist_by_total &lt;- pint_concat %&gt;% group_by(subid) %&gt;% summarise(MeanDistance = mean(std_distance)) %&gt;% ungroup() %&gt;% inner_join(pheno, by = &quot;subid&quot;) dist_by_total %&gt;% ungroup() %&gt;% do(tidy(lm(MeanDistance ~ DX + Age_pt + Sex + fd_mean_pt + Site + SurfArea_pt,.))) %&gt;% mutate(p_bonf = p.value*6) %&gt;% knitr::kable() term estimate std.error statistic p.value p_bonf (Intercept) 10.4934545 2.0347512 5.1571192 0.0000004 0.0000022 DXSSD -0.1466062 0.0627130 -2.3377333 0.0198068 0.1188408 Age_pt 4.2418153 1.0972011 3.8660326 0.0001257 0.0007541 SexM 0.0596993 0.0713062 0.8372247 0.4028786 2.4172716 fd_mean_pt 1.0963997 1.5419903 0.7110290 0.4774081 2.8644486 SiteCOBRE -0.3464107 0.1108145 -3.1260409 0.0018781 0.0112685 Siteds000030 -0.5501351 0.0872879 -6.3025326 0.0000000 0.0000000 SiteZHH 0.0722012 0.0787317 0.9170533 0.3595705 2.1574230 SurfArea_pt -0.2728473 0.0921273 -2.9616328 0.0032102 0.0192614 dist_by_total %&gt;% ggplot(aes(y = MeanDistance, x = Age)) + geom_point(aes(color = Site)) + geom_smooth(method = &quot;lm&quot;)+ facet_wrap(~DX) + theme_bw() dist_by_total %&gt;% ggplot(aes(y = MeanDistance, x = Age, color = DX)) + geom_point() + geom_smooth(method = &quot;lm&quot;)+ theme_bw() dist_by_network &lt;- pint_concat %&gt;% inner_join(Yeo7_2011_80verts, by = &quot;roiidx&quot;) %&gt;% mutate(network = str_sub(SHORTNAME, 1,2)) %&gt;% group_by(subid, network) %&gt;% summarise(MeanDistance = mean(std_distance)) %&gt;% ungroup() %&gt;% inner_join(pheno, by = &quot;subid&quot;) dist_by_network %&gt;% ungroup() %&gt;% group_by(network) %&gt;% do(tidy(aov(lm(MeanDistance ~ DX + Age_pt + Sex + fd_mean_pt + Scanner + SurfArea_pt,.)))) %&gt;% mutate(p_bonf = p.value*6) %&gt;% filter(!(term %in% c(&#39;Intercept&#39;, &#39;ScannerCOBRE&#39;, &#39;Scannerds00003035343&#39;, &#39;ScannerZHH&#39;, &#39;Scannerds00003035426&#39;))) %&gt;% select(network, term, df, statistic, p.value, p_bonf) %&gt;% knitr::kable() network term df statistic p.value p_bonf DA DX 1 0.3532816 0.5525391 3.3152346 DA Age_pt 1 12.0217421 0.0005727 0.0034363 DA Sex 1 0.0000806 0.9928397 5.9570381 DA fd_mean_pt 1 0.3414558 0.5592624 3.3555743 DA Scanner 4 5.5705136 0.0002167 0.0013004 DA SurfArea_pt 1 1.7744287 0.1834618 1.1007710 DA Residuals 484 NA NA NA DM DX 1 0.1061633 0.7446959 4.4681757 DM Age_pt 1 5.1586493 0.0235692 0.1414152 DM Sex 1 6.0387566 0.0143448 0.0860689 DM fd_mean_pt 1 3.0434880 0.0816963 0.4901779 DM Scanner 4 5.7903617 0.0001473 0.0008839 DM SurfArea_pt 1 1.0292682 0.3108375 1.8650250 DM Residuals 484 NA NA NA FP DX 1 1.2293379 0.2680865 1.6085188 FP Age_pt 1 4.2182044 0.0405291 0.2431747 FP Sex 1 1.0228033 0.3123603 1.8741617 FP fd_mean_pt 1 3.6095802 0.0580417 0.3482502 FP Scanner 4 1.5177324 0.1957679 1.1746074 FP SurfArea_pt 1 14.1124915 0.0001932 0.0011591 FP Residuals 484 NA NA NA SM DX 1 0.0869153 0.7682624 4.6095742 SM Age_pt 1 16.5226128 0.0000561 0.0003366 SM Sex 1 0.0125257 0.9109344 5.4656067 SM fd_mean_pt 1 1.8318356 0.1765426 1.0592558 SM Scanner 4 5.0117573 0.0005766 0.0034598 SM SurfArea_pt 1 0.3107575 0.5774735 3.4648408 SM Residuals 484 NA NA NA VA DX 1 0.1441132 0.7043922 4.2263530 VA Age_pt 1 1.8970876 0.1690413 1.0142476 VA Sex 1 0.4108716 0.5218308 3.1309850 VA fd_mean_pt 1 0.1003183 0.7515846 4.5095074 VA Scanner 4 6.6816251 0.0000307 0.0001840 VA SurfArea_pt 1 2.7537042 0.0976772 0.5860630 VA Residuals 484 NA NA NA VI DX 1 0.3137753 0.5756319 3.4537911 VI Age_pt 1 16.3660012 0.0000608 0.0003646 VI Sex 1 1.3560252 0.2448012 1.4688072 VI fd_mean_pt 1 0.8478563 0.3576182 2.1457092 VI Scanner 4 6.0907240 0.0000869 0.0005211 VI SurfArea_pt 1 0.9719647 0.3246833 1.9480996 VI Residuals 484 NA NA NA dist_by_network %&gt;% ggplot(aes(y = MeanDistance, x = Age)) + geom_point(alpha = 0.2, size = 0.5) + geom_smooth(aes(color = DX), method = &quot;lm&quot;) + facet_wrap(~network, scales = &quot;free&quot;, nrow = 1) + scale_color_manual(values = c(&quot;grey20&quot;,&quot;red&quot;)) 4.3 run linear model per edge roi_dx_lm &lt;- ana_data %&gt;% ungroup() %&gt;% group_by(SHORTNAME) %&gt;% do(tidy(lm(std_distance ~ DX + Sex + fd_mean_pt + Age_pt + Scanner,.))) %&gt;% ungroup() %&gt;% group_by(term) %&gt;% mutate(p_fdr = p.adjust(p.value, method = &#39;fdr&#39;)) roi_dx_lm %&gt;% filter(term == &quot;Age_pt&quot;) %&gt;% filter(p_fdr &lt; 0.1) ## # A tibble: 1 x 7 ## # Groups: term [1] ## SHORTNAME term estimate std.error statistic p.value p_fdr ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 VI03L Age_pt 34.5 8.58 4.02 0.0000662 0.00530 "],
["multi-dimensional-scaling-stats-on-pint-roi-locations.html", "Chapter 5 Multi-Dimensional Scaling Stats on PINT ROI locations", " Chapter 5 Multi-Dimensional Scaling Stats on PINT ROI locations library(tidyverse) ## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ ggplot2 3.1.0 ✔ purrr 0.2.5 ## ✔ tibble 2.0.1 ✔ dplyr 0.8.0.1 ## ✔ tidyr 0.8.2 ✔ stringr 1.3.1 ## ✔ readr 1.3.0 ✔ forcats 0.3.0 ## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(broom) library(igraph) ## ## Attaching package: &#39;igraph&#39; ## The following objects are masked from &#39;package:dplyr&#39;: ## ## as_data_frame, groups, union ## The following objects are masked from &#39;package:purrr&#39;: ## ## compose, simplify ## The following object is masked from &#39;package:tidyr&#39;: ## ## crossing ## The following object is masked from &#39;package:tibble&#39;: ## ## as_data_frame ## The following objects are masked from &#39;package:stats&#39;: ## ## decompose, spectrum ## The following object is masked from &#39;package:base&#39;: ## ## union library(here) ## here() starts at /mnt/tigrlab/projects/edickie/code/SZ_PINT source(here(&#39;code/R/settings_helpers.R&#39;)) Yeo7_2011_80verts &lt;- read_Yeo72011_template() YeoNet_colours = define_Yeo7_colours() pheno &lt;- read_pheno_file() %&gt;% drop_na(DX) ## Parsed with column specification: ## cols( ## .default = col_double(), ## dataset = col_character(), ## subject_id = col_character(), ## session_id = col_character(), ## task_id = col_character(), ## run_id = col_character(), ## acq_id = col_character(), ## subject = col_character(), ## session = col_character(), ## cmh_session_id = col_character(), ## DX = col_character(), ## Sex = col_character(), ## Site = col_character(), ## Scanner = col_character(), ## isFEP = col_character(), ## ghost_NoGhost = col_character(), ## filename = col_character() ## ) ## See spec(...) for full column specifications. subsub &lt;- read_csv(file.path(output_base,&#39;postPINT2_sub2sub_all_qa_passes.csv&#39;)) ## Parsed with column specification: ## cols( ## subid1 = col_character(), ## subid2 = col_character(), ## roiidx = col_double(), ## distance = col_double() ## ) mds_sub2sub &lt;- function(data) { ## filter allsub2sub distances to only include the qced subids ## then run multidimensional scaling to resolve the sub2sub distances to a 2D plane distout &lt;- data %&gt;% graph_from_data_frame() %&gt;% get.adjacency(attr = &quot;distance&quot;) %&gt;% as.matrix() %&gt;% cmdscale(k=2) %&gt;% as.data.frame() names(distout) &lt;- c(&#39;mds1&#39;,&#39;mds2&#39;) distout$src_file &lt;- row.names(distout) distout &lt;- as.tibble(distout) %&gt;% select(src_file, mds1, mds2) return(as.tibble(distout)) } subsub %&gt;% filter(roiidx == 1) %&gt;% select(subid1, subid2, distance) %&gt;% mds_sub2sub() ## Warning: `as.tibble()` is deprecated, use `as_tibble()` (but mind the new semantics). ## This warning is displayed once per session. ## # A tibble: 494 x 3 ## src_file mds1 mds2 ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 sub-10159_task-rest_bold_desc-clean_bold -8.90 6.21 ## 2 sub-10161_ses-03_task-rest_bold_desc-clean_bold -12.4 -6.73 ## 3 sub-10185_ses-03_task-rest_bold_desc-clean_bold -16.8 2.83 ## 4 sub-10186_ses-02_task-rest_bold_desc-clean_bold 2.30 -6.17 ## 5 sub-10206_task-rest_bold_desc-clean_bold 6.98 -6.90 ## 6 sub-10217_task-rest_bold_desc-clean_bold 0.334 5.22 ## 7 sub-10225_task-rest_bold_desc-clean_bold -5.33 -2.67 ## 8 sub-10227_task-rest_bold_desc-clean_bold -1.44 7.06 ## 9 sub-10228_task-rest_bold_desc-clean_bold -2.86 -3.21 ## 10 sub-10235_task-rest_bold_desc-clean_bold 3.24 1.98 ## # … with 484 more rows mds_results &lt;- subsub %&gt;% group_by(roiidx) %&gt;% nest() %&gt;% mutate(sdist = map(data, ~mds_sub2sub(.x))) %&gt;% select(roiidx, sdist) %&gt;% unnest() mds_pheno &lt;- pheno %&gt;% mutate(src_file = str_replace(filename, &#39;_summary.csv&#39;,&#39;&#39;)) %&gt;% inner_join(mds_results, by = &quot;src_file&quot;) %&gt;% inner_join(Yeo7_2011_80verts, by = &quot;roiidx&quot;) sdist_manova &lt;- mds_pheno %&gt;% group_by(SHORTNAME) %&gt;% do(tidy(manova(cbind(mds1, mds2) ~ DX*Age_pt + Sex + fd_mean_pt + Scanner + SurfArea_pt,.))) %&gt;% ungroup() %&gt;% group_by(term) %&gt;% mutate(p_FDR = p.adjust(p.value, method = &quot;fdr&quot;)) sdist_manova %&gt;% filter(p_FDR &lt; 0.1) %&gt;% knitr::kable() SHORTNAME term df pillai statistic num.df den.df p.value p_FDR DAF1R Age_pt 1 0.0333245 8.308063 2 482 0.0002836 0.0226852 DAF2R Scanner 4 0.0521536 3.233081 8 966 0.0012275 0.0245509 DAP3L SurfArea_pt 1 0.0373781 9.357897 2 482 0.0001030 0.0082400 DAT1R Scanner 4 0.0419300 2.585731 8 966 0.0085038 0.0606834 DMF2L Scanner 4 0.0500795 3.101205 8 966 0.0018362 0.0270478 DMP1L Scanner 4 0.0444748 2.746233 8 966 0.0053180 0.0425443 DMT1L Scanner 4 0.0488459 3.022896 8 966 0.0023280 0.0270478 DMT2R Scanner 4 0.0487598 3.017440 8 966 0.0023667 0.0270478 FPF4L SurfArea_pt 1 0.0240749 5.945181 2 482 0.0028143 0.0750485 FPF5R Age_pt 1 0.0277014 6.866231 2 482 0.0011474 0.0458968 FPF5R Scanner 4 0.0920534 5.825870 8 966 0.0000003 0.0000221 FPP1L Scanner 4 0.0380182 2.339828 8 966 0.0171699 0.0879449 FPP2R Scanner 4 0.0412005 2.539798 8 966 0.0097119 0.0606834 SMF2R fd_mean_pt 1 0.0302949 7.529166 2 482 0.0006028 0.0482228 SMI1L Scanner 4 0.0371739 2.286882 8 966 0.0199159 0.0937220 VAF2R Scanner 4 0.0458917 2.835783 8 966 0.0040793 0.0407933 VAF4R Age_pt 1 0.0231541 5.712415 2 482 0.0035324 0.0941985 VAI1R Scanner 4 0.0831686 5.239172 8 966 0.0000019 0.0000780 VAP1L Scanner 4 0.0378815 2.331250 8 966 0.0175890 0.0879449 VAP2L Scanner 4 0.0397492 2.448523 8 966 0.0126192 0.0721098 VI01R SurfArea_pt 1 0.0241456 5.963079 2 482 0.0027656 0.0750485 VI02L Scanner 4 0.0558513 3.468893 8 966 0.0005922 0.0157924 VI03L Scanner 4 0.0411165 2.534513 8 966 0.0098611 0.0606834 VI05R Scanner 4 0.0445311 2.749793 8 966 0.0052625 0.0425443 mds_pheno %&gt;% filter(SHORTNAME %in% c(&quot;DAF1R&quot;, &quot;FPF5R&quot;, &quot;VAF4R&quot;)) %&gt;% ggplot(aes(x = mds1, y = mds2, color = DX)) + geom_point(alpha = 0.1) + scale_color_manual(values = c(&quot;grey20&quot;,&quot;red&quot;)) + facet_wrap(~SHORTNAME, ncol = 5) mds_pheno %&gt;% filter(SHORTNAME %in% c(&quot;DAF1R&quot;, &quot;FPF5R&quot;, &quot;VAF4R&quot;)) %&gt;% ggplot(aes(x = mds1, y = mds2, color = Age)) + geom_point(alpha = 0.2) + scale_color_viridis_c() + facet_wrap(~SHORTNAME, ncol = 5) mds_pheno %&gt;% mutate(Age_coarse = case_when(Age &lt; 25 ~ &quot;young adult&quot;, Age &gt; 35 ~ &quot;middle age&quot;)) %&gt;% drop_na(Age_coarse) %&gt;% filter(SHORTNAME %in% c(&quot;DAF1R&quot;)) %&gt;% ggplot(aes(x = mds1, y = mds2)) + stat_density_2d(aes(fill = stat(level)), bins = 8, geom = &quot;polygon&quot;) + geom_point(alpha = 0.5, size = 0.5) + scale_fill_viridis_c() + geom_hline(yintercept = 0) + geom_vline(xintercept = 0) + facet_grid(Age_coarse ~ Site) "],
["seedcorr-area-stats.html", "Chapter 6 Seedcorr Area Stats 6.1 The paths to data 6.2 Known issues", " Chapter 6 Seedcorr Area Stats library(tidyverse) ## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ ggplot2 3.1.0 ✔ purrr 0.2.5 ## ✔ tibble 2.0.1 ✔ dplyr 0.8.0.1 ## ✔ tidyr 0.8.2 ✔ stringr 1.3.1 ## ✔ readr 1.3.0 ✔ forcats 0.3.0 ## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(broom) library(here) ## here() starts at /mnt/tigrlab/projects/edickie/code/SZ_PINT 6.1 The paths to data source(here(&#39;code/R/settings_helpers.R&#39;)) Yeo7_2011_80verts &lt;- read_Yeo72011_template() YeoNet_colours = define_Yeo7_colours() pheno &lt;- read_pheno_file() %&gt;% drop_na(DX) ## Parsed with column specification: ## cols( ## .default = col_double(), ## dataset = col_character(), ## subject_id = col_character(), ## session_id = col_character(), ## task_id = col_character(), ## run_id = col_character(), ## acq_id = col_character(), ## subject = col_character(), ## session = col_character(), ## cmh_session_id = col_character(), ## DX = col_character(), ## Sex = col_character(), ## Site = col_character(), ## Scanner = col_character(), ## isFEP = col_character(), ## ghost_NoGhost = col_character(), ## filename = col_character() ## ) ## See spec(...) for full column specifications. pint_sc &lt;- read_csv(file.path(output_base, &#39;qa_passes_seedcor_counts_20181116.csv&#39;)) ## Warning: Missing column names filled in: &#39;X1&#39; [1] ## Warning: Duplicated column names deduplicated: &#39;index&#39; =&gt; &#39;index_1&#39; [7] ## Parsed with column specification: ## cols( ## .default = col_double(), ## dataset = col_character(), ## subject = col_character(), ## session = col_character(), ## filename = col_character() ## ) ## See spec(...) for full column specifications. pint_sc %&gt;% anti_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) ## # A tibble: 12 x 29 ## X1 index dataset subject session filename index_1 NETWORK gt_0.30 ## &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 2292 382 COBRE sub-A0… ses-20… sub-A00… 2292 2 15241 ## 2 2293 382 COBRE sub-A0… ses-20… sub-A00… 2293 3 10223 ## 3 2294 382 COBRE sub-A0… ses-20… sub-A00… 2294 4 16854 ## 4 2295 382 COBRE sub-A0… ses-20… sub-A00… 2295 5 18930 ## 5 2296 382 COBRE sub-A0… ses-20… sub-A00… 2296 6 15772 ## 6 2297 382 COBRE sub-A0… ses-20… sub-A00… 2297 7 13304 ## 7 2298 383 COBRE sub-A0… ses-20… sub-A00… 2298 2 12894 ## 8 2299 383 COBRE sub-A0… ses-20… sub-A00… 2299 3 19799 ## 9 2300 383 COBRE sub-A0… ses-20… sub-A00… 2300 4 16902 ## 10 2301 383 COBRE sub-A0… ses-20… sub-A00… 2301 5 20600 ## 11 2302 383 COBRE sub-A0… ses-20… sub-A00… 2302 6 19045 ## 12 2303 383 COBRE sub-A0… ses-20… sub-A00… 2303 7 19976 ## # … with 20 more variables: gt_0.32 &lt;dbl&gt;, gt_0.34 &lt;dbl&gt;, gt_0.36 &lt;dbl&gt;, ## # gt_0.38 &lt;dbl&gt;, gt_0.40 &lt;dbl&gt;, gt_0.42 &lt;dbl&gt;, gt_0.44 &lt;dbl&gt;, ## # gt_0.46 &lt;dbl&gt;, gt_0.48 &lt;dbl&gt;, gt_0.50 &lt;dbl&gt;, gt_0.52 &lt;dbl&gt;, ## # gt_0.54 &lt;dbl&gt;, gt_0.56 &lt;dbl&gt;, gt_0.58 &lt;dbl&gt;, gt_0.60 &lt;dbl&gt;, ## # gt_0.62 &lt;dbl&gt;, gt_0.64 &lt;dbl&gt;, gt_0.66 &lt;dbl&gt;, gt_0.68 &lt;dbl&gt;, ## # gt_0.70 &lt;dbl&gt; pheno %&gt;% anti_join(pint_sc, by = c(&quot;subject&quot;, &quot;dataset&quot;)) ## # A tibble: 3 x 37 ## dataset subject_id session_id task_id run_id acq_id fd_mean fd_num ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 ds0000… 10365 &lt;NA&gt; rest &lt;NA&gt; &lt;NA&gt; 0.118 17 ## 2 ZHH 10523 01 rest &lt;NA&gt; &lt;NA&gt; 0.127 11 ## 3 ds0000… 10570 &lt;NA&gt; rest &lt;NA&gt; &lt;NA&gt; 0.178 48 ## # … with 29 more variables: fd_perc &lt;dbl&gt;, size_t &lt;dbl&gt;, size_z &lt;dbl&gt;, ## # spacing_tr &lt;dbl&gt;, spacing_z &lt;dbl&gt;, subject &lt;chr&gt;, session &lt;chr&gt;, ## # num_rest &lt;dbl&gt;, num_t1w &lt;dbl&gt;, num_scans &lt;dbl&gt;, cmh_session_id &lt;chr&gt;, ## # DX &lt;chr&gt;, Age &lt;dbl&gt;, Sex &lt;chr&gt;, Site &lt;chr&gt;, Scanner &lt;chr&gt;, GRID &lt;dbl&gt;, ## # zhh_session_id &lt;dbl&gt;, MRI_Date &lt;dbl&gt;, Edu &lt;dbl&gt;, isFEP &lt;chr&gt;, ## # ghost_NoGhost &lt;chr&gt;, LSurfArea &lt;dbl&gt;, RSurfArea &lt;dbl&gt;, SurfArea &lt;dbl&gt;, ## # filename &lt;chr&gt;, Age_pt &lt;dbl&gt;, fd_mean_pt &lt;dbl&gt;, SurfArea_pt &lt;dbl&gt; Write a func_base and outputprefix cols into the pheno file for the file reading step combined_df &lt;- pheno %&gt;% inner_join(pint_sc, by = c(&quot;dataset&quot;, &quot;subject&quot;, &quot;session&quot;)) %&gt;% gather(gt_name, num_sc_vx_gt, starts_with(&#39;gt_&#39;)) %&gt;% mutate(vx_gt_thres = gt_name %&gt;% str_replace(&#39;gt_&#39;,&#39;&#39;) %&gt;% parse_double()) %&gt;% drop_na(num_sc_vx_gt) combined_df %&gt;% count(subject) %&gt;% nrow() ## [1] 492 6.2 Known issues Looks like two people might need to be reprocessed if this works out. combined_df %&gt;% drop_na(DX) %&gt;% group_by(NETWORK, vx_gt_thres) %&gt;% filter(Age &gt; 17, Age &lt; 51) %&gt;% filter(vx_gt_thres &lt; 0.6) %&gt;% do(tidy(aov(lm(num_sc_vx_gt ~ DX*Age_pt + Sex + fd_mean_pt + Scanner + SurfArea_pt,.)))) %&gt;% ungroup() %&gt;% group_by(term) %&gt;% mutate(p_FDR = p.adjust(p.value, method = &quot;fdr&quot;)) %&gt;% filter(term != &quot;(Intercept)&quot;, term != &quot;Scanner&quot;, p_FDR &lt; 0.06) %&gt;% arrange(NETWORK, term) ## # A tibble: 43 x 9 ## # Groups: term [1] ## NETWORK vx_gt_thres term df sumsq meansq statistic p.value p_FDR ## &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 4 0.3 Age_pt 1 1.53e8 1.53e8 8.86 3.07e-3 1.11e-2 ## 2 4 0.32 Age_pt 1 1.60e8 1.60e8 9.96 1.70e-3 8.06e-3 ## 3 4 0.34 Age_pt 1 1.68e8 1.68e8 11.2 8.65e-4 5.19e-3 ## 4 4 0.36 Age_pt 1 1.72e8 1.72e8 12.5 4.59e-4 3.45e-3 ## 5 4 0.38 Age_pt 1 1.74e8 1.74e8 13.8 2.30e-4 1.88e-3 ## 6 4 0.4 Age_pt 1 1.76e8 1.76e8 15.3 1.04e-4 9.33e-4 ## 7 4 0.42 Age_pt 1 1.74e8 1.74e8 16.8 4.83e-5 4.83e-4 ## 8 4 0.44 Age_pt 1 1.72e8 1.72e8 18.5 2.13e-5 2.39e-4 ## 9 4 0.46 Age_pt 1 1.68e8 1.68e8 20.1 9.17e-6 1.18e-4 ## 10 4 0.48 Age_pt 1 1.62e8 1.62e8 21.9 3.75e-6 5.63e-5 ## # … with 33 more rows combined_df %&gt;% drop_na(DX) %&gt;% ggplot(aes(y = num_sc_vx_gt, x = vx_gt_thres, color = as.factor(NETWORK))) + # geom_line(aes(group = subject), alpha = 0.1) + geom_smooth() + facet_wrap(~Site, ncol = 4) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; combined_df %&gt;% drop_na(DX) %&gt;% ggplot(aes(y = num_sc_vx_gt, x = vx_gt_thres, color = as.factor(DX))) + # geom_line(aes(group = subject), alpha = 0.1) + geom_smooth() + facet_wrap(~NETWORK*Site, ncol = 4) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; combined_df %&gt;% drop_na(DX) %&gt;% filter(NETWORK == 5) %&gt;% ggplot(aes(y = num_sc_vx_gt, x = vx_gt_thres, color = Sex)) + geom_line(aes(group = subject), alpha = 0.1) + geom_smooth() + facet_wrap(~NETWORK*Site, ncol = 4) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; combined_df %&gt;% filter(Age &gt; 17, Age &lt; 51) %&gt;% mutate(Age_decade = case_when(Age &lt; 20 ~ &#39;17-20&#39;, Age &gt;= 20 &amp; Age &lt; 30 ~ &#39;20-30&#39;, Age &gt;= 30 &amp; Age &lt; 40 ~ &#39;30-40&#39;, Age &gt;= 40 &amp; Age &lt; 50 ~ &#39;40-50&#39;, Age &gt; 50 ~ &quot;50 above&quot;)) %&gt;% mutate(Age_coarse = case_when(Age &lt; 30 ~ &quot;young adult&quot;, Age &gt; 35 ~ &quot;middle age&quot;)) %&gt;% drop_na(DX, Age_coarse) %&gt;% ggplot(aes(y = num_sc_vx_gt, x = vx_gt_thres, color = DX)) + #geom_line(aes(group = subject), alpha = 0.1) + geom_smooth(aes(linetype = Age_coarse)) + facet_wrap(~NETWORK*Site, ncol = 4) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; combined_df %&gt;% filter(Age &gt; 17, Age &lt; 51) %&gt;% mutate(Age_decade = case_when(Age &lt; 20 ~ &#39;17-20&#39;, Age &gt;= 20 &amp; Age &lt; 30 ~ &#39;20-30&#39;, Age &gt;= 30 &amp; Age &lt; 40 ~ &#39;30-40&#39;, Age &gt;= 40 &amp; Age &lt; 50 ~ &#39;40-50&#39;, Age &gt; 50 ~ &quot;50 above&quot;)) %&gt;% mutate(Age_coarse = case_when(Age &lt; 30 ~ &quot;young adult&quot;, Age &gt; 35 ~ &quot;middle age&quot;)) %&gt;% drop_na(DX, Age_coarse) %&gt;% ggplot(aes(y = num_sc_vx_gt, x = vx_gt_thres)) + geom_line(aes(group = subject, color = Age), alpha = 0.15) + geom_smooth(aes(linetype = Age_coarse), color = &quot;black&quot;) + scale_color_viridis_c(option = &quot;D&quot;) + facet_grid(DX~NETWORK) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; combined_df %&gt;% filter(Age &gt; 17, Age &lt; 51) %&gt;% mutate(Age_decade = case_when(Age &lt; 20 ~ &#39;17-20&#39;, Age &gt;= 20 &amp; Age &lt; 30 ~ &#39;20-30&#39;, Age &gt;= 30 &amp; Age &lt; 40 ~ &#39;30-40&#39;, Age &gt;= 40 &amp; Age &lt; 50 ~ &#39;40-50&#39;, Age &gt; 50 ~ &quot;50 above&quot;)) %&gt;% mutate(Age_coarse = case_when(Age &lt; 30 ~ &quot;young adult&quot;, Age &gt; 35 ~ &quot;middle age&quot;)) %&gt;% drop_na(DX, Age_coarse) %&gt;% ggplot(aes(y = num_sc_vx_gt, x = vx_gt_thres)) + geom_line(aes(group = subject, color = Age), alpha = 0.15) + geom_smooth(aes(linetype = Age_coarse), color = &quot;black&quot;) + scale_color_viridis_c(option = &quot;D&quot;) + facet_grid(~NETWORK) ## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39; combined_df %&gt;% filter(vx_gt_thres == &quot;0.5&quot;) %&gt;% mutate(Age_decade = case_when(Age &lt; 20 ~ &#39;17-20&#39;, Age &gt;= 20 &amp; Age &lt; 30 ~ &#39;20-30&#39;, Age &gt;= 30 &amp; Age &lt; 40 ~ &#39;30-40&#39;, Age &gt;= 40 &amp; Age &lt; 50 ~ &#39;40-50&#39;, Age &gt; 50 ~ &quot;50 above&quot;)) %&gt;% mutate(Age_coarse = case_when(Age &lt; 30 ~ &quot;young adult&quot;, Age &gt; 35 ~ &quot;middle age&quot;)) %&gt;% drop_na(DX) %&gt;% ggplot(aes(y = num_sc_vx_gt, x = Age, color = DX)) + geom_point(alpha = 0.15) + geom_smooth(method = lm) + facet_grid(~NETWORK) combined_df %&gt;% filter(Age &gt; 17, Age &lt; 51) %&gt;% mutate(Age_decade = case_when(Age &lt; 20 ~ &#39;17-20&#39;, Age &gt;= 20 &amp; Age &lt; 30 ~ &#39;20-30&#39;, Age &gt;= 30 &amp; Age &lt; 40 ~ &#39;30-40&#39;, Age &gt;= 40 &amp; Age &lt; 50 ~ &#39;40-50&#39;, Age &gt; 50 ~ &quot;50 above&quot;)) %&gt;% mutate(Age_coarse = case_when(Age &lt; 30 ~ &quot;young adult&quot;, Age &gt; 35 ~ &quot;middle age&quot;)) %&gt;% filter(NETWORK == 5, vx_gt_thres ==0.5) %&gt;% count(DX, Site, Age_coarse) ## # A tibble: 24 x 4 ## DX Site Age_coarse n ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; ## 1 CTRL CMH &lt;NA&gt; 7 ## 2 CTRL CMH middle age 3 ## 3 CTRL CMH young adult 30 ## 4 CTRL COBRE &lt;NA&gt; 7 ## 5 CTRL COBRE middle age 13 ## 6 CTRL COBRE young adult 14 ## 7 CTRL ds000030 &lt;NA&gt; 14 ## 8 CTRL ds000030 middle age 30 ## 9 CTRL ds000030 young adult 61 ## 10 CTRL ZHH &lt;NA&gt; 12 ## # … with 14 more rows "],
["sub-cortical-cortical-stats-left-and-right.html", "Chapter 7 Sub-cortical Cortical Stats Left and Right 7.1 The paths to data 7.2 make a subject table from resuts pheno", " Chapter 7 Sub-cortical Cortical Stats Left and Right This analysis tries to combine timeseries data from PINT outputs with subcortical timeseries to ask two questions “External” validation of PINT. If PINT is indeed helping us better target meaningful resting state networks than we should see “cleaner” patterns of between the PINT output cortical ROIs and parcels of the subcortical structure that have been associated with these networks in literature. i.e. connectivity of the cortical ROIS with “expected” subcortical parcel should increae and correlation with other parcels should decrease after PINT. To interograte SSD related differences in Cortical-Subcortical connectivity - and to see if they persist after PINT. Some work Ji (in prep) kinda suggests that there might be differences between left and right subcortical structures. AND spliting the left and right seemed to make more sense for whole brain correlations (because our cortical nodes have a hemisphere). So in this analysis have separate left and right ROIs library(tidyverse) ## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ ggplot2 3.1.0 ✔ purrr 0.2.5 ## ✔ tibble 2.0.1 ✔ dplyr 0.8.0.1 ## ✔ tidyr 0.8.2 ✔ stringr 1.3.1 ## ✔ readr 1.3.0 ✔ forcats 0.3.0 ## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(broom) library(knitr) library(tableone) library(cowplot) ## ## Attaching package: &#39;cowplot&#39; ## The following object is masked from &#39;package:ggplot2&#39;: ## ## ggsave library(ggridges) ## ## Attaching package: &#39;ggridges&#39; ## The following object is masked from &#39;package:ggplot2&#39;: ## ## scale_discrete_manual library(here) ## here() starts at /mnt/tigrlab/projects/edickie/code/SZ_PINT 7.1 The paths to data source(here(&#39;code/R/settings_helpers.R&#39;)) pheno &lt;- read_pheno_file() ## Parsed with column specification: ## cols( ## .default = col_double(), ## dataset = col_character(), ## subject_id = col_character(), ## session_id = col_character(), ## task_id = col_character(), ## run_id = col_character(), ## acq_id = col_character(), ## subject = col_character(), ## session = col_character(), ## cmh_session_id = col_character(), ## DX = col_character(), ## Sex = col_character(), ## Site = col_character(), ## Scanner = col_character(), ## isFEP = col_character(), ## ghost_NoGhost = col_character(), ## filename = col_character() ## ) ## See spec(...) for full column specifications. YeoNet_colours &lt;- define_Yeo7_colours() Yeo7_2011_80verts &lt;- read_Yeo72011_template() the_subcortical_guide &lt;- get_subcortical_guide() ## Parsed with column specification: ## cols( ## subcort_hemi = col_character(), ## subcort_ROI = col_character(), ## numvx = col_double(), ## network = col_character() ## ) node_annotations &lt;- get_node_annotations(Yeo7_2011_80verts, the_subcortical_guide) source(here(&#39;code/R/custom_plot_helpers.R&#39;)) source(here(&#39;code/R/file_reading_helpers.R&#39;)) This reads all files and generate PINT to subcortical correlation values for a given subject 7.1.1 This reads all the subcortical files it can find Write a func_base and outputprefix cols into the pheno file for the file reading step pheno &lt;- pheno %&gt;% mutate(func_base = get_func_base_from_pint_summary_filename(filename,subject, session), outputprefix = construct_output_prefix(subject, session, func_base)) a litle chunck I use to test if test if the reader is working… run_read_all_subject_timeseries_and_subcortcort_corZ(pheno$outputprefix[1], pheno$dataset[1]) all_subcort_results &lt;- pheno %&gt;% select(subject, outputprefix, dataset) %&gt;% mutate(subcort_corrs = map2(outputprefix, dataset, ~run_read_all_subject_timeseries_and_subcortcort_corZ(.x, .y))) save(all_subcort_results, file = here(&quot;data/processed/Rdata_cache/03_subcort_results_cache.Rdata&quot;)) load(here(&quot;data/processed/Rdata_cache/03_subcort_results_cache.Rdata&quot;)) 7.1.2 merge with the phenotypic data results_pheno &lt;- all_subcort_results %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% unnest() %&gt;% inner_join(the_subcortical_guide, by = c(&quot;combined_name&quot;)) %&gt;% mutate(YeoNet = str_sub(PINT_ROI, 1,2), hemisphere = str_sub(PINT_ROI, 5,5)) %&gt;% mutate(conn_type = if_else(YeoNet == subcort_NET, &quot;same_net&quot;, &quot;diff_net&quot;), YeoNet = factor(YeoNet, levels = c(&quot;VI&quot;, &quot;SM&quot;, &quot;DA&quot;, &quot;VA&quot;, &quot;FP&quot;, &quot;DM&quot;)), subcort_NET = factor(subcort_NET, levels = c(&quot;VI&quot;, &quot;SM&quot;, &quot;DA&quot;, &quot;VA&quot;, &quot;FP&quot;, &quot;DM&quot;, &quot;LI&quot;))) %&gt;% select(subject, dataset, PINT_ROI, subcort_ROI, subcort_NET,subcort_hemi, pvertex_corr, tvertex_corr, tvolume_corr, DX, Sex, fd_mean, Age, Site, Scanner, Age_pt, fd_mean_pt, YeoNet, hemisphere, conn_type) 7.2 make a subject table from resuts pheno library(tableone) therealtable1 &lt;- CreateTableOne( strata = c(&quot;DX&quot;, &quot;Site&quot;), vars = c(&quot;Age&quot;, &quot;Sex&quot;, &quot;fd_mean&quot;, &quot;fd_perc&quot;), data = filter(results_pheno, PINT_ROI==&quot;DMP1L&quot;,subcort_ROI==&quot;thalamus&quot;, subcort_NET==&quot;VA&quot;, subcort_hemi == &quot;L&quot;) ) ## Warning in ModuleReturnVarsExist(vars, data): The data frame does not have: ## fd_perc Dropped tabMat &lt;- print(therealtable1, quote = FALSE, noSpaces = TRUE, printToggle = FALSE) kable(tabMat) CTRL:CMH SSD:CMH CTRL:COBRE SSD:COBRE CTRL:ds000030 SSD:ds000030 CTRL:ZHH SSD:ZHH p test n 41 67 35 22 107 31 111 83 Age (mean (SD)) 26.37 (6.67) 32.19 (8.47) 33.17 (9.01) 29.55 (12.14) 30.42 (8.14) 35.23 (9.32) 25.07 (6.55) 25.83 (8.98) &lt;0.001 Sex = M (%) 22 (53.7) 40 (59.7) 23 (65.7) 19 (86.4) 55 (51.4) 24 (77.4) 48 (43.2) 63 (75.9) &lt;0.001 fd_mean (mean (SD)) 0.10 (0.04) 0.12 (0.06) 0.18 (0.04) 0.21 (0.08) 0.14 (0.07) 0.18 (0.07) 0.12 (0.04) 0.12 (0.06) &lt;0.001 library(tableone) therealtable1 &lt;- CreateTableOne( vars = c(&quot;Age&quot;, &quot;Sex&quot;, &quot;DX&quot;, &quot;fd_mean&quot;, &quot;fd_perc&quot;), data = filter(results_pheno, PINT_ROI==&quot;DMP1L&quot;,subcort_ROI==&quot;thalamus&quot;, subcort_NET==&quot;VA&quot;, subcort_hemi == &quot;L&quot;) ) ## Warning in ModuleReturnVarsExist(vars, data): The data frame does not have: ## fd_perc Dropped tabMat &lt;- print(therealtable1, quote = FALSE, noSpaces = TRUE, printToggle = FALSE) kable(tabMat) Overall n 497 Age (mean (SD)) 28.82 (8.85) Sex = M (%) 294 (59.2) DX = SSD (%) 203 (40.8) fd_mean (mean (SD)) 0.14 (0.06) "],
["is-pint-focusing-cortical-subcortical-connectivity.html", "Chapter 8 Is PINT “focusing” cortical subcortical connectivity", " Chapter 8 Is PINT “focusing” cortical subcortical connectivity table1 &lt;- results_pheno %&gt;% mutate(corr_diff = pvertex_corr - tvertex_corr) %&gt;% gather(corr_type, rval, pvertex_corr, tvertex_corr, tvolume_corr) %&gt;% group_by(corr_type, YeoNet, subcort_ROI, subcort_NET) %&gt;% summarise(n = n(), Mean = mean(rval), SD = sd(rval)) ggplot(table1, aes(y = YeoNet, x = subcort_NET, fill = Mean)) + geom_tile() + scale_fill_distiller(breaks = c(-0.5,0.5), type = &quot;div&quot;, palette = 5) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + facet_grid(subcort_ROI~corr_type) functions to help re-annotated the function axes #&#39; sets some the main variables to factors to more descriptive labels add_corrtype_and_subcortROI_columns &lt;- function(data) { result &lt;- data %&gt;% mutate(corrtype = factor(corr_type, levels = c(&#39;tvolume_corr&#39;,&#39;tvertex_corr&#39;,&#39;pvertex_corr&#39;), labels = c(&quot;Volume Template&quot;, &quot;Surface Template&quot;, &quot;Surface Personalized&quot;)), subcortROI = factor(subcort_ROI, levels = c(&quot;striatum&quot;, &quot;thalamus&quot;, &quot;cerebellum&quot;), labels = c(&quot;Striatum&quot;, &quot;Thalamus&quot;, &quot;Cerebellum&quot;))) return(result) } #&#39;drop VI DA and LI network from resutls drop_VI_DA_LI &lt;- function(data) { result &lt;- data %&gt;% filter(subcort_NET != &quot;VI&quot;, subcort_NET != &quot;DA&quot;, subcort_NET != &quot;LI&quot;, YeoNet != &quot;VI&quot;, YeoNet != &quot;DA&quot;) return(result) } table1 %&gt;% drop_VI_DA_LI() %&gt;% add_corrtype_and_subcortROI_columns() %&gt;% ggplot(aes(y = YeoNet, x = subcort_NET, fill = Mean)) + geom_tile() + geom_text(aes(label = sprintf(&#39;%3.2f&#39;,Mean))) + scale_fill_distiller(breaks = c(-0.5,0.5), type = &quot;div&quot;, palette = 5) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + facet_grid(corrtype~subcortROI) + labs(y = &quot;Cortical RSN Network&quot;, x = &quot;Subcortical Subregion&quot;) table1 &lt;- results_pheno %&gt;% mutate(corr_diff = pvertex_corr - tvertex_corr) %&gt;% gather(corr_type, rval, pvertex_corr, tvertex_corr, tvolume_corr) %&gt;% group_by(corr_type, YeoNet, hemisphere, subcort_ROI, subcort_NET, subcort_hemi) %&gt;% summarise(n = n(), Mean = mean(rval), SD = sd(rval)) table1 %&gt;% drop_VI_DA_LI() %&gt;% add_corrtype_and_subcortROI_columns() %&gt;% ggplot(aes(y = YeoNet, x = subcort_NET, fill = Mean)) + geom_tile() + geom_text(aes(label = sprintf(&#39;%3.2f&#39;,Mean))) + scale_fill_distiller(breaks = c(-0.5,0.5), type = &quot;div&quot;, palette = 5) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + facet_grid(subcortROI*subcort_hemi~corrtype*hemisphere) + labs(y = &quot;Cortical RSN Network&quot;, x = &quot;Subcortical Subregion&quot;) We see in the above figure that the Yeo 7 Network connectivity strongly shows the expected pattern in the cerebeullum. Lower evidence is seen in the striatum and thalamus, although there is a faint increase across the diagonal for the SM, VA and DM especially net_means &lt;- results_pheno %&gt;% mutate(corr_diff = pvertex_corr - tvertex_corr) %&gt;% group_by(YeoNet, subcort_ROI, subcort_NET, conn_type, subject) %&gt;% summarise(netmean_pvertex = mean(pvertex_corr), netmean_tvertex = mean(tvertex_corr), netmean_tvolume = mean(tvolume_corr)) %&gt;% ungroup() net_means_pint_t &lt;- net_means %&gt;% group_by(YeoNet, subcort_ROI, subcort_NET) %&gt;% do(tidy(t.test(.$netmean_pvertex, .$netmean_tvertex, paired = TRUE))) %&gt;% ungroup() %&gt;% mutate(p_FDR = p.adjust(p.value, method = &quot;fdr&quot;)) net_means_pint_t %&gt;% ungroup() %&gt;% mutate(sig = if_else(p_FDR &lt; 0.05, &#39;*&#39;, NA_character_) ) %&gt;% drop_VI_DA_LI() %&gt;% mutate(subcortROI = factor(subcort_ROI, levels = c(&quot;striatum&quot;, &quot;thalamus&quot;, &quot;cerebellum&quot;), labels = c(&quot;Striatum&quot;, &quot;Thalamus&quot;, &quot;Cerebellum&quot;))) %&gt;% ggplot(aes(x = YeoNet, y = subcort_NET, fill = statistic)) + geom_tile(color = &quot;black&quot;, na.rm = TRUE) + geom_point(aes(shape = sig), na.rm = TRUE) + scale_fill_distiller(breaks = c(-10,10), type = &quot;div&quot;, palette = 5) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + facet_wrap(~subcortROI) Here we plot the paired t-stat camparing personalized to template, we see a very strong increase in correlation along the diagonal (i.e. with the hypothesized regions) and decreases on the off-dignonal (i.e. decreased connectivity with the other network’s parcels) net_means_vpint_t &lt;- net_means %&gt;% group_by(YeoNet, subcort_ROI, subcort_NET) %&gt;% do(tidy(t.test(.$netmean_pvertex, .$netmean_tvolume, paired = TRUE))) %&gt;% ungroup() %&gt;% mutate(p_FDR = p.adjust(p.value, method = &quot;fdr&quot;)) net_means_vpint_t %&gt;% ungroup() %&gt;% mutate(sig = if_else(p_FDR &lt; 0.05, &#39;*&#39;, NA_character_) ) %&gt;% drop_VI_DA_LI() %&gt;% mutate(subcortROI = factor(subcort_ROI, levels = c(&quot;striatum&quot;, &quot;thalamus&quot;, &quot;cerebellum&quot;), labels = c(&quot;Striatum&quot;, &quot;Thalamus&quot;, &quot;Cerebellum&quot;))) %&gt;% ggplot(aes(x = YeoNet, y = subcort_NET, fill = statistic)) + geom_tile(color = &quot;black&quot;, na.rm = TRUE) + geom_point(aes(shape = sig), na.rm = TRUE) + scale_fill_distiller(breaks = c(-10,10), type = &quot;div&quot;, palette = 5) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + facet_wrap(~subcortROI) "],
["trying-to-calculate-an-vs-off-diagonal-term.html", "Chapter 9 trying to calculate an vs off diagonal term", " Chapter 9 trying to calculate an vs off diagonal term In the above table to calcuculated the “focussing” effect as the change (in on person) between in connectivity with the expected parcel subtracted by the change in connectivity from other regions. Below we plot these values against zero net_focus &lt;- net_means %&gt;% ungroup() %&gt;% mutate(pint_diff = netmean_pvertex - netmean_tvertex, vpint_diff = netmean_pvertex - netmean_tvolume, surf_diff = netmean_tvertex - netmean_tvolume) %&gt;% group_by(subject, subcort_ROI, YeoNet, conn_type) %&gt;% summarise(nets_avg_pint_diff = mean(pint_diff), nets_avg_vpint_diff = mean(vpint_diff), nets_avg_surf_diff = mean(surf_diff) ) %&gt;% ungroup() %&gt;% gather(comparison, nets_avg, nets_avg_pint_diff, nets_avg_vpint_diff, nets_avg_surf_diff) %&gt;% spread(conn_type, nets_avg) %&gt;% mutate(focus_effect = same_net - diff_net) net_focus %&gt;% ungroup() %&gt;% group_by(subcort_ROI, YeoNet, comparison) %&gt;% do(tidy(t.test(.$focus_effect))) %&gt;% kable() subcort_ROI YeoNet comparison estimate statistic p.value parameter conf.low conf.high method alternative cerebellum VI nets_avg_pint_diff 0.0274058 11.6427697 0.0000000 493 0.0227809 0.0320307 One Sample t-test two.sided cerebellum VI nets_avg_surf_diff 0.0414541 10.8475696 0.0000000 493 0.0339456 0.0489625 One Sample t-test two.sided cerebellum VI nets_avg_vpint_diff 0.0688599 14.1640353 0.0000000 493 0.0593079 0.0784119 One Sample t-test two.sided cerebellum SM nets_avg_pint_diff 0.0205586 9.4833067 0.0000000 493 0.0162992 0.0248181 One Sample t-test two.sided cerebellum SM nets_avg_surf_diff 0.0518569 15.4654578 0.0000000 493 0.0452688 0.0584450 One Sample t-test two.sided cerebellum SM nets_avg_vpint_diff 0.0724155 17.4516048 0.0000000 493 0.0642626 0.0805684 One Sample t-test two.sided cerebellum DA nets_avg_pint_diff 0.0287201 12.9214762 0.0000000 493 0.0243531 0.0330872 One Sample t-test two.sided cerebellum DA nets_avg_surf_diff 0.0418660 13.7824757 0.0000000 493 0.0358977 0.0478343 One Sample t-test two.sided cerebellum DA nets_avg_vpint_diff 0.0705861 17.1307845 0.0000000 493 0.0624904 0.0786819 One Sample t-test two.sided cerebellum VA nets_avg_pint_diff 0.0333369 16.8287593 0.0000000 493 0.0294448 0.0372291 One Sample t-test two.sided cerebellum VA nets_avg_surf_diff 0.0560229 19.6440835 0.0000000 493 0.0504195 0.0616263 One Sample t-test two.sided cerebellum VA nets_avg_vpint_diff 0.0893598 22.4772273 0.0000000 493 0.0815487 0.0971710 One Sample t-test two.sided cerebellum FP nets_avg_pint_diff 0.0418528 18.7746195 0.0000000 493 0.0374728 0.0462327 One Sample t-test two.sided cerebellum FP nets_avg_surf_diff 0.0367357 15.3459008 0.0000000 493 0.0320323 0.0414391 One Sample t-test two.sided cerebellum FP nets_avg_vpint_diff 0.0785885 22.6607390 0.0000000 493 0.0717745 0.0854025 One Sample t-test two.sided cerebellum DM nets_avg_pint_diff 0.0537150 21.0774329 0.0000000 493 0.0487078 0.0587222 One Sample t-test two.sided cerebellum DM nets_avg_surf_diff 0.0609553 17.7505429 0.0000000 493 0.0542082 0.0677024 One Sample t-test two.sided cerebellum DM nets_avg_vpint_diff 0.1146703 25.1856622 0.0000000 493 0.1057247 0.1236160 One Sample t-test two.sided striatum VI nets_avg_pint_diff 0.0009511 0.4219322 0.6732584 493 -0.0034778 0.0053801 One Sample t-test two.sided striatum VI nets_avg_surf_diff 0.0089229 2.5173188 0.0121412 493 0.0019585 0.0158873 One Sample t-test two.sided striatum VI nets_avg_vpint_diff 0.0098740 2.2471214 0.0250738 493 0.0012406 0.0185074 One Sample t-test two.sided striatum SM nets_avg_pint_diff 0.0094129 5.1440821 0.0000004 493 0.0058176 0.0130081 One Sample t-test two.sided striatum SM nets_avg_surf_diff 0.0200427 7.3152876 0.0000000 493 0.0146595 0.0254258 One Sample t-test two.sided striatum SM nets_avg_vpint_diff 0.0294555 8.3944137 0.0000000 493 0.0225612 0.0363498 One Sample t-test two.sided striatum DA nets_avg_pint_diff 0.0050523 2.8423068 0.0046645 493 0.0015598 0.0085448 One Sample t-test two.sided striatum DA nets_avg_surf_diff 0.0079077 3.6956109 0.0002439 493 0.0037036 0.0121119 One Sample t-test two.sided striatum DA nets_avg_vpint_diff 0.0129600 4.2216095 0.0000289 493 0.0069283 0.0189918 One Sample t-test two.sided striatum VA nets_avg_pint_diff 0.0211444 14.7052079 0.0000000 493 0.0183193 0.0239696 One Sample t-test two.sided striatum VA nets_avg_surf_diff 0.0362259 17.2538786 0.0000000 493 0.0321007 0.0403512 One Sample t-test two.sided striatum VA nets_avg_vpint_diff 0.0573704 20.8643397 0.0000000 493 0.0519678 0.0627729 One Sample t-test two.sided striatum FP nets_avg_pint_diff 0.0092542 5.0349801 0.0000007 493 0.0056430 0.0128654 One Sample t-test two.sided striatum FP nets_avg_surf_diff 0.0121264 6.3329143 0.0000000 493 0.0083642 0.0158886 One Sample t-test two.sided striatum FP nets_avg_vpint_diff 0.0213806 7.5728809 0.0000000 493 0.0158334 0.0269278 One Sample t-test two.sided striatum DM nets_avg_pint_diff 0.0097812 4.7171291 0.0000031 493 0.0057071 0.0138552 One Sample t-test two.sided striatum DM nets_avg_surf_diff 0.0176855 7.2184575 0.0000000 493 0.0128717 0.0224993 One Sample t-test two.sided striatum DM nets_avg_vpint_diff 0.0274667 8.1032250 0.0000000 493 0.0208069 0.0341265 One Sample t-test two.sided thalamus VI nets_avg_pint_diff 0.0066896 4.0687435 0.0000550 493 0.0034592 0.0099200 One Sample t-test two.sided thalamus VI nets_avg_surf_diff 0.0171712 7.4188092 0.0000000 493 0.0126236 0.0217188 One Sample t-test two.sided thalamus VI nets_avg_vpint_diff 0.0238608 7.9818600 0.0000000 493 0.0179873 0.0297343 One Sample t-test two.sided thalamus SM nets_avg_pint_diff 0.0286083 12.8286466 0.0000000 493 0.0242267 0.0329898 One Sample t-test two.sided thalamus SM nets_avg_surf_diff 0.0603081 17.7481689 0.0000000 493 0.0536317 0.0669844 One Sample t-test two.sided thalamus SM nets_avg_vpint_diff 0.0889163 20.5025373 0.0000000 493 0.0803954 0.0974373 One Sample t-test two.sided thalamus DA nets_avg_pint_diff 0.0151436 7.9828345 0.0000000 493 0.0114163 0.0188708 One Sample t-test two.sided thalamus DA nets_avg_surf_diff 0.0288789 11.1873927 0.0000000 493 0.0238070 0.0339507 One Sample t-test two.sided thalamus DA nets_avg_vpint_diff 0.0440224 12.3863970 0.0000000 493 0.0370394 0.0510055 One Sample t-test two.sided thalamus VA nets_avg_pint_diff 0.0113488 7.2527919 0.0000000 493 0.0082744 0.0144231 One Sample t-test two.sided thalamus VA nets_avg_surf_diff 0.0150747 6.5191917 0.0000000 493 0.0105314 0.0196180 One Sample t-test two.sided thalamus VA nets_avg_vpint_diff 0.0264234 8.5697441 0.0000000 493 0.0203653 0.0324815 One Sample t-test two.sided thalamus FP nets_avg_pint_diff 0.0119887 6.6019451 0.0000000 493 0.0084208 0.0155567 One Sample t-test two.sided thalamus FP nets_avg_surf_diff 0.0248535 11.0328590 0.0000000 493 0.0204275 0.0292796 One Sample t-test two.sided thalamus FP nets_avg_vpint_diff 0.0368423 11.7443622 0.0000000 493 0.0306787 0.0430058 One Sample t-test two.sided thalamus DM nets_avg_pint_diff 0.0159898 8.4683314 0.0000000 493 0.0122799 0.0196997 One Sample t-test two.sided thalamus DM nets_avg_surf_diff 0.0223480 9.0617516 0.0000000 493 0.0175025 0.0271936 One Sample t-test two.sided thalamus DM nets_avg_vpint_diff 0.0383378 11.4373011 0.0000000 493 0.0317519 0.0449238 One Sample t-test two.sided Another (maybe better) way to test this is to show calculate the “focusing” value in individual subjects THAN compute how this number changes with PINT. Let try that.. subject_focus &lt;- net_means %&gt;% drop_VI_DA_LI() %&gt;% gather(vertex_type, nets_avg, netmean_pvertex, netmean_tvertex, netmean_tvolume) %&gt;% ungroup(subcort_NET) %&gt;% group_by(subject, subcort_ROI, YeoNet, vertex_type, conn_type) %&gt;% summarise(nets_type_avg = mean(nets_avg)) %&gt;% spread(conn_type, nets_type_avg) # %&gt;% # ungroup() %&gt;% # mutate(focus_effect = same_net - diff_net) subject_focus %&gt;% ungroup() %&gt;% group_by(subcort_ROI, YeoNet, vertex_type) %&gt;% do(tidy(t.test(.$same_net, .$diff_net, paired = TRUE))) %&gt;% mutate(cohenD = statistic/sqrt(parameter + 1)) %&gt;% kable() subcort_ROI YeoNet vertex_type estimate statistic p.value parameter conf.low conf.high method alternative cohenD cerebellum SM netmean_pvertex 0.2399467 36.70593 0 493 0.2271029 0.2527905 Paired t-test two.sided 1.6514780 cerebellum SM netmean_tvertex 0.2084729 37.71938 0 493 0.1976137 0.2193322 Paired t-test two.sided 1.6970749 cerebellum SM netmean_tvolume 0.1431050 33.82311 0 493 0.1347920 0.1514180 Paired t-test two.sided 1.5217737 cerebellum VA netmean_pvertex 0.2412299 36.30497 0 493 0.2281748 0.2542850 Paired t-test two.sided 1.6334377 cerebellum VA netmean_tvertex 0.1985123 36.86791 0 493 0.1879331 0.2090916 Paired t-test two.sided 1.6587658 cerebellum VA netmean_tvolume 0.1258778 33.72861 0 493 0.1185450 0.1332105 Paired t-test two.sided 1.5175218 cerebellum FP netmean_pvertex 0.1872801 39.61782 0 493 0.1779922 0.1965680 Paired t-test two.sided 1.7824899 cerebellum FP netmean_tvertex 0.1425105 40.63385 0 493 0.1356197 0.1494014 Paired t-test two.sided 1.8282034 cerebellum FP netmean_tvolume 0.1024950 38.22818 0 493 0.0972271 0.1077629 Paired t-test two.sided 1.7199671 cerebellum DM netmean_pvertex 0.2977314 41.69784 0 493 0.2837024 0.3117604 Paired t-test two.sided 1.8760745 cerebellum DM netmean_tvertex 0.2405480 40.98858 0 493 0.2290173 0.2520786 Paired t-test two.sided 1.8441635 cerebellum DM netmean_tvolume 0.1790535 38.59262 0 493 0.1699378 0.1881693 Paired t-test two.sided 1.7363642 striatum SM netmean_pvertex 0.1077970 18.24899 0 493 0.0961910 0.1194030 Paired t-test two.sided 0.8210609 striatum SM netmean_tvertex 0.0962070 19.48143 0 493 0.0865041 0.1059099 Paired t-test two.sided 0.8765110 striatum SM netmean_tvolume 0.0724419 17.79229 0 493 0.0644422 0.0804416 Paired t-test two.sided 0.8005130 striatum VA netmean_pvertex 0.0996744 27.38295 0 493 0.0925226 0.1068263 Paired t-test two.sided 1.2320172 striatum VA netmean_tvertex 0.0801373 27.68073 0 493 0.0744491 0.0858255 Paired t-test two.sided 1.2454151 striatum VA netmean_tvolume 0.0478839 21.51229 0 493 0.0435105 0.0522573 Paired t-test two.sided 0.9678838 striatum FP netmean_pvertex 0.0489004 14.43359 0 493 0.0422438 0.0555571 Paired t-test two.sided 0.6493980 striatum FP netmean_tvertex 0.0413781 16.76016 0 493 0.0365274 0.0462288 Paired t-test two.sided 0.7540750 striatum FP netmean_tvolume 0.0313351 15.48405 0 493 0.0273589 0.0353112 Paired t-test two.sided 0.6966604 striatum DM netmean_pvertex 0.0798067 15.31447 0 493 0.0695678 0.0900456 Paired t-test two.sided 0.6890306 striatum DM netmean_tvertex 0.0706844 18.07803 0 493 0.0630022 0.0783667 Paired t-test two.sided 0.8133688 striatum DM netmean_tvolume 0.0529355 14.67428 0 493 0.0458478 0.0600232 Paired t-test two.sided 0.6602272 thalamus SM netmean_pvertex 0.2350851 32.39511 0 493 0.2208270 0.2493431 Paired t-test two.sided 1.4575250 thalamus SM netmean_tvertex 0.2021965 33.02133 0 493 0.1901657 0.2142273 Paired t-test two.sided 1.4856999 thalamus SM netmean_tvolume 0.1358514 30.44286 0 493 0.1270835 0.1446193 Paired t-test two.sided 1.3696888 thalamus VA netmean_pvertex 0.0603700 14.93815 0 493 0.0524297 0.0683104 Paired t-test two.sided 0.6720992 thalamus VA netmean_tvertex 0.0473139 14.86396 0 493 0.0410598 0.0535681 Paired t-test two.sided 0.6687610 thalamus VA netmean_tvolume 0.0300578 12.36652 0 493 0.0252823 0.0348334 Paired t-test two.sided 0.5563961 thalamus FP netmean_pvertex 0.0902495 21.08280 0 493 0.0818388 0.0986602 Paired t-test two.sided 0.9485600 thalamus FP netmean_tvertex 0.0774761 23.60518 0 493 0.0710274 0.0839249 Paired t-test two.sided 1.0620471 thalamus FP netmean_tvolume 0.0512406 20.50364 0 493 0.0463304 0.0561508 Paired t-test two.sided 0.9225024 thalamus DM netmean_pvertex 0.1107613 21.42708 0 493 0.1006049 0.1209178 Paired t-test two.sided 0.9640500 thalamus DM netmean_tvertex 0.0931132 23.53542 0 493 0.0853399 0.1008865 Paired t-test two.sided 1.0589084 thalamus DM netmean_tvolume 0.0704012 20.23685 0 493 0.0635659 0.0772364 Paired t-test two.sided 0.9104988 subcortical_raincloud(subject_focus, &quot;striatum&quot;) ## Picking joint bandwidth of 0.0269 ## Picking joint bandwidth of 0.024 ## Picking joint bandwidth of 0.0236 ## Picking joint bandwidth of 0.0142 ## Picking joint bandwidth of 0.0252 ## Picking joint bandwidth of 0.0157 ## Picking joint bandwidth of 0.0334 ## Warning: Removed 7 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.0276 subcortical_raincloud(subject_focus, &quot;thalamus&quot;) ## Picking joint bandwidth of 0.0237 ## Picking joint bandwidth of 0.0237 ## Picking joint bandwidth of 0.0207 ## Picking joint bandwidth of 0.0184 ## Picking joint bandwidth of 0.0221 ## Picking joint bandwidth of 0.0179 ## Picking joint bandwidth of 0.0307 ## Warning: Removed 2 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.033 ## Warning: Removed 14 rows containing non-finite values ## (stat_density_ridges). subcortical_raincloud(subject_focus, &quot;cerebellum&quot;) ## Picking joint bandwidth of 0.0264 ## Warning: Removed 1 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.0322 ## Warning: Removed 24 rows containing non-finite values ## (stat_density_ridges). ## Picking joint bandwidth of 0.0217 ## Picking joint bandwidth of 0.0201 ## Warning: Removed 1 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.0265 ## Picking joint bandwidth of 0.0299 ## Warning: Removed 5 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.0312 ## Warning: Removed 11 rows containing non-finite values ## (stat_density_ridges). ## Picking joint bandwidth of 0.0305 ## Warning: Removed 8 rows containing non-finite values (stat_density_ridges). subject_focus %&gt;% ungroup() %&gt;% mutate(focus_effect = same_net - diff_net) %&gt;% select(subject, YeoNet, vertex_type, subcort_ROI, focus_effect) %&gt;% spread(vertex_type, focus_effect) %&gt;% group_by(subcort_ROI, YeoNet) %&gt;% do(tidy(t.test(.$netmean_pvertex, .$netmean_tvertex, paired = TRUE))) %&gt;% mutate(cohenD = statistic/sqrt(parameter + 1)) %&gt;% kable() subcort_ROI YeoNet estimate statistic p.value parameter conf.low conf.high method alternative cohenD cerebellum SM 0.0314738 12.942459 0.00e+00 493 0.0266958 0.0362518 Paired t-test two.sided 0.5823087 cerebellum VA 0.0427176 18.918221 0.00e+00 493 0.0382811 0.0471541 Paired t-test two.sided 0.8511710 cerebellum FP 0.0447695 19.684122 0.00e+00 493 0.0403008 0.0492383 Paired t-test two.sided 0.8856305 cerebellum DM 0.0571834 21.356022 0.00e+00 493 0.0519225 0.0624444 Paired t-test two.sided 0.9608528 striatum SM 0.0115900 5.681061 0.00e+00 493 0.0075816 0.0155984 Paired t-test two.sided 0.2556030 striatum VA 0.0195371 14.215170 0.00e+00 493 0.0168368 0.0222375 Paired t-test two.sided 0.6395707 striatum FP 0.0075224 4.428089 1.17e-05 493 0.0041846 0.0108601 Paired t-test two.sided 0.1992292 striatum DM 0.0091223 4.078587 5.28e-05 493 0.0047278 0.0135168 Paired t-test two.sided 0.1835043 thalamus SM 0.0328886 13.004730 0.00e+00 493 0.0279197 0.0378574 Paired t-test two.sided 0.5851105 thalamus VA 0.0130561 8.122775 0.00e+00 493 0.0098980 0.0162142 Paired t-test two.sided 0.3654609 thalamus FP 0.0127733 6.525782 0.00e+00 493 0.0089275 0.0166191 Paired t-test two.sided 0.2936088 thalamus DM 0.0176481 8.295198 0.00e+00 493 0.0134680 0.0218282 Paired t-test two.sided 0.3732186 subject_focus %&gt;% ungroup() %&gt;% mutate(focus_effect = same_net - diff_net) %&gt;% select(subject, YeoNet, vertex_type, subcort_ROI, focus_effect) %&gt;% spread(vertex_type, focus_effect) %&gt;% group_by(subcort_ROI, YeoNet) %&gt;% do(tidy(t.test(.$netmean_tvertex, .$netmean_tvolume, paired = TRUE))) %&gt;% mutate(cohenD = statistic/sqrt(parameter + 1)) %&gt;% kable() subcort_ROI YeoNet estimate statistic p.value parameter conf.low conf.high method alternative cohenD cerebellum SM 0.0653679 17.070999 0 493 0.0578444 0.0728914 Paired t-test two.sided 0.7680606 cerebellum VA 0.0726345 22.352361 0 493 0.0662499 0.0790192 Paired t-test two.sided 1.0056802 cerebellum FP 0.0400155 16.819785 0 493 0.0353412 0.0446899 Paired t-test two.sided 0.7567579 cerebellum DM 0.0614944 17.149929 0 493 0.0544493 0.0685395 Paired t-test two.sided 0.7716118 striatum SM 0.0237651 7.654866 0 493 0.0176653 0.0298649 Paired t-test two.sided 0.3444087 striatum VA 0.0322534 16.388022 0 493 0.0283865 0.0361203 Paired t-test two.sided 0.7373320 striatum FP 0.0100430 6.037727 0 493 0.0067748 0.0133112 Paired t-test two.sided 0.2716502 striatum DM 0.0177489 6.702068 0 493 0.0125456 0.0229522 Paired t-test two.sided 0.3015403 thalamus SM 0.0663451 17.281675 0 493 0.0588022 0.0738880 Paired t-test two.sided 0.7775393 thalamus VA 0.0172561 7.433846 0 493 0.0126953 0.0218169 Paired t-test two.sided 0.3344646 thalamus FP 0.0262355 11.161747 0 493 0.0216173 0.0308537 Paired t-test two.sided 0.5021908 thalamus DM 0.0227120 8.125153 0 493 0.0172199 0.0282042 Paired t-test two.sided 0.3655679 Recreating the DM plot from the poster to double check net_means &lt;- results_pheno %&gt;% ungroup() %&gt;% group_by(YeoNet, subcort_ROI, subcort_NET, subject) %&gt;% summarise(netmean_pvertex = mean(pvertex_corr), netmean_tvertex = mean(tvertex_corr), pint_diff = netmean_pvertex - netmean_tvertex) pint_diff_sub_DM &lt;- net_means %&gt;% ungroup() %&gt;% filter(YeoNet == &quot;DM&quot;, subcort_ROI == &quot;cerebellum&quot;) %&gt;% select(subject, subcort_NET, pint_diff) %&gt;% spread(subcort_NET, pint_diff) %&gt;% mutate(overall_pint_diff = DM - (SM + VA + FP + DA)/4, x_val = &#39;&#39;) %&gt;% select(subject, overall_pint_diff, x_val) %&gt;% ggplot(aes(y = overall_pint_diff, x = x_val)) + geom_boxplot(outlier.shape = NA) + geom_jitter(alpha = 0.3, color = YeoNet_colours$DM, fill = &quot;grey&quot;) + geom_hline(yintercept = 0) + labs(y = &quot;Change in correlation after PINT&quot;, x = &quot;Cerebellum DM - Others&quot;) + scale_y_continuous(limits = c(-0.3, 0.3)) DM_submeans_plot &lt;- net_means %&gt;% mutate(is_DM = if_else(subcort_NET == &#39;DM&#39;, TRUE, FALSE), SubCortNET = factor(subcort_NET, levels = c(&quot;DM&quot;, &quot;SM&quot;, &quot;DA&quot;, &quot;VA&quot;, &quot;FP&quot;))) %&gt;% filter(subcort_ROI == &quot;cerebellum&quot;, !is.na(SubCortNET), YeoNet == &quot;DM&quot;) %&gt;% ggplot(aes(y = pint_diff, x = SubCortNET, color = is_DM)) + geom_boxplot(color = &quot;black&quot;, outlier.shape = NA) + geom_jitter(alpha = 0.3) + geom_hline(yintercept = 0) + scale_color_manual(values = c(&#39;black&#39;,YeoNet_colours$DM)) + labs(y = &quot;Change in correlation after PINT&quot;, color = NULL, x = &quot;Subregion of Cerebellum&quot;) + theme(legend.position = &quot;none&quot;) + scale_y_continuous(limits = c(-0.3, 0.3)) # DM_brain_pic &lt;- ggdraw + draw_image(&#39;DM_striatum_pic.png&#39;) plot_grid(pint_diff_sub_DM, DM_submeans_plot, rel_widths = c(1,2.5)) "],
["cortical-cortical-results.html", "Chapter 10 Cortical-cortical results 10.1 To do - rainclouds for withing between changes in cortical cortical??", " Chapter 10 Cortical-cortical results Checking how the cortical-cortical stats change with adding surfaced based analyses and PINT library(tidyverse) ## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ ggplot2 3.1.0 ✔ purrr 0.2.5 ## ✔ tibble 2.0.1 ✔ dplyr 0.8.0.1 ## ✔ tidyr 0.8.2 ✔ stringr 1.3.1 ## ✔ readr 1.3.0 ✔ forcats 0.3.0 ## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(broom) library(knitr) library(cowplot) ## ## Attaching package: &#39;cowplot&#39; ## The following object is masked from &#39;package:ggplot2&#39;: ## ## ggsave library(ggridges) ## ## Attaching package: &#39;ggridges&#39; ## The following object is masked from &#39;package:ggplot2&#39;: ## ## scale_discrete_manual library(igraph) ## ## Attaching package: &#39;igraph&#39; ## The following objects are masked from &#39;package:dplyr&#39;: ## ## as_data_frame, groups, union ## The following objects are masked from &#39;package:purrr&#39;: ## ## compose, simplify ## The following object is masked from &#39;package:tidyr&#39;: ## ## crossing ## The following object is masked from &#39;package:tibble&#39;: ## ## as_data_frame ## The following objects are masked from &#39;package:stats&#39;: ## ## decompose, spectrum ## The following object is masked from &#39;package:base&#39;: ## ## union library(here) ## here() starts at /mnt/tigrlab/projects/edickie/code/SZ_PINT source(here(&#39;code/R/settings_helpers.R&#39;)) pheno &lt;- read_pheno_file() ## Parsed with column specification: ## cols( ## .default = col_double(), ## dataset = col_character(), ## subject_id = col_character(), ## session_id = col_character(), ## task_id = col_character(), ## run_id = col_character(), ## acq_id = col_character(), ## subject = col_character(), ## session = col_character(), ## cmh_session_id = col_character(), ## DX = col_character(), ## Sex = col_character(), ## Site = col_character(), ## Scanner = col_character(), ## isFEP = col_character(), ## ghost_NoGhost = col_character(), ## filename = col_character() ## ) ## See spec(...) for full column specifications. #YeoNet_colours &lt;- define_YeoN7_colours() Yeo7_2011_80verts &lt;- read_Yeo72011_template() #the_subcortical_guide &lt;- get_subcortical_guide() node_annotations &lt;- get_node_annotations(read_Yeo72011_template(), get_subcortical_guide()) ## Parsed with column specification: ## cols( ## subcort_hemi = col_character(), ## subcort_ROI = col_character(), ## numvx = col_double(), ## network = col_character() ## ) source(here(&#39;code/R/file_reading_helpers.R&#39;)) source(here(&#39;code/R/custom_plot_helpers.R&#39;)) pheno &lt;- pheno %&gt;% mutate(func_base = get_func_base_from_pint_summary_filename(filename,subject, session), outputprefix = construct_output_prefix(subject, session, func_base)) map2(pheno$outputprefix[1], pheno$dataset[1], ~run_read_all_subject_timeseries_and_cortcort_corZ(.x, .y)) all_corZ_results &lt;- pheno %&gt;% select(subject, outputprefix, dataset) %&gt;% mutate(the_corrs = map2(.$outputprefix, .$dataset, ~run_read_all_subject_timeseries_and_cortcort_corZ(.x, .y))) #&#39; go uppertri data to full dataframe for geom_tile uppertri_df_to_full &lt;- function(graph_df) { # converts from three col graph df to adjacency matrix uppertri_df_to_agjmat &lt;- function(graph_df) { names(graph_df) &lt;- c(&#39;to&#39;, &#39;from&#39;, &#39;myattr&#39;) matrix_out &lt;- graph_df %&gt;% graph_from_data_frame(.,directed = F) %&gt;% get.adjacency(., type = &quot;both&quot;, attr = &quot;myattr&quot;) %&gt;% as.matrix() return(matrix_out) } result &lt;- graph_df %&gt;% uppertri_df_to_agjmat() %&gt;% as.data.frame() %&gt;% mutate(to = row.names(.)) %&gt;% gather(from, value, -to) return(result) } mean_cors &lt;- all_corZ_results %&gt;% unnest() %&gt;% group_by(vertex_type, to, from) %&gt;% summarise(mcorZ = mean(weight)) mean_cors %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% withincortical_heatmap(&quot;Personalized Mean Correlation&quot;, mcorZ) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length mean_cors %&gt;% filter(vertex_type == &quot;tvertex&quot;) %&gt;% withincortical_heatmap(&quot;Surface Template Mean Correlation&quot;, mcorZ) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length mean_cors %&gt;% filter(vertex_type == &quot;tvolume&quot;) %&gt;% withincortical_heatmap(&quot;Volume Template Mean Correlation&quot;, mcorZ) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length thissubject = unique(pheno$subject)[2] this_results_pheno &lt;- all_corZ_results %&gt;% filter(subject==thissubject) %&gt;% unnest() this_results_pheno %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Personalized Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length this_results_pheno %&gt;% filter(vertex_type == &quot;tvertex&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Surface Template Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length this_results_pheno %&gt;% filter(vertex_type == &quot;tvolume&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Volume Template Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length thissubject = unique(pheno$subject)[3] this_results_pheno &lt;- all_corZ_results %&gt;% filter(subject==thissubject) %&gt;% unnest() this_results_pheno %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Personalized Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length this_results_pheno %&gt;% filter(vertex_type == &quot;tvertex&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Surface Template Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length this_results_pheno %&gt;% filter(vertex_type == &quot;tvolume&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Volume Template Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length thissubject = unique(pheno$subject)[100] this_results_pheno &lt;- all_corZ_results %&gt;% filter(subject==thissubject) %&gt;% unnest() this_results_pheno %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Personalized Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length this_results_pheno %&gt;% filter(vertex_type == &quot;tvertex&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Surface Template Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length this_results_pheno %&gt;% filter(vertex_type == &quot;tvolume&quot;) %&gt;% withincortical_heatmap(str_c(thissubject, &quot; Volume Template Correlation&quot;)) %&gt;% ggdraw() ## Warning in as.numeric(network) %&gt;% diff() * 1:80: longer object length is ## not a multiple of shorter object length 10.1 To do - rainclouds for withing between changes in cortical cortical?? Need to start by calculating indvididual subject same and diff means by network calc_wtn_and_cross_network_means &lt;- function(graph_df, node_list) { result &lt;- graph_df %&gt;% # setup the data by switching from upper-tri to full filter(to %in% node_list) %&gt;% filter(from %in% node_list) %&gt;% ungroup() %&gt;% select(to, from, weight) %&gt;% uppertri_df_to_full() %&gt;% # add columns we need to do the computation based on YeoNet7 naming convention.. mutate(to_network = str_sub(to, 1,2), wtn_or_cross = if_else(to_network == str_sub(from,1,2), &quot;within&quot;, &quot;cross&quot;)) %&gt;% # remove the same-edge bits filter(to != from) %&gt;% # group_by and compute the means group_by(to_network, wtn_or_cross) %&gt;% summarise(net_mean = mean(value)) return(result) } # define a vector of the cortical rois cortical_rois &lt;- node_annotations %&gt;% filter(etype == &quot;Cort&quot;) %&gt;% pull(node_name) # calculate all the subject-wise within and cross edge means all_subject_wtn_cross_means &lt;- all_corZ_results %&gt;% # slice(1) %&gt;% unnest() %&gt;% select(vertex_type, subject, dataset, to, from, weight) %&gt;% ungroup() %&gt;% group_by(vertex_type, subject, dataset) %&gt;% nest() %&gt;% mutate(net_means_res = map(data, ~calc_wtn_and_cross_network_means( .x, cortical_rois))) %&gt;% unnest(net_means_res) #&#39; Left section of the raincload plots used in sub-cortical cortical change reporting samediff_cortcort_raincloud &lt;- function(data, this_YeoNet, no_ticks = TRUE) { ## grab the color this_YeoNet_color = YeoNet7 %&gt;% filter(network==this_YeoNet) %&gt;% pull(hexcode) ## make the plot plt &lt;- data %&gt;% mutate(corrtype = factor(vertex_type, levels = c(&#39;pvertex&#39;, &#39;tvertex&#39;, &#39;tvolume&#39;), labels = c(&quot;Surface Personalized&quot;, &quot;Surface Template&quot;, &quot;Volume Template&quot;))) %&gt;% filter(to_network == this_YeoNet) %&gt;% ungroup() %&gt;% ggplot(aes(y = corrtype, x = net_mean, fill = wtn_or_cross, colour = wtn_or_cross)) + geom_density_ridges( #jittered_points = TRUE, position = &quot;raincloud&quot;, alpha = 0.5, scale = 2, quantile_lines = TRUE, quantiles = 2 ) + geom_vline(xintercept = 0) + scale_colour_manual(values = c(&quot;#808080&quot;, this_YeoNet_color)) + scale_fill_manual(values = c(&quot;#808080&quot;, this_YeoNet_color)) + scale_x_continuous(limits = c(-0.5, 1.5)) + labs(y = NULL, x = NULL) + theme(legend.position=&#39;none&#39;) if (no_ticks==TRUE) { plt &lt;- plt + theme(axis.title.x=element_blank(), axis.text.x=element_blank()) } else { plt &lt;- plt + labs(x = &quot;Correlation (Z)&quot;) } return(plt) } #&#39; Combined subcortical-cortical correlation rainclouds for one subcortical structure cortical_raincloud &lt;- function(subject_focus, YeoNet7) { DM &lt;- samediff_cortcort_raincloud(subject_focus, &quot;DM&quot;) FP &lt;- samediff_cortcort_raincloud(subject_focus, &quot;FP&quot;) VA &lt;- samediff_cortcort_raincloud(subject_focus, &quot;VA&quot;) DA &lt;- samediff_cortcort_raincloud(subject_focus, &quot;DA&quot;) SM &lt;- samediff_cortcort_raincloud(subject_focus, &quot;SM&quot;) VI &lt;- samediff_cortcort_raincloud(subject_focus, &quot;VI&quot;, no_ticks = FALSE) title &lt;- ggdraw() + draw_label(&quot;Within Cortical&quot;, fontface=&#39;bold&#39;) plt &lt;- plot_grid(title, DM, FP, VA, DA, SM, VI, ncol = 1, rel_heights = c(0.5, 1, 1, 1, 1, 1, 1.5)) return(plt) } cortical_raincloud(all_subject_wtn_cross_means, YeoNet7) ## Picking joint bandwidth of 0.0214 ## Picking joint bandwidth of 0.017 ## Picking joint bandwidth of 0.0184 ## Warning: Removed 1 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.0198 ## Warning: Removed 1 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.0239 ## Warning: Removed 2 rows containing non-finite values (stat_density_ridges). ## Picking joint bandwidth of 0.0309 ## Warning: Removed 3 rows containing non-finite values (stat_density_ridges). "],
["whole-connectome-results.html", "Chapter 11 Whole Connectome Results 11.1 The paths to data", " Chapter 11 Whole Connectome Results We are now going to see if there is anything in cortical-cortical connectivity by running the matrix of all possible connections instead of just subcortical-cortical stats. library(tidygraph) library(tidyverse) library(broom) library(knitr) library(cowplot) library(igraph) library(ggraph) library(here) 11.1 The paths to data # These functions are for reading timeseries files source(here(&#39;code/R/settings_helpers.R&#39;)) source(here(&#39;code/R/file_reading_helpers.R&#39;)) pheno &lt;- read_pheno_file()%&gt;% drop_na(DX) ## Parsed with column specification: ## cols( ## .default = col_double(), ## dataset = col_character(), ## subject_id = col_character(), ## session_id = col_character(), ## task_id = col_character(), ## run_id = col_character(), ## acq_id = col_character(), ## subject = col_character(), ## session = col_character(), ## cmh_session_id = col_character(), ## DX = col_character(), ## Sex = col_character(), ## Site = col_character(), ## Scanner = col_character(), ## isFEP = col_character(), ## ghost_NoGhost = col_character(), ## filename = col_character() ## ) ## See spec(...) for full column specifications. YeoNet_colours &lt;- define_Yeo7_colours() Yeo7_2011_80verts &lt;- read_Yeo72011_template() "],
["code-for-reading-in-all-the-timeseries-.html", "Chapter 12 Code for reading in all the timeseries.. 12.1 This was run once in order to detemine the too small subcortical ROIs 12.2 filters out some unwanted edges before FDR correction 12.3 Make co 12.4 make table FDR corrected Edges that survive correction", " Chapter 12 Code for reading in all the timeseries.. A table that describes the current expected subortical files These functions are for reading timeseries files This reads all files and generate PINT to subcortical correlation values for a given subject the_subcortical_guide &lt;- get_subcortical_guide() ## Parsed with column specification: ## cols( ## subcort_hemi = col_character(), ## subcort_ROI = col_character(), ## numvx = col_double(), ## network = col_character() ## ) #run_read_subject_subcort_corrs(subcort_outputlist$subid[1]) 12.1 This was run once in order to detemine the too small subcortical ROIs read_vx_count &lt;- function(filepath) { read_csv(filepath, col_names = FALSE) %&gt;% mutate(network = c(&#39;VI&#39;,&#39;SM&#39;,&#39;DA&#39;,&#39;VA&#39;, &#39;LI&#39;,&#39;FP&#39;,&#39;DM&#39;)) } vx_counts &lt;- the_subcortical_guide %&gt;% select(subcort_hemi, subcort_ROI) %&gt;% distinct() %&gt;% mutate(vx_count = str_c(output_base,&#39;/ZHH/out/ciftify_meants/templates/7RSN_roi-&#39;,subcort_hemi, subcort_ROI,&#39;_vxcount.txt&#39;)) %&gt;% mutate(vxnum = map(vx_count, ~read_vx_count(.x))) %&gt;% unnest() %&gt;% select(subcort_hemi, subcort_ROI, X1, network) %&gt;% rename(numvx = X1) write_csv(vx_counts, &#39;../templates/subcort_vxcounts.csv&#39;) node_annotations &lt;- get_node_annotations(Yeo7_2011_80verts, the_subcortical_guide) 12.1.1 This reads all the subcortical files it can find Write a func_base and outputprefix cols into the pheno file for the file reading step pheno &lt;- pheno %&gt;% mutate(func_base = get_func_base_from_pint_summary_filename(filename,subject, session), outputprefix = construct_output_prefix(subject, session, func_base)) map2(pheno$outputprefix[1], pheno$dataset[1], ~run_read_all_subject_timeseries_and_wholebrain_corZ(.x, .y)) all_corZ_results &lt;- pheno %&gt;% select(subject, outputprefix, dataset) %&gt;% mutate(the_corrs = map2(.$outputprefix, .$dataset, ~run_read_all_subject_timeseries_and_wholebrain_corZ(.x, .y))) save(all_corZ_results, file = file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;Rdata_cache&quot;, &quot;06_wholebrain_results_cache.Rdata&quot;)) load(file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;Rdata_cache&quot;, &quot;06_wholebrain_results_cache.Rdata&quot;)) 12.1.2 merge with the phenotypic data results_pheno &lt;- all_corZ_results %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% unnest() results_pheno DX_lm_model_full &lt;- results_pheno %&gt;% semi_join(node_annotations, by = c(&quot;to&quot;=&quot;node_name&quot;)) %&gt;% semi_join(node_annotations, by = c(&quot;from&quot;=&quot;node_name&quot;)) %&gt;% mutate(corZ = weight) %&gt;% group_by(vertex_type, to, from) %&gt;% do(tidy(lm(corZ ~ DX + Age_pt + Sex + fd_mean_pt + Scanner,.))) annotated_graph_edges &lt;- DX_lm_model_full %&gt;% ungroup() %&gt;% select(to, from) %&gt;% distinct() %&gt;% inner_join(node_annotations, by = c(&quot;to&quot;=&quot;node_name&quot;)) %&gt;% inner_join(node_annotations, by = c(&quot;from&quot;=&quot;node_name&quot;), suffix = c(&#39;_to&#39;,&#39;_from&#39;)) %&gt;% unite(from_to_type, etype_from, etype_to) %&gt;% unite(hemis, hemi_from, hemi_to, sep = &quot;&quot;) %&gt;% unite(networks, network_from, network_to, sep = &quot;&quot;, remove = FALSE) %&gt;% mutate(from_to_type = recode(from_to_type, &quot;Cort_SubCort&quot; = &quot;SubCort_Cort&quot;)) %&gt;% mutate(hemis = recode(hemis, &quot;RL&quot; = &quot;LR&quot;)) 12.2 filters out some unwanted edges before FDR correction DX_lm_model &lt;- DX_lm_model_full %&gt;% ungroup() %&gt;% inner_join(annotated_graph_edges, by = c(&quot;to&quot;, &quot;from&quot;)) %&gt;% mutate(withinsubcort = if_else((from_to_type == &quot;SubCort_SubCort&quot;) &amp; (subcort_ROI_from == subcort_ROI_to), &quot;drop&quot;, &quot;keep&quot;)) %&gt;% filter(withinsubcort == &quot;keep&quot;) %&gt;% select(vertex_type, to, from, term, statistic, p.value) %&gt;% ungroup() %&gt;% group_by(term) %&gt;% mutate(p_FDR = p.adjust(p.value, method = &quot;fdr&quot;)) %&gt;% arrange(p.value) 12.3 Make co source(here(&#39;code/R/swirly_plot_helpers.R&#39;)) DX_lm_model %&gt;% ungroup() %&gt;% ## filtering steps filter(term == &quot;DXSSD&quot;) %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% ## make a pretty plot make_swirly_results_plot(pos_label = &quot;SSD &gt; HC&quot;, neg_label = &quot;HC &gt; SSD&quot;, plot_title = &quot;Personalized&quot;, node_annotations = node_annotations) DX_lm_model %&gt;% ungroup() %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% filter(vertex_type == &quot;tvertex&quot;) %&gt;% make_swirly_results_plot(pos_label = &quot;SSD &gt; HC&quot;, neg_label = &quot;HC &gt; SSD&quot;, plot_title = &quot;Template&quot;, node_annotations = node_annotations) DX_lm_model %&gt;% ungroup() %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% filter(vertex_type == &quot;tvolume&quot;) %&gt;% make_swirly_results_plot(pos_label = &quot;SSD &gt; HC&quot;, neg_label = &quot;HC &gt; SSD&quot;, plot_title = &quot;Volume&quot;, node_annotations = node_annotations) 12.4 make table FDR corrected Edges that survive correction DX_lm_model %&gt;% inner_join(annotated_graph_edges, by = c(&quot;to&quot;, &quot;from&quot;)) %&gt;% mutate(sig_edge = if_else(p_FDR &lt; 0.05, &quot;sig&quot;, &quot;ns&quot;), stat_pos = if_else(statistic &gt; 0, &quot;pos&quot;, &quot;neg&quot;)) %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% count(vertex_type, from_to_type, sig_edge) %&gt;% spread(sig_edge, n) %&gt;% mutate(perc_sig = sig/(ns + sig)*100) ## # A tibble: 9 x 6 ## # Groups: term [1] ## term vertex_type from_to_type ns sig perc_sig ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; ## 1 DXSSD pvertex Cort_Cort 2944 216 6.84 ## 2 DXSSD pvertex SubCort_Cort 2663 537 16.8 ## 3 DXSSD pvertex SubCort_SubCort 260 273 51.2 ## 4 DXSSD tvertex Cort_Cort 2936 224 7.09 ## 5 DXSSD tvertex SubCort_Cort 2734 466 14.6 ## 6 DXSSD tvertex SubCort_SubCort 260 273 51.2 ## 7 DXSSD tvolume Cort_Cort 3034 126 3.99 ## 8 DXSSD tvolume SubCort_Cort 2883 317 9.91 ## 9 DXSSD tvolume SubCort_SubCort 260 273 51.2 #&#39; convert from three col graph df to adjacency matrix uppertri_df_to_agjmat &lt;- function(graph_df) { names(graph_df) &lt;- c(&#39;to&#39;, &#39;from&#39;, &#39;myattr&#39;) matrix_out &lt;- graph_df %&gt;% graph_from_data_frame(.,directed = F) %&gt;% get.adjacency(., type = &quot;both&quot;, attr = &quot;myattr&quot;) %&gt;% as.matrix() return(matrix_out) } #&#39; go uppertri data to full dataframe for geom_tile uppertri_df_to_full &lt;- function(graph_df) { result &lt;- graph_df %&gt;% uppertri_df_to_agjmat() %&gt;% as.data.frame() %&gt;% mutate(to = row.names(.)) %&gt;% gather(from, value, -to) return(result) } DX_lm_model %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% mutate(t_filtered = if_else(p_FDR &lt; 0.1, statistic, 0)) %&gt;% ungroup() %&gt;% select(vertex_type, to, from, t_filtered) %&gt;% group_by(vertex_type) %&gt;% nest() %&gt;% mutate(uptri = map(data, uppertri_df_to_full)) %&gt;% unnest(uptri) %&gt;% mutate(to_lab = factor(to, levels = (node_annotations %&gt;% arrange(subcort_ROI, network))$node_name), from_lab = factor(from, levels = (node_annotations %&gt;% arrange(subcort_ROI, network))$node_name)) %&gt;% ggplot(aes(x=to_lab, y=from_lab, fill=value)) + geom_tile(color = &quot;white&quot;) + scale_fill_gradient2(high = &quot;#b2182b&quot;, mid = &quot;white&quot;, low = &quot;#2166ac&quot;) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + facet_wrap(~vertex_type, ncol = 1) + labs(title = &quot;T statistic for effect of DX (thesholded)&quot;, x = NULL, y = NULL, fill = &quot;T statistic for DX&quot;) ` full_DX_mat &lt;- DX_lm_model %&gt;% filter(term == &quot;DXSSD&quot;, vertex_type == &quot;pvertex&quot;) %&gt;% ungroup() %&gt;% select(to, from, statistic) %&gt;% uppertri_df_to_full() full_DX_mat %&gt;% mutate(to_lab = factor(to, levels = node_annotations$node_name), from_lab = factor(from, levels = node_annotations$node_name)) %&gt;% ggplot(aes(x=to_lab, y=from_lab, fill=value)) + geom_tile(color = &quot;white&quot;) + scale_fill_gradient2(high = &quot;#b2182b&quot;, mid = &quot;white&quot;, low = &quot;#2166ac&quot;) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(title = &quot;T statistic for effect of DX&quot;, x = NULL, y = NULL, fill = &quot;T statistic for DX&quot;) calc_fc_weights &lt;- function(lm_df, t_threshold) { full_DX_mat &lt;- lm_df %&gt;% ungroup() %&gt;% select(to, from, statistic) %&gt;% uppertri_df_to_full() %&gt;% inner_join(node_annotations, by = c(&quot;to&quot;=&quot;node_name&quot;)) %&gt;% inner_join(node_annotations, by = c(&quot;from&quot;=&quot;node_name&quot;)) hypo_cerebullum_to_striatum &lt;- full_DX_mat %&gt;% filter(subcort_ROI.x == &quot;cerebellum&quot;) %&gt;% filter(subcort_ROI.y == &quot;striatum&quot;) %&gt;% filter(value &lt; -t_threshold) %&gt;% select(to, from, value) hyper_subcort_to_SM &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;SubCort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.y) %in% c(&quot;SM&quot;)) %&gt;% filter(value &gt; t_threshold) %&gt;% select(to, from, value) hyper_subcort_to_VI &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;SubCort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.y) %in% c(&quot;VI&quot;)) %&gt;% filter(value &gt; t_threshold) %&gt;% select(to, from, value) hyper_subcort_to_DM &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;SubCort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.y) %in% c(&quot;DM&quot;)) %&gt;% filter(value &gt; t_threshold) %&gt;% select(to, from, value) hypo_subcort_to_FP &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;SubCort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.y) %in% c(&quot;FP&quot;)) %&gt;% filter(value &lt; -t_threshold) %&gt;% select(to, from, value) hypo_subcort_to_VA &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;SubCort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.y) %in% c(&quot;VA&quot;)) %&gt;% filter(value &lt; -t_threshold) %&gt;% select(to, from, value) hyper_cortSMVI_to_rest &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;Cort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.x) %in% c(&quot;SM&quot;, &quot;VI&quot;)) %&gt;% filter(as.character(network.y) %in% c(&quot;FP&quot;,&quot;DA&quot;, &quot;VA&quot;, &quot;DM&quot;)) %&gt;% filter(value &gt; t_threshold) %&gt;% select(to, from, value) hyper_cortVA_to_DA &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;Cort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.x) %in% c(&quot;VA&quot;)) %&gt;% filter(as.character(network.y) %in% c(&quot;DA&quot;)) %&gt;% filter(value &gt; t_threshold) %&gt;% select(to, from, value) hypo_cortDM_to_rest &lt;- full_DX_mat %&gt;% filter(etype.x == &quot;Cort&quot;) %&gt;% filter(etype.y == &quot;Cort&quot;) %&gt;% filter(as.character(network.x) %in% c(&quot;DM&quot;)) %&gt;% filter(!(as.character(network.y) %in% c(&quot;DM&quot;))) %&gt;% filter(value &lt; -t_threshold) %&gt;% select(to, from, value) Fz_weigths &lt;-bind_rows(hypo_cortDM_to_rest = hypo_cortDM_to_rest, hyper_cortSMVI_to_rest = hyper_cortSMVI_to_rest, hyper_cortVA_to_DA = hyper_cortVA_to_DA, hyper_subcort_to_DM = hyper_subcort_to_DM, hypo_subcort_to_FP = hypo_subcort_to_FP, hypo_subcort_to_VA = hypo_subcort_to_VA, hyper_subcort_to_SM = hyper_subcort_to_SM, hyper_subcort_to_VI = hyper_subcort_to_VI, hypo_cerebullum_to_striatum = hypo_cerebullum_to_striatum, .id = &quot;direction_edge_group&quot;) %&gt;% separate(direction_edge_group, into = c(&quot;effect_direction&quot;, &quot;edge_group&quot;), extra = &quot;merge&quot;) %&gt;% rename(edge_FC_weight = value) return(Fz_weigths) } t_threshold = 1.1 Fz_DXweigths_pvertex &lt;- DX_lm_model %&gt;% filter(term == &quot;DXSSD&quot;, vertex_type == &quot;pvertex&quot;) %&gt;% ungroup() %&gt;% calc_fc_weights(.,t_threshold) Fz_DXweigths_tvertex &lt;- DX_lm_model %&gt;% filter(term == &quot;DXSSD&quot;, vertex_type == &quot;tvertex&quot;) %&gt;% ungroup() %&gt;% calc_fc_weights(.,t_threshold) Fz_DXweigths_tvolume &lt;- DX_lm_model %&gt;% filter(term == &quot;DXSSD&quot;, vertex_type == &quot;tvolume&quot;) %&gt;% ungroup() %&gt;% calc_fc_weights(.,t_threshold) Fz_DXweigths &lt;- bind_rows(pvertex = Fz_DXweigths_pvertex, tvertex = Fz_DXweigths_tvertex, tvolume = Fz_DXweigths_tvolume, .id = &quot;vertex_type&quot;) Fz_DXweigths %&gt;% group_by(vertex_type, edge_group, effect_direction) %&gt;% summarise(median_weight = median(edge_FC_weight)) %&gt;% ggplot(aes(y = abs(median_weight), x = vertex_type, color = edge_group)) + geom_point() + geom_line(aes(group = edge_group)) Fz_DXweigths %&gt;% count(edge_group, vertex_type, effect_direction) %&gt;% spread(vertex_type, n) ## # A tibble: 9 x 5 ## edge_group effect_direction pvertex tvertex tvolume ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; ## 1 cerebullum_to_striatum hypo 162 162 162 ## 2 cortDM_to_rest hypo 402 369 204 ## 3 cortSMVI_to_rest hyper 419 405 403 ## 4 cortVA_to_DA hyper 147 139 124 ## 5 subcort_to_DM hyper 270 225 119 ## 6 subcort_to_FP hypo 340 311 299 ## 7 subcort_to_SM hyper 287 260 256 ## 8 subcort_to_VA hypo 218 216 239 ## 9 subcort_to_VI hyper 371 344 267 Fz_DXweigths %&gt;% group_by(vertex_type, edge_group, effect_direction) %&gt;% summarise(median_weight = median(edge_FC_weight)) %&gt;% spread(vertex_type, median_weight) ## # A tibble: 9 x 5 ## # Groups: edge_group [9] ## edge_group effect_direction pvertex tvertex tvolume ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 cerebullum_to_striatum hypo -2.85 -2.85 -2.85 ## 2 cortDM_to_rest hypo -2.03 -1.88 -1.55 ## 3 cortSMVI_to_rest hyper 1.71 1.78 1.75 ## 4 cortVA_to_DA hyper 1.96 2.01 1.88 ## 5 subcort_to_DM hyper 2.05 1.82 1.62 ## 6 subcort_to_FP hypo -2.00 -1.91 -1.87 ## 7 subcort_to_SM hyper 2.42 2.40 2.23 ## 8 subcort_to_VA hypo -1.72 -1.89 -1.80 ## 9 subcort_to_VI hyper 3.00 2.79 2.27 write_csv(Fz_DXweigths_pvertex, file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;weighted_subject_FC_weigths&quot;, &quot;SSD4cohorts_DXtweigths_pvertex.csv&quot;)) write_csv(Fz_DXweigths_tvertex, file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;weighted_subject_FC_weigths&quot;, &quot;SSD4cohorts_DXtweigths_tvertex.csv&quot;)) write_csv(Fz_DXweigths_tvolume, file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;weighted_subject_FC_weigths&quot;, &quot;SSD4cohorts_DXtweigths_tvolume.csv&quot;)) #&#39; calculates a subjects weigthed FC score from their edgewise values #&#39; #&#39; @param subject_edges_df tibble with columns subject, to, from, and weight #&#39; @param edge_weights tibble with columns effect_direction, edge_group, to, from, and edge_FC_weight #&#39; #&#39; @return tibble with columns subject, dataset, effect_direction, edge_group, FC_subtype and wFC_score #&#39; #&#39; @examples calc_subjects_wFC_score &lt;- function(subject_edges_df, edge_weights) { result &lt;- subject_edges_df %&gt;% ungroup() %&gt;% group_by(subject, dataset) %&gt;% nest() %&gt;% mutate(uptri = map(data, uppertri_df_to_full)) %&gt;% unnest(uptri) %&gt;% inner_join(edge_weights, by = c(&quot;to&quot;, &quot;from&quot;)) %&gt;% ungroup() %&gt;% mutate(wcorZ = abs(edge_FC_weight) * value) %&gt;% group_by(subject, dataset, effect_direction, edge_group) %&gt;% summarise(wFC_score = sum(wcorZ)/sum(abs(edge_FC_weight)), mFC_score = mean(value)) %&gt;% ungroup() return(result) } pvertex_subject_FC_scores &lt;- results_pheno %&gt;% ungroup() %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% select(subject, dataset, to, from, weight) %&gt;% calc_subjects_wFC_score(Fz_DXweigths_pvertex) tvertex_subject_FC_scores &lt;- results_pheno %&gt;% ungroup() %&gt;% filter(vertex_type == &quot;tvertex&quot;) %&gt;% select(subject, dataset, to, from, weight) %&gt;% calc_subjects_wFC_score(Fz_DXweigths_tvertex) tvolume_subject_FC_scores &lt;- results_pheno %&gt;% ungroup() %&gt;% filter(vertex_type == &quot;tvolume&quot;) %&gt;% select(subject, dataset, to, from, weight) %&gt;% calc_subjects_wFC_score(Fz_DXweigths_tvolume) FC_scores_together &lt;- bind_rows( pvertex = pvertex_subject_FC_scores, tvertex = tvertex_subject_FC_scores, tvolume = tvolume_subject_FC_scores, .id = &quot;vertex_type&quot; ) write_csv(FC_scores_together, file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;weighted_subject_FC_scores&quot;, &quot;SSD4cohorts_DXweighted_subject_scores.csv&quot;)) FC_scores_lmfit &lt;- FC_scores_together %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% group_by(edge_group, effect_direction, vertex_type) %&gt;% do(tidy(lm(wFC_score ~ DX + Age_pt + Sex + fd_mean_pt + Site,.))) FC_scores_lmfit %&gt;% select(edge_group, effect_direction, term, statistic, p.value) %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% knitr::kable() ## Adding missing grouping variables: `vertex_type` vertex_type edge_group effect_direction term statistic p.value pvertex cerebullum_to_striatum hypo DXSSD -5.981823 0e+00 tvertex cerebullum_to_striatum hypo DXSSD -5.981823 0e+00 tvolume cerebullum_to_striatum hypo DXSSD -5.981823 0e+00 pvertex cortDM_to_rest hypo DXSSD -6.713980 0e+00 tvertex cortDM_to_rest hypo DXSSD -8.129964 0e+00 tvolume cortDM_to_rest hypo DXSSD -5.009878 8e-07 pvertex cortSMVI_to_rest hyper DXSSD 8.110019 0e+00 tvertex cortSMVI_to_rest hyper DXSSD 10.064882 0e+00 tvolume cortSMVI_to_rest hyper DXSSD 5.681912 0e+00 pvertex cortVA_to_DA hyper DXSSD 4.615709 5e-06 tvertex cortVA_to_DA hyper DXSSD 6.636692 0e+00 tvolume cortVA_to_DA hyper DXSSD 5.064163 6e-07 pvertex subcort_to_DM hyper DXSSD 5.711771 0e+00 tvertex subcort_to_DM hyper DXSSD 6.359039 0e+00 tvolume subcort_to_DM hyper DXSSD 6.566259 0e+00 pvertex subcort_to_FP hypo DXSSD -6.368152 0e+00 tvertex subcort_to_FP hypo DXSSD -7.222145 0e+00 tvolume subcort_to_FP hypo DXSSD -7.764750 0e+00 pvertex subcort_to_SM hyper DXSSD 6.349540 0e+00 tvertex subcort_to_SM hyper DXSSD 7.285989 0e+00 tvolume subcort_to_SM hyper DXSSD 7.277427 0e+00 pvertex subcort_to_VA hypo DXSSD -5.577413 0e+00 tvertex subcort_to_VA hypo DXSSD -6.477915 0e+00 tvolume subcort_to_VA hypo DXSSD -7.797026 0e+00 pvertex subcort_to_VI hyper DXSSD 7.487524 0e+00 tvertex subcort_to_VI hyper DXSSD 7.809095 0e+00 tvolume subcort_to_VI hyper DXSSD 6.697116 0e+00 FC_scores_lmfit %&gt;% group_by(vertex_type, edge_group, effect_direction) %&gt;% filter(term == &quot;DXSSD&quot;, str_detect(edge_group,&quot;subcort&quot;)) %&gt;% ggplot(aes(y = abs(statistic), x = rev(vertex_type), color = edge_group)) + geom_point() + geom_line(aes(group = edge_group)) FC_scores_lmfit &lt;- FC_scores_together %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% group_by(edge_group, vertex_type, effect_direction, Site) %&gt;% do(tidy(lm(wFC_score ~ DX + Age_pt + Sex + fd_mean_pt,.))) FC_scores_lmfit %&gt;% select(edge_group, vertex_type, Site, term, statistic, p.value) %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% knitr::kable() ## Adding missing grouping variables: `effect_direction` effect_direction edge_group vertex_type Site term statistic p.value hypo cerebullum_to_striatum pvertex CMH DXSSD -3.3534825 0.0011175 hypo cerebullum_to_striatum pvertex COBRE DXSSD -1.8857567 0.0649193 hypo cerebullum_to_striatum pvertex ds000030 DXSSD -3.0826534 0.0024948 hypo cerebullum_to_striatum pvertex ZHH DXSSD -2.9882418 0.0031784 hypo cerebullum_to_striatum tvertex CMH DXSSD -3.3534825 0.0011175 hypo cerebullum_to_striatum tvertex COBRE DXSSD -1.8857567 0.0649193 hypo cerebullum_to_striatum tvertex ds000030 DXSSD -3.0826534 0.0024948 hypo cerebullum_to_striatum tvertex ZHH DXSSD -2.9882418 0.0031784 hypo cerebullum_to_striatum tvolume CMH DXSSD -3.3534825 0.0011175 hypo cerebullum_to_striatum tvolume COBRE DXSSD -1.8857567 0.0649193 hypo cerebullum_to_striatum tvolume ds000030 DXSSD -3.0826534 0.0024948 hypo cerebullum_to_striatum tvolume ZHH DXSSD -2.9882418 0.0031784 hypo cortDM_to_rest pvertex CMH DXSSD -3.1173421 0.0023657 hypo cortDM_to_rest pvertex COBRE DXSSD -1.7195664 0.0914590 hypo cortDM_to_rest pvertex ds000030 DXSSD -3.7485854 0.0002642 hypo cortDM_to_rest pvertex ZHH DXSSD -4.2714684 0.0000307 hypo cortDM_to_rest tvertex CMH DXSSD -4.1848601 0.0000602 hypo cortDM_to_rest tvertex COBRE DXSSD -1.9559975 0.0558472 hypo cortDM_to_rest tvertex ds000030 DXSSD -3.8287460 0.0001975 hypo cortDM_to_rest tvertex ZHH DXSSD -5.2842366 0.0000003 hypo cortDM_to_rest tvolume CMH DXSSD -3.9681343 0.0001342 hypo cortDM_to_rest tvolume COBRE DXSSD -3.9463211 0.0002392 hypo cortDM_to_rest tvolume ds000030 DXSSD -3.1181371 0.0022313 hypo cortDM_to_rest tvolume ZHH DXSSD -1.6065369 0.1098254 hyper cortSMVI_to_rest pvertex CMH DXSSD 4.2021722 0.0000564 hyper cortSMVI_to_rest pvertex COBRE DXSSD 2.3769126 0.0211731 hyper cortSMVI_to_rest pvertex ds000030 DXSSD 3.0984617 0.0023741 hyper cortSMVI_to_rest pvertex ZHH DXSSD 5.6380243 0.0000001 hyper cortSMVI_to_rest tvertex CMH DXSSD 5.7126595 0.0000001 hyper cortSMVI_to_rest tvertex COBRE DXSSD 2.9479669 0.0047813 hyper cortSMVI_to_rest tvertex ds000030 DXSSD 4.2606756 0.0000383 hyper cortSMVI_to_rest tvertex ZHH DXSSD 6.2016302 0.0000000 hyper cortSMVI_to_rest tvolume CMH DXSSD 2.8437881 0.0053776 hyper cortSMVI_to_rest tvolume COBRE DXSSD 1.3465369 0.1839696 hyper cortSMVI_to_rest tvolume ds000030 DXSSD 3.1568781 0.0019732 hyper cortSMVI_to_rest tvolume ZHH DXSSD 4.0110159 0.0000870 hyper cortVA_to_DA pvertex CMH DXSSD 0.4867116 0.6274968 hyper cortVA_to_DA pvertex COBRE DXSSD 0.9264011 0.3585174 hyper cortVA_to_DA pvertex ds000030 DXSSD 2.7689037 0.0064283 hyper cortVA_to_DA pvertex ZHH DXSSD 4.2230614 0.0000374 hyper cortVA_to_DA tvertex CMH DXSSD 1.5957401 0.1136106 hyper cortVA_to_DA tvertex COBRE DXSSD 2.0860644 0.0418955 hyper cortVA_to_DA tvertex ds000030 DXSSD 2.5497868 0.0119129 hyper cortVA_to_DA tvertex ZHH DXSSD 5.9690723 0.0000000 hyper cortVA_to_DA tvolume CMH DXSSD 0.9331152 0.3529428 hyper cortVA_to_DA tvolume COBRE DXSSD 1.1336427 0.2621440 hyper cortVA_to_DA tvolume ds000030 DXSSD 2.3626140 0.0195959 hyper cortVA_to_DA tvolume ZHH DXSSD 4.3826699 0.0000194 hyper subcort_to_DM pvertex CMH DXSSD 1.4445725 0.1516132 hyper subcort_to_DM pvertex COBRE DXSSD 2.3510397 0.0225471 hyper subcort_to_DM pvertex ds000030 DXSSD 3.4960804 0.0006422 hyper subcort_to_DM pvertex ZHH DXSSD 3.5391379 0.0005053 hyper subcort_to_DM tvertex CMH DXSSD 2.1918853 0.0306399 hyper subcort_to_DM tvertex COBRE DXSSD 2.0905878 0.0414705 hyper subcort_to_DM tvertex ds000030 DXSSD 3.2093325 0.0016677 hyper subcort_to_DM tvertex ZHH DXSSD 3.9494379 0.0001105 hyper subcort_to_DM tvolume CMH DXSSD 2.8144136 0.0058550 hyper subcort_to_DM tvolume COBRE DXSSD 1.4072821 0.1652933 hyper subcort_to_DM tvolume ds000030 DXSSD 3.9477105 0.0001272 hyper subcort_to_DM tvolume ZHH DXSSD 3.8866662 0.0001406 hypo subcort_to_FP pvertex CMH DXSSD -2.8303580 0.0055912 hypo subcort_to_FP pvertex COBRE DXSSD -2.6990373 0.0093582 hypo subcort_to_FP pvertex ds000030 DXSSD -2.4055277 0.0175248 hypo subcort_to_FP pvertex ZHH DXSSD -3.8678523 0.0001510 hypo subcort_to_FP tvertex CMH DXSSD -3.1923633 0.0018717 hypo subcort_to_FP tvertex COBRE DXSSD -2.8376839 0.0064650 hypo subcort_to_FP tvertex ds000030 DXSSD -2.8696921 0.0047812 hypo subcort_to_FP tvertex ZHH DXSSD -4.5553544 0.0000094 hypo subcort_to_FP tvolume CMH DXSSD -3.5647322 0.0005538 hypo subcort_to_FP tvolume COBRE DXSSD -2.5661304 0.0132045 hypo subcort_to_FP tvolume ds000030 DXSSD -2.7864546 0.0061087 hypo subcort_to_FP tvolume ZHH DXSSD -5.8464794 0.0000000 hyper subcort_to_SM pvertex CMH DXSSD 3.2832951 0.0014020 hyper subcort_to_SM pvertex COBRE DXSSD 3.7221124 0.0004864 hyper subcort_to_SM pvertex ds000030 DXSSD 2.5036323 0.0135025 hyper subcort_to_SM pvertex ZHH DXSSD 3.7145795 0.0002679 hyper subcort_to_SM tvertex CMH DXSSD 3.7828435 0.0002605 hyper subcort_to_SM tvertex COBRE DXSSD 4.5806882 0.0000293 hyper subcort_to_SM tvertex ds000030 DXSSD 3.0852984 0.0024742 hyper subcort_to_SM tvertex ZHH DXSSD 4.0849576 0.0000651 hyper subcort_to_SM tvolume CMH DXSSD 3.9120423 0.0001644 hyper subcort_to_SM tvolume COBRE DXSSD 3.2959631 0.0017714 hyper subcort_to_SM tvolume ds000030 DXSSD 3.1862816 0.0017961 hyper subcort_to_SM tvolume ZHH DXSSD 4.5618417 0.0000091 hypo subcort_to_VA pvertex CMH DXSSD -2.7211124 0.0076400 hypo subcort_to_VA pvertex COBRE DXSSD -2.8067964 0.0070267 hypo subcort_to_VA pvertex ds000030 DXSSD -1.6293917 0.1055964 hypo subcort_to_VA pvertex ZHH DXSSD -3.7591648 0.0002271 hypo subcort_to_VA tvertex CMH DXSSD -3.2278705 0.0016731 hypo subcort_to_VA tvertex COBRE DXSSD -2.0675986 0.0436703 hypo subcort_to_VA tvertex ds000030 DXSSD -2.2925071 0.0234464 hypo subcort_to_VA tvertex ZHH DXSSD -4.4932262 0.0000122 hypo subcort_to_VA tvolume CMH DXSSD -4.0176713 0.0001120 hypo subcort_to_VA tvolume COBRE DXSSD -2.1588428 0.0354984 hypo subcort_to_VA tvolume ds000030 DXSSD -3.5319065 0.0005677 hypo subcort_to_VA tvolume ZHH DXSSD -5.1371911 0.0000007 hyper subcort_to_VI pvertex CMH DXSSD 3.1767145 0.0019660 hyper subcort_to_VI pvertex COBRE DXSSD 3.2543432 0.0020010 hyper subcort_to_VI pvertex ds000030 DXSSD 2.8334297 0.0053232 hyper subcort_to_VI pvertex ZHH DXSSD 4.7891657 0.0000034 hyper subcort_to_VI tvertex CMH DXSSD 3.7818884 0.0002614 hyper subcort_to_VI tvertex COBRE DXSSD 3.2256365 0.0021754 hyper subcort_to_VI tvertex ds000030 DXSSD 2.4553657 0.0153650 hyper subcort_to_VI tvertex ZHH DXSSD 5.0612146 0.0000010 hyper subcort_to_VI tvolume CMH DXSSD 3.3615692 0.0010885 hyper subcort_to_VI tvolume COBRE DXSSD 3.2342248 0.0021218 hyper subcort_to_VI tvolume ds000030 DXSSD 1.3793930 0.1700886 hyper subcort_to_VI tvolume ZHH DXSSD 4.4290350 0.0000160 FC_scores_lmfit %&gt;% filter(term == &quot;DXSSD&quot;, str_detect(edge_group,&quot;subcort&quot;)) %&gt;% ggplot(aes(y = abs(statistic), x = rev(vertex_type), color = edge_group)) + geom_point() + geom_line(aes(group = edge_group)) + facet_wrap(~Site, nrow = 1) SSD_cors &lt;- FC_scores_together %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% filter(DX == &quot;SSD&quot;, vertex_type == &quot;pvertex&quot;) %&gt;% select(subject, dataset, edge_group, wFC_score) %&gt;% spread(edge_group, wFC_score) %&gt;% select(-subject, -dataset) %&gt;% cor(.) heatmap(abs(SSD_cors)) HC_cors &lt;- FC_scores_together %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% filter(DX == &quot;CTRL&quot;, vertex_type == &quot;pvertex&quot;) %&gt;% select(subject, dataset, edge_group, wFC_score) %&gt;% spread(edge_group, wFC_score) %&gt;% select(-subject, -dataset) %&gt;% cor(.) heatmap(abs(HC_cors)) # Marginal densities along x axis plot_DX_scatter_elipsed &lt;- function(df, x, y) { #the tidy eval ness xvar &lt;- enquo(x) yvar &lt;- enquo(y) # make the main scatte bit using above main_scatter &lt;- ggplot(data = df, aes(x = !!xvar, y = !!yvar, color = DX)) + geom_point(alpha = 0.7, size = 0.7) + stat_ellipse() + scale_color_manual(values = c(&quot;grey20&quot;,&quot;red&quot;)) xdens &lt;- axis_canvas(main_scatter, axis = &quot;x&quot;)+ geom_density(data = df, aes(x = !!xvar, fill = DX), alpha = 0.5, size = 0.2) + scale_fill_manual(values = c(&quot;grey20&quot;,&quot;red&quot;)) ydens &lt;- axis_canvas(main_scatter, axis = &quot;y&quot;, coord_flip = TRUE)+ geom_density(data = df, aes(x = !!yvar, fill = DX), alpha = 0.5, size = 0.2) + scale_fill_manual(values = c(&quot;grey20&quot;,&quot;red&quot;)) + coord_flip() #putting the peices together p1 &lt;- insert_xaxis_grob(main_scatter, xdens, grid::unit(.2, &quot;null&quot;), position = &quot;top&quot;) p2&lt;- insert_yaxis_grob(p1, ydens, grid::unit(.2, &quot;null&quot;), position = &quot;right&quot;) return(p2) } library(cowplot) fplot &lt;- FC_scores_together %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% unite(directed_edge_group, effect_direction, edge_group) %&gt;% unite(dat_sub, dataset, subject) %&gt;% select(dat_sub, Site, DX, directed_edge_group, wFC_score) %&gt;% spread(directed_edge_group, wFC_score) ggdraw(plot_DX_scatter_elipsed(fplot, x = hyper_subcort_to_VI, y = hypo_cerebullum_to_striatum)) ggdraw(plot_DX_scatter_elipsed(fplot, x = hyper_subcort_to_SM, y = hypo_cerebullum_to_striatum)) fig1 &lt;- fplot %&gt;% ggplot(aes(y = hypo_subcort_to_FP, x = DX, color = DX)) + geom_boxplot(outlier.shape = NA) + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, binwidth = 0.01, alpha = 0.5) + scale_color_manual(values = c(&quot;grey20&quot;,&quot;red&quot;)) + facet_wrap( ~ Site, ncol = 4) + labs(x = NULL) #ggsave(fig1, filename = &#39;VA_results.png&#39;,height = 8, width = 5) fig1 fig1 &lt;- fplot %&gt;% ggplot(aes(y = hyper_subcort_to_SM, x = DX, color = DX)) + geom_boxplot(outlier.shape = NA) + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, binwidth = 0.01, alpha = 0.5) + scale_color_manual(values = c(&quot;grey20&quot;,&quot;red&quot;)) + facet_wrap( ~ Site, ncol = 4) + labs(x = NULL) #ggsave(fig1, filename = &#39;VA_results.png&#39;,height = 8, width = 5) fig1 "],
["calculate-weighted-subject-scores-by-chopping-up-the-matrix.html", "Chapter 13 calculate weighted subject scores by chopping up the matrix", " Chapter 13 calculate weighted subject scores by chopping up the matrix YeoNet7 &lt;- define_YeoNet7_colours() node_annotations1 &lt;- node_annotations %&gt;% mutate(node_grouping = if_else(etype == &quot;Cort&quot;, str_c(&quot;Cort&quot;, cort_NET), as.character(subcort_ROI))) node_groupings &lt;- factor(1:9, levels = c(1:9), labels = c(levels(node_annotations$subcort_ROI), str_c(&quot;Cort&quot;,YeoNet7$network[1:6]))) edge_grouping_guide &lt;- matrix(1, nrow = length(node_groupings), ncol = length(node_groupings), dimnames = list(node_groupings, node_groupings)) %&gt;% graph_from_adjacency_matrix(mode=&quot;upper&quot;, weighted=T, diag=T) %&gt;% as_data_frame() %&gt;% filter(!(from %in% c(&quot;striatum&quot;, &quot;thalamus&quot;, &quot;cerebellum&quot;) &amp; to == from)) %&gt;% select(to, from) t_threshold = 1.1 define_hypohyper_weights &lt;- function(lm_df, t_threshold, node_annotations, edge_guide) { full_DX_mat &lt;- lm_df %&gt;% ungroup() %&gt;% select(to, from, statistic) %&gt;% uppertri_df_to_full() %&gt;% inner_join(node_annotations, by = c(&quot;to&quot;=&quot;node_name&quot;)) %&gt;% inner_join(node_annotations, by = c(&quot;from&quot;=&quot;node_name&quot;)) pos_weights &lt;- full_DX_mat %&gt;% filter(value &gt; t_threshold) %&gt;% semi_join(edge_grouping_guide, by = c(&quot;node_grouping.x&quot; = &quot;to&quot;, &quot;node_grouping.y&quot; = &quot;from&quot;)) %&gt;% unite(edge_group, node_grouping.x, node_grouping.y) %&gt;% select(edge_group, to, from, value) neg_weights &lt;- full_DX_mat %&gt;% filter(value &lt; -t_threshold) %&gt;% semi_join(edge_grouping_guide, by = c(&quot;node_grouping.x&quot; = &quot;to&quot;, &quot;node_grouping.y&quot; = &quot;from&quot;)) %&gt;% unite(edge_group, node_grouping.x, node_grouping.y) %&gt;% select(edge_group, to, from, value) all_weights &lt;- bind_rows(hyper = pos_weights, hypo = neg_weights, .id = &quot;effect_direction&quot;) return(all_weights) } define_vertex_hypohyper_weights &lt;- function(lm_df, v_type, t_threshold) { groupwise_weights &lt;- lm_df %&gt;% filter(term == &quot;DXSSD&quot;, vertex_type == v_type) %&gt;% ungroup() %&gt;% define_hypohyper_weights(., t_threshold, node_annotations = node_annotations1, edge_guide = edge_guide) return(groupwise_weights) } groupwise_weights &lt;- tibble(vertex_type = c(&quot;pvertex&quot;, &quot;tvertex&quot;, &quot;tvolume&quot;)) %&gt;% mutate(result = map(vertex_type, ~ define_vertex_hypohyper_weights(DX_lm_model, .x, t_threshold))) %&gt;% unnest() size_threshold = 30 groupwise_weights_table &lt;- groupwise_weights %&gt;% count(vertex_type, effect_direction, edge_group) %&gt;% spread(effect_direction, n, fill = 0) %&gt;% group_by(edge_group) %&gt;% mutate(hyperhypo_diff = (hyper - hypo)/(hyper + hypo), use_hypo = max(hyperhypo_diff) &lt; 0.1 &amp; min(hypo) &gt; size_threshold, use_hyper = min(hyperhypo_diff) &gt; -0.1 &amp; min(hyper) &gt; size_threshold, num = use_hypo + use_hyper) %&gt;% select(num, use_hypo, use_hyper, everything()) %&gt;% arrange(num, edge_group, vertex_type) # ungroup() %&gt;% # select(vertex_type, edge_group, hyperhypo_diff, max_size) %&gt;% # gather(tmp_col, tmp_vals, hyperhypo_diff, max_size) %&gt;% # unite(vertex_meas, tmp_col, vertex_type) %&gt;% # spread(vertex_meas, tmp_vals) %&gt;% # arrange(-abs(hyperhypo_diff_tvolume)) edge_groups_to_use &lt;- groupwise_weights_table %&gt;% ungroup() %&gt;% select(use_hypo, use_hyper, edge_group) %&gt;% distinct() %&gt;% filter(use_hypo | use_hyper) hyper_edgegroups &lt;- edge_groups_to_use %&gt;% filter(use_hyper) %&gt;% pull(edge_group) hypo_edgegroups &lt;- edge_groups_to_use %&gt;% filter(use_hypo) %&gt;% pull(edge_group) groupwise_weights_hyper &lt;- groupwise_weights %&gt;% filter(edge_group %in% hyper_edgegroups, effect_direction == &quot;hyper&quot;) groupwise_weights_hypo &lt;- groupwise_weights %&gt;% filter(edge_group %in% hypo_edgegroups, effect_direction == &quot;hypo&quot;) groupwise_weights_both &lt;- bind_rows( groupwise_weights_hypo, groupwise_weights_hyper ) %&gt;% rename(edge_FC_weight = value) groupwise_weights_both %&gt;% count(vertex_type, effect_direction, edge_group) %&gt;% ggplot(aes(y = n, x = vertex_type, color = edge_group)) + geom_point() + geom_line(aes(group = edge_group)) + facet_wrap(~effect_direction) file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;weighted_subject_FC_weigths&quot;, &#39;SSD4cohorts_DXweighted_moregroups_subject_weights.csv&#39;) ## [1] &quot;/mnt/tigrlab/projects/edickie/code/SZ_PINT/data/processed/mri//all_qa_passes_group/weighted_subject_FC_weigths/SSD4cohorts_DXweighted_moregroups_subject_weights.csv&quot; groupwise_weights_both %&gt;% mutate(node_class = if_else(str_detect(edge_group,&#39;_Cort&#39;), &quot;Within_Cortical&quot;, &quot;Subcortical_to&quot;)) %&gt;% group_by(vertex_type, effect_direction, edge_group, node_class) %&gt;% summarise(median_t = median(edge_FC_weight)) %&gt;% ggplot(aes(y = abs(median_t), x = vertex_type, color = edge_group)) + geom_point() + geom_line(aes(group = edge_group)) + facet_wrap(~effect_direction*node_class) write_csv(groupwise_weights_both, file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;weighted_subject_FC_weigths&quot;, &#39;SSD4cohorts_DXweighted_moregroups_subject_weights.csv&#39;)) all_subject_FC_weights_by_vertex &lt;- function(results_data, edge_weights, vtype) { result &lt;- results_data %&gt;% ungroup() %&gt;% filter(vertex_type == vtype) %&gt;% select(subject, dataset, to, from, weight) %&gt;% calc_subjects_wFC_score(edge_weights %&gt;% filter(vertex_type == vtype)) return(result) } all_subject_FC_weights &lt;- tibble(vertex_type = c(&quot;pvertex&quot;, &quot;tvertex&quot;, &quot;tvolume&quot;)) %&gt;% mutate(result = map(vertex_type, ~all_subject_FC_weights_by_vertex(results_pheno, groupwise_weights_both, .x))) %&gt;% unnest() write_csv(all_subject_FC_weights, file.path(output_base, &quot;all_qa_passes_group&quot;, &quot;weighted_subject_FC_scores&quot;, &#39;SSD4cohorts_DXweighted_moregroups_subject_scores.csv&#39;)) FC_gscores_lmfit &lt;- all_subject_FC_weights %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% group_by(effect_direction, edge_group, vertex_type) %&gt;% do(tidy(lm(wFC_score ~ DX + Age_pt + Sex + fd_mean_pt + Site,.))) FC_gscores_lmfit %&gt;% select(effect_direction, edge_group, vertex_type, term, statistic, p.value) %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% knitr::kable() effect_direction edge_group vertex_type term statistic p.value hyper CortDA_cerebellum pvertex DXSSD 3.237451 0.0012879 hyper CortDA_cerebellum tvertex DXSSD 4.150463 0.0000391 hyper CortDA_cerebellum tvolume DXSSD 4.879937 0.0000014 hyper CortDA_CortSM pvertex DXSSD 5.017406 0.0000007 hyper CortDA_CortSM tvertex DXSSD 5.800263 0.0000000 hyper CortDA_CortSM tvolume DXSSD 4.430104 0.0000116 hyper CortDA_thalamus pvertex DXSSD 4.542757 0.0000070 hyper CortDA_thalamus tvertex DXSSD 5.881766 0.0000000 hyper CortDA_thalamus tvolume DXSSD 6.389888 0.0000000 hyper CortDM_cerebellum pvertex DXSSD 4.642349 0.0000044 hyper CortDM_cerebellum tvertex DXSSD 5.302022 0.0000002 hyper CortDM_cerebellum tvolume DXSSD 5.423749 0.0000001 hyper CortDM_CortDM pvertex DXSSD 3.750295 0.0001978 hyper CortDM_CortDM tvertex DXSSD 4.945778 0.0000010 hyper CortDM_CortDM tvolume DXSSD 3.402300 0.0007230 hyper CortDM_striatum pvertex DXSSD 4.491751 0.0000088 hyper CortDM_striatum tvertex DXSSD 4.785079 0.0000023 hyper CortDM_striatum tvolume DXSSD 3.504970 0.0004987 hyper CortDM_thalamus pvertex DXSSD 3.988825 0.0000766 hyper CortDM_thalamus tvertex DXSSD 4.454424 0.0000104 hyper CortDM_thalamus tvolume DXSSD 4.215423 0.0000297 hyper CortFP_CortDA pvertex DXSSD 3.926352 0.0000986 hyper CortFP_CortDA tvertex DXSSD 5.826878 0.0000000 hyper CortFP_CortDA tvolume DXSSD 4.514464 0.0000080 hyper CortFP_CortSM pvertex DXSSD 4.670951 0.0000039 hyper CortFP_CortSM tvertex DXSSD 5.814223 0.0000000 hyper CortFP_CortSM tvolume DXSSD 4.476600 0.0000094 hyper CortFP_CortVA pvertex DXSSD 4.342411 0.0000171 hyper CortFP_CortVA tvertex DXSSD 5.919580 0.0000000 hyper CortFP_CortVA tvolume DXSSD 4.544195 0.0000070 hyper CortSM_cerebellum pvertex DXSSD 5.222505 0.0000003 hyper CortSM_cerebellum tvertex DXSSD 6.206560 0.0000000 hyper CortSM_cerebellum tvolume DXSSD 5.283414 0.0000002 hyper CortSM_CortVI pvertex DXSSD 3.316109 0.0009807 hyper CortSM_CortVI tvertex DXSSD 4.409429 0.0000128 hyper CortSM_CortVI tvolume DXSSD 3.778039 0.0001776 hyper CortSM_striatum pvertex DXSSD 3.039343 0.0024979 hyper CortSM_striatum tvertex DXSSD 3.332670 0.0009254 hyper CortSM_striatum tvolume DXSSD 4.223272 0.0000287 hyper CortSM_thalamus pvertex DXSSD 5.780605 0.0000000 hyper CortSM_thalamus tvertex DXSSD 6.355291 0.0000000 hyper CortSM_thalamus tvolume DXSSD 6.332004 0.0000000 hyper CortVA_CortDA pvertex DXSSD 4.615709 0.0000050 hyper CortVA_CortDA tvertex DXSSD 6.636692 0.0000000 hyper CortVA_CortDA tvolume DXSSD 5.064163 0.0000006 hyper CortVA_CortSM pvertex DXSSD 4.341260 0.0000172 hyper CortVA_CortSM tvertex DXSSD 5.873598 0.0000000 hyper CortVA_CortSM tvolume DXSSD 4.571869 0.0000061 hyper CortVA_CortVA pvertex DXSSD 3.574728 0.0003854 hyper CortVA_CortVA tvertex DXSSD 4.631029 0.0000047 hyper CortVA_CortVA tvolume DXSSD 4.976830 0.0000009 hyper CortVA_CortVI pvertex DXSSD 3.312321 0.0009938 hyper CortVA_CortVI tvertex DXSSD 4.771213 0.0000024 hyper CortVA_CortVI tvolume DXSSD 3.905806 0.0001071 hyper CortVI_cerebellum pvertex DXSSD 4.773760 0.0000024 hyper CortVI_cerebellum tvertex DXSSD 5.095417 0.0000005 hyper CortVI_cerebellum tvolume DXSSD 4.229329 0.0000280 hyper CortVI_striatum pvertex DXSSD 4.508477 0.0000082 hyper CortVI_striatum tvertex DXSSD 4.704747 0.0000033 hyper CortVI_striatum tvolume DXSSD 3.967064 0.0000837 hyper CortVI_thalamus pvertex DXSSD 7.513960 0.0000000 hyper CortVI_thalamus tvertex DXSSD 7.897544 0.0000000 hyper CortVI_thalamus tvolume DXSSD 6.078778 0.0000000 hypo cerebellum_striatum pvertex DXSSD -5.981823 0.0000000 hypo cerebellum_striatum tvertex DXSSD -5.981823 0.0000000 hypo cerebellum_striatum tvolume DXSSD -5.981823 0.0000000 hypo cerebellum_thalamus pvertex DXSSD -7.824828 0.0000000 hypo cerebellum_thalamus tvertex DXSSD -7.824828 0.0000000 hypo cerebellum_thalamus tvolume DXSSD -7.824828 0.0000000 hypo CortDM_CortDA pvertex DXSSD -4.648709 0.0000043 hypo CortDM_CortDA tvertex DXSSD -5.247558 0.0000002 hypo CortDM_CortDA tvolume DXSSD -3.254804 0.0012133 hypo CortDM_CortSM pvertex DXSSD -5.392256 0.0000001 hypo CortDM_CortSM tvertex DXSSD -6.231482 0.0000000 hypo CortDM_CortSM tvolume DXSSD -3.624750 0.0003195 hypo CortDM_CortVA pvertex DXSSD -4.368380 0.0000153 hypo CortDM_CortVA tvertex DXSSD -6.127277 0.0000000 hypo CortDM_CortVA tvolume DXSSD -4.228984 0.0000280 hypo CortFP_cerebellum pvertex DXSSD -5.345261 0.0000001 hypo CortFP_cerebellum tvertex DXSSD -6.405003 0.0000000 hypo CortFP_cerebellum tvolume DXSSD -6.184458 0.0000000 hypo CortFP_CortFP pvertex DXSSD -4.037718 0.0000626 hypo CortFP_CortFP tvertex DXSSD -5.144663 0.0000004 hypo CortFP_CortFP tvolume DXSSD -4.181040 0.0000344 hypo CortFP_striatum pvertex DXSSD -3.927768 0.0000981 hypo CortFP_striatum tvertex DXSSD -4.862426 0.0000016 hypo CortFP_striatum tvolume DXSSD -4.882349 0.0000014 hypo CortFP_thalamus pvertex DXSSD -4.750162 0.0000027 hypo CortFP_thalamus tvertex DXSSD -5.530944 0.0000001 hypo CortFP_thalamus tvolume DXSSD -6.159073 0.0000000 hypo CortSM_CortSM pvertex DXSSD -4.606963 0.0000052 hypo CortSM_CortSM tvertex DXSSD -4.957989 0.0000010 hypo CortSM_CortSM tvolume DXSSD -4.339779 0.0000173 hypo CortVA_cerebellum pvertex DXSSD -4.735371 0.0000029 hypo CortVA_cerebellum tvertex DXSSD -5.513551 0.0000001 hypo CortVA_cerebellum tvolume DXSSD -5.950585 0.0000000 hypo CortVA_striatum pvertex DXSSD -3.993228 0.0000752 hypo CortVA_striatum tvertex DXSSD -4.671661 0.0000039 hypo CortVA_striatum tvolume DXSSD -5.332617 0.0000001 hypo CortVI_CortVI pvertex DXSSD -5.322826 0.0000002 hypo CortVI_CortVI tvertex DXSSD -5.840072 0.0000000 hypo CortVI_CortVI tvolume DXSSD -3.991611 0.0000757 hypo thalamus_striatum pvertex DXSSD -5.655035 0.0000000 hypo thalamus_striatum tvertex DXSSD -5.655035 0.0000000 hypo thalamus_striatum tvolume DXSSD -5.655035 0.0000000 FC_gscores_lmfit %&gt;% mutate(node_class = if_else(str_detect(edge_group,&#39;_Cort&#39;), &quot;Within_Cortical&quot;, &quot;Subcortical_to&quot;)) %&gt;% group_by(vertex_type, effect_direction, edge_group, node_class) %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% ggplot(aes(y = abs(statistic), x = rev(vertex_type), color = edge_group)) + geom_point() + geom_line(aes(group = edge_group)) + facet_wrap(~effect_direction*node_class) FC_gscores_lmfitbySite &lt;- all_subject_FC_weights %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% group_by(effect_direction, edge_group, vertex_type, Site) %&gt;% do(tidy(lm(wFC_score ~ DX + Age_pt + Sex + fd_mean_pt,.))) FC_gscores_lmfitbySite %&gt;% select(effect_direction, edge_group, Site, vertex_type, term, statistic, p.value) %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% knitr::kable() effect_direction edge_group Site vertex_type term statistic p.value hyper CortDA_cerebellum CMH pvertex DXSSD 1.7374955 0.0852888 hyper CortDA_cerebellum COBRE pvertex DXSSD 2.0368488 0.0467709 hyper CortDA_cerebellum ds000030 pvertex DXSSD 1.0867583 0.2791093 hyper CortDA_cerebellum ZHH pvertex DXSSD 2.4154261 0.0166689 hyper CortDA_cerebellum CMH tvertex DXSSD 2.2540640 0.0263098 hyper CortDA_cerebellum COBRE tvertex DXSSD 2.4082091 0.0196118 hyper CortDA_cerebellum ds000030 tvertex DXSSD 2.1546596 0.0329901 hyper CortDA_cerebellum ZHH tvertex DXSSD 2.5439867 0.0117596 hyper CortDA_cerebellum CMH tvolume DXSSD 3.3266046 0.0012194 hyper CortDA_cerebellum COBRE tvolume DXSSD 2.9415289 0.0048671 hyper CortDA_cerebellum ds000030 tvolume DXSSD 2.3512449 0.0201796 hyper CortDA_cerebellum ZHH tvolume DXSSD 2.1505617 0.0327809 hyper CortDA_CortSM CMH pvertex DXSSD 3.1666252 0.0020292 hyper CortDA_CortSM COBRE pvertex DXSSD 0.8392285 0.4051828 hyper CortDA_CortSM ds000030 pvertex DXSSD -0.4757464 0.6350355 hyper CortDA_CortSM ZHH pvertex DXSSD 4.8711478 0.0000023 hyper CortDA_CortSM CMH tvertex DXSSD 3.8014589 0.0002439 hyper CortDA_CortSM COBRE tvertex DXSSD 0.1848932 0.8540321 hyper CortDA_CortSM ds000030 tvertex DXSSD -0.4474403 0.6552851 hyper CortDA_CortSM ZHH tvertex DXSSD 5.7625283 0.0000000 hyper CortDA_CortSM CMH tvolume DXSSD 1.5773010 0.1177928 hyper CortDA_CortSM COBRE tvolume DXSSD 0.1115481 0.9116112 hyper CortDA_CortSM ds000030 tvolume DXSSD 1.1764293 0.2415247 hyper CortDA_CortSM ZHH tvolume DXSSD 4.1865347 0.0000434 hyper CortDA_thalamus CMH pvertex DXSSD 2.7625395 0.0067938 hyper CortDA_thalamus COBRE pvertex DXSSD 1.5366846 0.1304336 hyper CortDA_thalamus ds000030 pvertex DXSSD 1.6499348 0.1013160 hyper CortDA_thalamus ZHH pvertex DXSSD 2.8448237 0.0049334 hyper CortDA_thalamus CMH tvertex DXSSD 3.0948300 0.0025360 hyper CortDA_thalamus COBRE tvertex DXSSD 2.9207419 0.0051541 hyper CortDA_thalamus ds000030 tvertex DXSSD 2.0023558 0.0472800 hyper CortDA_thalamus ZHH tvertex DXSSD 3.7253037 0.0002575 hyper CortDA_thalamus CMH tvolume DXSSD 4.2073878 0.0000553 hyper CortDA_thalamus COBRE tvolume DXSSD 2.4303981 0.0185684 hyper CortDA_thalamus ds000030 tvolume DXSSD 2.9111664 0.0042235 hyper CortDA_thalamus ZHH tvolume DXSSD 2.9711563 0.0033522 hyper CortDM_cerebellum CMH pvertex DXSSD 1.2073842 0.2300495 hyper CortDM_cerebellum COBRE pvertex DXSSD 1.9354767 0.0583780 hyper CortDM_cerebellum ds000030 pvertex DXSSD 2.6694634 0.0085440 hyper CortDM_cerebellum ZHH pvertex DXSSD 2.6196498 0.0095169 hyper CortDM_cerebellum CMH tvertex DXSSD 2.4207076 0.0172404 hyper CortDM_cerebellum COBRE tvertex DXSSD 1.6594706 0.1030410 hyper CortDM_cerebellum ds000030 tvertex DXSSD 2.6741752 0.0084310 hyper CortDM_cerebellum ZHH tvertex DXSSD 3.0567941 0.0025612 hyper CortDM_cerebellum CMH tvolume DXSSD 2.6408227 0.0095579 hyper CortDM_cerebellum COBRE tvolume DXSSD 0.9471332 0.3479517 hyper CortDM_cerebellum ds000030 tvolume DXSSD 3.4609494 0.0007241 hyper CortDM_cerebellum ZHH tvolume DXSSD 3.0573898 0.0025564 hyper CortDM_CortDM CMH pvertex DXSSD 3.6218486 0.0004559 hyper CortDM_CortDM COBRE pvertex DXSSD 0.5076200 0.6138663 hyper CortDM_CortDM ds000030 pvertex DXSSD 1.2080836 0.2291588 hyper CortDM_CortDM ZHH pvertex DXSSD 2.4368557 0.0157419 hyper CortDM_CortDM CMH tvertex DXSSD 3.3903875 0.0009906 hyper CortDM_CortDM COBRE tvertex DXSSD 0.4172288 0.6782286 hyper CortDM_CortDM ds000030 tvertex DXSSD 1.7701311 0.0789966 hyper CortDM_CortDM ZHH tvertex DXSSD 3.8835592 0.0001422 hyper CortDM_CortDM CMH tvolume DXSSD 3.1889257 0.0018921 hyper CortDM_CortDM COBRE tvolume DXSSD 0.1336728 0.8941773 hyper CortDM_CortDM ds000030 tvolume DXSSD 1.2156566 0.2262692 hyper CortDM_CortDM ZHH tvolume DXSSD 2.5854593 0.0104778 hyper CortDM_striatum CMH pvertex DXSSD 1.2588212 0.2109405 hyper CortDM_striatum COBRE pvertex DXSSD 1.3408207 0.1858068 hyper CortDM_striatum ds000030 pvertex DXSSD 3.4442708 0.0007663 hyper CortDM_striatum ZHH pvertex DXSSD 2.7812883 0.0059629 hyper CortDM_striatum CMH tvertex DXSSD 1.4534348 0.1491432 hyper CortDM_striatum COBRE tvertex DXSSD 1.5266770 0.1329014 hyper CortDM_striatum ds000030 tvertex DXSSD 3.1938050 0.0017532 hyper CortDM_striatum ZHH tvertex DXSSD 2.6951939 0.0076690 hyper CortDM_striatum CMH tvolume DXSSD 1.9924327 0.0489696 hyper CortDM_striatum COBRE tvolume DXSSD 0.1977576 0.8440058 hyper CortDM_striatum ds000030 tvolume DXSSD 2.0784043 0.0395943 hyper CortDM_striatum ZHH tvolume DXSSD 2.1482781 0.0329643 hyper CortDM_thalamus CMH pvertex DXSSD 0.6980543 0.4867162 hyper CortDM_thalamus COBRE pvertex DXSSD 2.1287211 0.0380341 hyper CortDM_thalamus ds000030 pvertex DXSSD 1.5188205 0.1311813 hyper CortDM_thalamus ZHH pvertex DXSSD 2.8328728 0.0051137 hyper CortDM_thalamus CMH tvertex DXSSD 1.3427008 0.1823205 hyper CortDM_thalamus COBRE tvertex DXSSD 1.4029312 0.1665802 hyper CortDM_thalamus ds000030 tvertex DXSSD 1.1398627 0.2563921 hyper CortDM_thalamus ZHH tvertex DXSSD 3.5166679 0.0005472 hyper CortDM_thalamus CMH tvolume DXSSD 1.0764402 0.2842453 hyper CortDM_thalamus COBRE tvolume DXSSD 1.6172346 0.1118787 hyper CortDM_thalamus ds000030 tvolume DXSSD 2.2088500 0.0288971 hyper CortDM_thalamus ZHH tvolume DXSSD 2.7313841 0.0069043 hyper CortFP_CortDA CMH pvertex DXSSD 0.4739461 0.6365415 hyper CortFP_CortDA COBRE pvertex DXSSD 1.2766115 0.2074113 hyper CortFP_CortDA ds000030 pvertex DXSSD 2.1372678 0.0344059 hyper CortFP_CortDA ZHH pvertex DXSSD 2.7887667 0.0058323 hyper CortFP_CortDA CMH tvertex DXSSD 3.2183070 0.0017246 hyper CortFP_CortDA COBRE tvertex DXSSD 2.2702908 0.0273617 hyper CortFP_CortDA ds000030 tvertex DXSSD 3.3143712 0.0011837 hyper CortFP_CortDA ZHH tvertex DXSSD 2.9780209 0.0032814 hyper CortFP_CortDA CMH tvolume DXSSD 3.4504564 0.0008126 hyper CortFP_CortDA COBRE tvolume DXSSD 0.1150147 0.9088765 hyper CortFP_CortDA ds000030 tvolume DXSSD 2.8103822 0.0056963 hyper CortFP_CortDA ZHH tvolume DXSSD 3.0149363 0.0029234 hyper CortFP_CortSM CMH pvertex DXSSD 3.6579939 0.0004026 hyper CortFP_CortSM COBRE pvertex DXSSD 1.5205593 0.1344283 hyper CortFP_CortSM ds000030 pvertex DXSSD 2.0378379 0.0435490 hyper CortFP_CortSM ZHH pvertex DXSSD 2.8871218 0.0043409 hyper CortFP_CortSM CMH tvertex DXSSD 3.8936310 0.0001756 hyper CortFP_CortSM COBRE tvertex DXSSD 2.1433045 0.0367873 hyper CortFP_CortSM ds000030 tvertex DXSSD 1.9911145 0.0485174 hyper CortFP_CortSM ZHH tvertex DXSSD 3.5910133 0.0004198 hyper CortFP_CortSM CMH tvolume DXSSD 2.2914994 0.0239700 hyper CortFP_CortSM COBRE tvolume DXSSD 1.2746075 0.2081146 hyper CortFP_CortSM ds000030 tvolume DXSSD 2.6951162 0.0079450 hyper CortFP_CortSM ZHH tvolume DXSSD 2.8607653 0.0047019 hyper CortFP_CortVA CMH pvertex DXSSD 2.1659714 0.0326204 hyper CortFP_CortVA COBRE pvertex DXSSD 2.1032304 0.0403023 hyper CortFP_CortVA ds000030 pvertex DXSSD 0.8537622 0.3947718 hyper CortFP_CortVA ZHH pvertex DXSSD 3.0700193 0.0024557 hyper CortFP_CortVA CMH tvertex DXSSD 2.8808808 0.0048257 hyper CortFP_CortVA COBRE tvertex DXSSD 1.3092248 0.1962141 hyper CortFP_CortVA ds000030 tvertex DXSSD 1.9448699 0.0539008 hyper CortFP_CortVA ZHH tvertex DXSSD 4.6022378 0.0000077 hyper CortFP_CortVA CMH tvolume DXSSD 3.0539564 0.0028747 hyper CortFP_CortVA COBRE tvolume DXSSD 0.3615991 0.7191169 hyper CortFP_CortVA ds000030 tvolume DXSSD 2.5101161 0.0132683 hyper CortFP_CortVA ZHH tvolume DXSSD 3.3625878 0.0009346 hyper CortSM_cerebellum CMH pvertex DXSSD 2.7097284 0.0078887 hyper CortSM_cerebellum COBRE pvertex DXSSD 2.4608729 0.0172167 hyper CortSM_cerebellum ds000030 pvertex DXSSD 1.7704973 0.0789353 hyper CortSM_cerebellum ZHH pvertex DXSSD 3.3630039 0.0009333 hyper CortSM_cerebellum CMH tvertex DXSSD 3.0749305 0.0026960 hyper CortSM_cerebellum COBRE tvertex DXSSD 3.2319968 0.0021356 hyper CortSM_cerebellum ds000030 tvertex DXSSD 2.4685865 0.0148333 hyper CortSM_cerebellum ZHH tvertex DXSSD 3.7132928 0.0002691 hyper CortSM_cerebellum CMH tvolume DXSSD 2.9567847 0.0038549 hyper CortSM_cerebellum COBRE tvolume DXSSD 1.7609999 0.0841179 hyper CortSM_cerebellum ds000030 tvolume DXSSD 1.3854590 0.1682312 hyper CortSM_cerebellum ZHH tvolume DXSSD 3.9578911 0.0001069 hyper CortSM_CortVI CMH pvertex DXSSD 0.2748946 0.7839478 hyper CortSM_CortVI COBRE pvertex DXSSD 1.2831689 0.2051224 hyper CortSM_CortVI ds000030 pvertex DXSSD 2.1673428 0.0319896 hyper CortSM_CortVI ZHH pvertex DXSSD 1.9774422 0.0494454 hyper CortSM_CortVI CMH tvertex DXSSD 0.7953483 0.4282400 hyper CortSM_CortVI COBRE tvertex DXSSD 2.3736459 0.0213424 hyper CortSM_CortVI ds000030 tvertex DXSSD 2.3158044 0.0220989 hyper CortSM_CortVI ZHH tvertex DXSSD 2.4796313 0.0140271 hyper CortSM_CortVI CMH tvolume DXSSD -0.4698862 0.6394296 hyper CortSM_CortVI COBRE tvolume DXSSD 1.7822755 0.0805432 hyper CortSM_CortVI ds000030 tvolume DXSSD 1.6065827 0.1105176 hyper CortSM_CortVI ZHH tvolume DXSSD 2.9016271 0.0041531 hyper CortSM_striatum CMH pvertex DXSSD 0.2605506 0.7949593 hyper CortSM_striatum COBRE pvertex DXSSD 2.0792960 0.0425386 hyper CortSM_striatum ds000030 pvertex DXSSD 1.5600102 0.1211338 hyper CortSM_striatum ZHH pvertex DXSSD 1.8768436 0.0620805 hyper CortSM_striatum CMH tvertex DXSSD 0.7297645 0.4671906 hyper CortSM_striatum COBRE tvertex DXSSD 2.4573623 0.0173678 hyper CortSM_striatum ds000030 tvertex DXSSD 1.8377888 0.0683251 hyper CortSM_striatum ZHH tvertex DXSSD 1.3934623 0.1651165 hyper CortSM_striatum CMH tvolume DXSSD 1.7636093 0.0807631 hyper CortSM_striatum COBRE tvolume DXSSD 1.8952572 0.0636233 hyper CortSM_striatum ds000030 tvolume DXSSD 2.1861582 0.0305539 hyper CortSM_striatum ZHH tvolume DXSSD 2.5127614 0.0128153 hyper CortSM_thalamus CMH pvertex DXSSD 3.2240339 0.0016936 hyper CortSM_thalamus COBRE pvertex DXSSD 3.8921296 0.0002844 hyper CortSM_thalamus ds000030 pvertex DXSSD 2.6918354 0.0080195 hyper CortSM_thalamus ZHH pvertex DXSSD 2.7661609 0.0062351 hyper CortSM_thalamus CMH tvertex DXSSD 3.5457285 0.0005906 hyper CortSM_thalamus COBRE tvertex DXSSD 4.6013756 0.0000273 hyper CortSM_thalamus ds000030 tvertex DXSSD 3.0360294 0.0028849 hyper CortSM_thalamus ZHH tvertex DXSSD 3.1868185 0.0016833 hyper CortSM_thalamus CMH tvolume DXSSD 3.5640151 0.0005552 hyper CortSM_thalamus COBRE tvolume DXSSD 3.3040196 0.0017299 hyper CortSM_thalamus ds000030 tvolume DXSSD 3.5341170 0.0005633 hyper CortSM_thalamus ZHH tvolume DXSSD 3.2628326 0.0013090 hyper CortVA_CortDA CMH pvertex DXSSD 0.4867116 0.6274968 hyper CortVA_CortDA COBRE pvertex DXSSD 0.9264011 0.3585174 hyper CortVA_CortDA ds000030 pvertex DXSSD 2.7689037 0.0064283 hyper CortVA_CortDA ZHH pvertex DXSSD 4.2230614 0.0000374 hyper CortVA_CortDA CMH tvertex DXSSD 1.5957401 0.1136106 hyper CortVA_CortDA COBRE tvertex DXSSD 2.0860644 0.0418955 hyper CortVA_CortDA ds000030 tvertex DXSSD 2.5497868 0.0119129 hyper CortVA_CortDA ZHH tvertex DXSSD 5.9690723 0.0000000 hyper CortVA_CortDA CMH tvolume DXSSD 0.9331152 0.3529428 hyper CortVA_CortDA COBRE tvolume DXSSD 1.1336427 0.2621440 hyper CortVA_CortDA ds000030 tvolume DXSSD 2.3626140 0.0195959 hyper CortVA_CortDA ZHH tvolume DXSSD 4.3826699 0.0000194 hyper CortVA_CortSM CMH pvertex DXSSD 1.7004253 0.0920686 hyper CortVA_CortSM COBRE pvertex DXSSD 1.7117271 0.0929059 hyper CortVA_CortSM ds000030 pvertex DXSSD 1.5442871 0.1248949 hyper CortVA_CortSM ZHH pvertex DXSSD 2.7057896 0.0074375 hyper CortVA_CortSM CMH tvertex DXSSD 2.3799190 0.0191564 hyper CortVA_CortSM COBRE tvertex DXSSD 2.6437329 0.0108131 hyper CortVA_CortSM ds000030 tvertex DXSSD 2.5649526 0.0114285 hyper CortVA_CortSM ZHH tvertex DXSSD 3.2635612 0.0013058 hyper CortVA_CortSM CMH tvolume DXSSD 2.3936387 0.0184918 hyper CortVA_CortSM COBRE tvolume DXSSD 1.2925540 0.2018795 hyper CortVA_CortSM ds000030 tvolume DXSSD 2.4583595 0.0152431 hyper CortVA_CortSM ZHH tvolume DXSSD 2.9379051 0.0037157 hyper CortVA_CortVA CMH pvertex DXSSD 2.2446942 0.0269258 hyper CortVA_CortVA COBRE pvertex DXSSD 0.4157504 0.6793034 hyper CortVA_CortVA ds000030 pvertex DXSSD 1.2632100 0.2087237 hyper CortVA_CortVA ZHH pvertex DXSSD 2.1254765 0.0348455 hyper CortVA_CortVA CMH tvertex DXSSD 2.5747693 0.0114515 hyper CortVA_CortVA COBRE tvertex DXSSD 1.1572436 0.2524612 hyper CortVA_CortVA ds000030 tvertex DXSSD 1.9914933 0.0484752 hyper CortVA_CortVA ZHH tvertex DXSSD 2.3198560 0.0214169 hyper CortVA_CortVA CMH tvolume DXSSD 3.4113668 0.0009246 hyper CortVA_CortVA COBRE tvolume DXSSD 1.0612296 0.2934897 hyper CortVA_CortVA ds000030 tvolume DXSSD 2.1138136 0.0363983 hyper CortVA_CortVA ZHH tvolume DXSSD 2.9146407 0.0039911 hyper CortVA_CortVI CMH pvertex DXSSD 0.6827189 0.4963172 hyper CortVA_CortVI COBRE pvertex DXSSD 1.0229561 0.3110642 hyper CortVA_CortVI ds000030 pvertex DXSSD 3.0727475 0.0025734 hyper CortVA_CortVI ZHH pvertex DXSSD 1.4801113 0.1405085 hyper CortVA_CortVI CMH tvertex DXSSD 2.3272312 0.0219094 hyper CortVA_CortVI COBRE tvertex DXSSD 1.5395771 0.1297271 hyper CortVA_CortVI ds000030 tvertex DXSSD 3.1374473 0.0020990 hyper CortVA_CortVI ZHH tvertex DXSSD 2.0133353 0.0454980 hyper CortVA_CortVI CMH tvolume DXSSD 0.9426892 0.3480458 hyper CortVA_CortVI COBRE tvolume DXSSD 1.2794436 0.2064204 hyper CortVA_CortVI ds000030 tvolume DXSSD 2.7831883 0.0061670 hyper CortVA_CortVI ZHH tvolume DXSSD 2.5564101 0.0113616 hyper CortVI_cerebellum CMH pvertex DXSSD 2.3291219 0.0218049 hyper CortVI_cerebellum COBRE pvertex DXSSD 1.7264770 0.0901990 hyper CortVI_cerebellum ds000030 pvertex DXSSD 2.0342402 0.0439154 hyper CortVI_cerebellum ZHH pvertex DXSSD 2.8879322 0.0043302 hyper CortVI_cerebellum CMH tvertex DXSSD 2.7441493 0.0071583 hyper CortVI_cerebellum COBRE tvertex DXSSD 2.5276532 0.0145605 hyper CortVI_cerebellum ds000030 tvertex DXSSD 1.6914522 0.0930923 hyper CortVI_cerebellum ZHH tvertex DXSSD 2.9203600 0.0039217 hyper CortVI_cerebellum CMH tvolume DXSSD 2.3218663 0.0222085 hyper CortVI_cerebellum COBRE tvolume DXSSD 2.6037537 0.0119907 hyper CortVI_cerebellum ds000030 tvolume DXSSD 0.8117156 0.4184052 hyper CortVI_cerebellum ZHH tvolume DXSSD 2.3819988 0.0182115 hyper CortVI_striatum CMH pvertex DXSSD 2.3460921 0.0208862 hyper CortVI_striatum COBRE pvertex DXSSD 2.2465321 0.0289424 hyper CortVI_striatum ds000030 pvertex DXSSD 0.8743826 0.3834861 hyper CortVI_striatum ZHH pvertex DXSSD 3.2016581 0.0016032 hyper CortVI_striatum CMH tvertex DXSSD 2.7377926 0.0072884 hyper CortVI_striatum COBRE tvertex DXSSD 1.8191165 0.0746536 hyper CortVI_striatum ds000030 tvertex DXSSD 0.5196227 0.6041903 hyper CortVI_striatum ZHH tvertex DXSSD 3.7396555 0.0002442 hyper CortVI_striatum CMH tvolume DXSSD 2.5462371 0.0123692 hyper CortVI_striatum COBRE tvolume DXSSD 2.0086668 0.0497782 hyper CortVI_striatum ds000030 tvolume DXSSD -0.1318823 0.8952767 hyper CortVI_striatum ZHH tvolume DXSSD 3.2819638 0.0012278 hyper CortVI_thalamus CMH pvertex DXSSD 2.8024509 0.0060603 hyper CortVI_thalamus COBRE pvertex DXSSD 3.5012716 0.0009597 hyper CortVI_thalamus ds000030 pvertex DXSSD 3.2299200 0.0015603 hyper CortVI_thalamus ZHH pvertex DXSSD 4.6652957 0.0000058 hyper CortVI_thalamus CMH tvertex DXSSD 3.5579995 0.0005666 hyper CortVI_thalamus COBRE tvertex DXSSD 3.2452837 0.0020546 hyper CortVI_thalamus ds000030 tvertex DXSSD 3.0461158 0.0027961 hyper CortVI_thalamus ZHH tvertex DXSSD 4.8417975 0.0000027 hyper CortVI_thalamus CMH tvolume DXSSD 2.8411209 0.0054194 hyper CortVI_thalamus COBRE tvolume DXSSD 2.6973117 0.0094007 hyper CortVI_thalamus ds000030 tvolume DXSSD 1.8616563 0.0648588 hyper CortVI_thalamus ZHH tvolume DXSSD 3.8032763 0.0001926 hypo cerebellum_striatum CMH pvertex DXSSD -3.3534825 0.0011175 hypo cerebellum_striatum COBRE pvertex DXSSD -1.8857567 0.0649193 hypo cerebellum_striatum ds000030 pvertex DXSSD -3.0826534 0.0024948 hypo cerebellum_striatum ZHH pvertex DXSSD -2.9882418 0.0031784 hypo cerebellum_striatum CMH tvertex DXSSD -3.3534825 0.0011175 hypo cerebellum_striatum COBRE tvertex DXSSD -1.8857567 0.0649193 hypo cerebellum_striatum ds000030 tvertex DXSSD -3.0826534 0.0024948 hypo cerebellum_striatum ZHH tvertex DXSSD -2.9882418 0.0031784 hypo cerebellum_striatum CMH tvolume DXSSD -3.3534825 0.0011175 hypo cerebellum_striatum COBRE tvolume DXSSD -1.8857567 0.0649193 hypo cerebellum_striatum ds000030 tvolume DXSSD -3.0826534 0.0024948 hypo cerebellum_striatum ZHH tvolume DXSSD -2.9882418 0.0031784 hypo cerebellum_thalamus CMH pvertex DXSSD -4.6024851 0.0000119 hypo cerebellum_thalamus COBRE pvertex DXSSD -2.8289252 0.0066199 hypo cerebellum_thalamus ds000030 pvertex DXSSD -4.9577759 0.0000021 hypo cerebellum_thalamus ZHH pvertex DXSSD -3.7733609 0.0002154 hypo cerebellum_thalamus CMH tvertex DXSSD -4.6024851 0.0000119 hypo cerebellum_thalamus COBRE tvertex DXSSD -2.8289252 0.0066199 hypo cerebellum_thalamus ds000030 tvertex DXSSD -4.9577759 0.0000021 hypo cerebellum_thalamus ZHH tvertex DXSSD -3.7733609 0.0002154 hypo cerebellum_thalamus CMH tvolume DXSSD -4.6024851 0.0000119 hypo cerebellum_thalamus COBRE tvolume DXSSD -2.8289252 0.0066199 hypo cerebellum_thalamus ds000030 tvolume DXSSD -4.9577759 0.0000021 hypo cerebellum_thalamus ZHH tvolume DXSSD -3.7733609 0.0002154 hypo CortDM_CortDA CMH pvertex DXSSD -2.2560244 0.0261824 hypo CortDM_CortDA COBRE pvertex DXSSD -0.7232765 0.4727510 hypo CortDM_CortDA ds000030 pvertex DXSSD -2.7361472 0.0070657 hypo CortDM_CortDA ZHH pvertex DXSSD -3.2630661 0.0013080 hypo CortDM_CortDA CMH tvertex DXSSD -3.2087983 0.0017772 hypo CortDM_CortDA COBRE tvertex DXSSD -0.8824291 0.3816060 hypo CortDM_CortDA ds000030 tvertex DXSSD -2.5106685 0.0132485 hypo CortDM_CortDA ZHH tvertex DXSSD -3.5920062 0.0004184 hypo CortDM_CortDA CMH tvolume DXSSD -2.7317537 0.0074139 hypo CortDM_CortDA COBRE tvolume DXSSD -2.9493650 0.0047628 hypo CortDM_CortDA ds000030 tvolume DXSSD -2.3452434 0.0204939 hypo CortDM_CortDA ZHH tvolume DXSSD -0.7233457 0.4703618 hypo CortDM_CortSM CMH pvertex DXSSD -1.6708763 0.0977820 hypo CortDM_CortSM COBRE pvertex DXSSD -1.8643502 0.0679217 hypo CortDM_CortSM ds000030 pvertex DXSSD -2.4701625 0.0147710 hypo CortDM_CortSM ZHH pvertex DXSSD -3.5514958 0.0004836 hypo CortDM_CortSM CMH tvertex DXSSD -2.0927402 0.0388295 hypo CortDM_CortSM COBRE tvertex DXSSD -2.3346725 0.0234569 hypo CortDM_CortSM ds000030 tvertex DXSSD -2.6706946 0.0085143 hypo CortDM_CortSM ZHH tvertex DXSSD -4.1580278 0.0000486 hypo CortDM_CortSM CMH tvolume DXSSD -1.9151804 0.0582433 hypo CortDM_CortSM COBRE tvolume DXSSD -2.4764216 0.0165619 hypo CortDM_CortSM ds000030 tvolume DXSSD -2.6177976 0.0098757 hypo CortDM_CortSM ZHH tvolume DXSSD -1.0103370 0.3136256 hypo CortDM_CortVA CMH pvertex DXSSD -1.6035013 0.1118862 hypo CortDM_CortVA COBRE pvertex DXSSD -1.5698577 0.1225139 hypo CortDM_CortVA ds000030 pvertex DXSSD -2.4962652 0.0137730 hypo CortDM_CortVA ZHH pvertex DXSSD -2.8406146 0.0049963 hypo CortDM_CortVA CMH tvertex DXSSD -3.2815291 0.0014100 hypo CortDM_CortVA COBRE tvertex DXSSD -1.7197909 0.0914178 hypo CortDM_CortVA ds000030 tvertex DXSSD -2.7096517 0.0076228 hypo CortDM_CortVA ZHH tvertex DXSSD -3.8675047 0.0001512 hypo CortDM_CortVA CMH tvolume DXSSD -2.6409976 0.0095533 hypo CortDM_CortVA COBRE tvolume DXSSD -2.7658202 0.0078416 hypo CortDM_CortVA ds000030 tvolume DXSSD -2.4337400 0.0162712 hypo CortDM_CortVA ZHH tvolume DXSSD -1.7772463 0.0771360 hypo CortFP_cerebellum CMH pvertex DXSSD -2.0611873 0.0418041 hypo CortFP_cerebellum COBRE pvertex DXSSD -2.6783097 0.0098810 hypo CortFP_cerebellum ds000030 pvertex DXSSD -2.4186495 0.0169315 hypo CortFP_cerebellum ZHH pvertex DXSSD -3.2013339 0.0016049 hypo CortFP_cerebellum CMH tvertex DXSSD -2.5642201 0.0117834 hypo CortFP_cerebellum COBRE tvertex DXSSD -2.5212974 0.0147963 hypo CortFP_cerebellum ds000030 tvertex DXSSD -3.2085835 0.0016717 hypo CortFP_cerebellum ZHH tvertex DXSSD -3.9994997 0.0000910 hypo CortFP_cerebellum CMH tvolume DXSSD -3.1366145 0.0022283 hypo CortFP_cerebellum COBRE tvolume DXSSD -2.0075902 0.0498963 hypo CortFP_cerebellum ds000030 tvolume DXSSD -1.8831489 0.0618641 hypo CortFP_cerebellum ZHH tvolume DXSSD -4.3608235 0.0000213 hypo CortFP_CortFP CMH pvertex DXSSD -1.6915318 0.0937588 hypo CortFP_CortFP COBRE pvertex DXSSD 0.3130960 0.7554601 hypo CortFP_CortFP ds000030 pvertex DXSSD -0.8235043 0.4116955 hypo CortFP_CortFP ZHH pvertex DXSSD -3.9265666 0.0001207 hypo CortFP_CortFP CMH tvertex DXSSD -2.0442120 0.0434839 hypo CortFP_CortFP COBRE tvertex DXSSD -0.2785650 0.7816835 hypo CortFP_CortFP ds000030 tvertex DXSSD -2.9344840 0.0039368 hypo CortFP_CortFP ZHH tvertex DXSSD -3.4516558 0.0006874 hypo CortFP_CortFP CMH tvolume DXSSD -3.3975298 0.0009676 hypo CortFP_CortFP COBRE tvolume DXSSD -2.5915232 0.0123736 hypo CortFP_CortFP ds000030 tvolume DXSSD -2.2421766 0.0266058 hypo CortFP_CortFP ZHH tvolume DXSSD -1.1529933 0.2503692 hypo CortFP_striatum CMH pvertex DXSSD -2.4958565 0.0141523 hypo CortFP_striatum COBRE pvertex DXSSD -1.8768745 0.0661511 hypo CortFP_striatum ds000030 pvertex DXSSD -1.1323177 0.2595382 hypo CortFP_striatum ZHH pvertex DXSSD -2.4527895 0.0150825 hypo CortFP_striatum CMH tvertex DXSSD -2.8189633 0.0057786 hypo CortFP_striatum COBRE tvertex DXSSD -1.7196722 0.0914396 hypo CortFP_striatum ds000030 tvertex DXSSD -1.5722287 0.1182735 hypo CortFP_striatum ZHH tvertex DXSSD -3.2542404 0.0013470 hypo CortFP_striatum CMH tvolume DXSSD -2.8009796 0.0060860 hypo CortFP_striatum COBRE tvolume DXSSD -1.7085801 0.0934921 hypo CortFP_striatum ds000030 tvolume DXSSD -1.9181856 0.0572307 hypo CortFP_striatum ZHH tvolume DXSSD -3.6339907 0.0003596 hypo CortFP_thalamus CMH pvertex DXSSD -1.9924583 0.0489668 hypo CortFP_thalamus COBRE pvertex DXSSD -0.9842972 0.3295272 hypo CortFP_thalamus ds000030 pvertex DXSSD -2.0337942 0.0439611 hypo CortFP_thalamus ZHH pvertex DXSSD -2.7048828 0.0074571 hypo CortFP_thalamus CMH tvertex DXSSD -2.5178522 0.0133473 hypo CortFP_thalamus COBRE tvertex DXSSD -1.6657624 0.1017747 hypo CortFP_thalamus ds000030 tvertex DXSSD -2.1166318 0.0361538 hypo CortFP_thalamus ZHH tvertex DXSSD -3.2395004 0.0014147 hypo CortFP_thalamus CMH tvolume DXSSD -2.4395410 0.0164148 hypo CortFP_thalamus COBRE tvolume DXSSD -1.9211782 0.0601989 hypo CortFP_thalamus ds000030 tvolume DXSSD -2.5837349 0.0108531 hypo CortFP_thalamus ZHH tvolume DXSSD -4.4500637 0.0000146 hypo CortSM_CortSM CMH pvertex DXSSD -1.0792849 0.2829816 hypo CortSM_CortSM COBRE pvertex DXSSD -2.4624976 0.0171472 hypo CortSM_CortSM ds000030 pvertex DXSSD -1.4053967 0.1622350 hypo CortSM_CortSM ZHH pvertex DXSSD -3.7111175 0.0002713 hypo CortSM_CortSM CMH tvertex DXSSD -1.6756740 0.0968353 hypo CortSM_CortSM COBRE tvertex DXSSD -1.9099844 0.0616579 hypo CortSM_CortSM ds000030 tvertex DXSSD -1.5081278 0.1338936 hypo CortSM_CortSM ZHH tvertex DXSSD -4.1196315 0.0000567 hypo CortSM_CortSM CMH tvolume DXSSD -1.3175041 0.1905929 hypo CortSM_CortSM COBRE tvolume DXSSD -3.0980951 0.0031385 hypo CortSM_CortSM ds000030 tvolume DXSSD -1.0759209 0.2839105 hypo CortSM_CortSM ZHH tvolume DXSSD -3.3632274 0.0009326 hypo CortVA_cerebellum CMH pvertex DXSSD -2.1805853 0.0314902 hypo CortVA_cerebellum COBRE pvertex DXSSD -1.6948023 0.0960944 hypo CortVA_cerebellum ds000030 pvertex DXSSD -0.6561597 0.5128549 hypo CortVA_cerebellum ZHH pvertex DXSSD -3.5240046 0.0005331 hypo CortVA_cerebellum CMH tvertex DXSSD -2.8364141 0.0054939 hypo CortVA_cerebellum COBRE tvertex DXSSD -1.5944892 0.1168872 hypo CortVA_cerebellum ds000030 tvertex DXSSD -1.3520364 0.1786583 hypo CortVA_cerebellum ZHH tvertex DXSSD -3.6982713 0.0002844 hypo CortVA_cerebellum CMH tvolume DXSSD -3.0873916 0.0025947 hypo CortVA_cerebellum COBRE tvolume DXSSD -1.8899284 0.0643475 hypo CortVA_cerebellum ds000030 tvolume DXSSD -1.6743326 0.0964153 hypo CortVA_cerebellum ZHH tvolume DXSSD -3.6838911 0.0002998 hypo CortVA_striatum CMH pvertex DXSSD -1.3904505 0.1673893 hypo CortVA_striatum COBRE pvertex DXSSD -2.0138762 0.0492100 hypo CortVA_striatum ds000030 pvertex DXSSD -1.6663945 0.0979883 hypo CortVA_striatum ZHH pvertex DXSSD -2.9101121 0.0040468 hypo CortVA_striatum CMH tvertex DXSSD -1.6748020 0.0970068 hypo CortVA_striatum COBRE tvertex DXSSD -1.2826641 0.2052980 hypo CortVA_striatum ds000030 tvertex DXSSD -1.9587146 0.0522386 hypo CortVA_striatum ZHH tvertex DXSSD -3.7770492 0.0002125 hypo CortVA_striatum CMH tvolume DXSSD -2.1824223 0.0313506 hypo CortVA_striatum COBRE tvolume DXSSD -1.6669464 0.1015378 hypo CortVA_striatum ds000030 tvolume DXSSD -2.6448294 0.0091572 hypo CortVA_striatum ZHH tvolume DXSSD -4.3120516 0.0000260 hypo CortVI_CortVI CMH pvertex DXSSD -1.7902389 0.0763536 hypo CortVI_CortVI COBRE pvertex DXSSD -2.1977459 0.0324439 hypo CortVI_CortVI ds000030 pvertex DXSSD -0.6445396 0.5203357 hypo CortVI_CortVI ZHH pvertex DXSSD -4.3359015 0.0000236 hypo CortVI_CortVI CMH tvertex DXSSD -2.8328820 0.0055505 hypo CortVI_CortVI COBRE tvertex DXSSD -1.8373925 0.0718690 hypo CortVI_CortVI ds000030 tvertex DXSSD -0.9048920 0.3671588 hypo CortVI_CortVI ZHH tvertex DXSSD -4.4533176 0.0000144 hypo CortVI_CortVI CMH tvolume DXSSD -1.5788484 0.1174371 hypo CortVI_CortVI COBRE tvolume DXSSD -3.0631002 0.0034657 hypo CortVI_CortVI ds000030 tvolume DXSSD -0.9038517 0.3677082 hypo CortVI_CortVI ZHH tvolume DXSSD -2.5580468 0.0113101 hypo thalamus_striatum CMH pvertex DXSSD -1.3411883 0.1828093 hypo thalamus_striatum COBRE pvertex DXSSD -1.8400302 0.0714744 hypo thalamus_striatum ds000030 pvertex DXSSD -3.1958438 0.0017418 hypo thalamus_striatum ZHH pvertex DXSSD -4.3307761 0.0000241 hypo thalamus_striatum CMH tvertex DXSSD -1.3411883 0.1828093 hypo thalamus_striatum COBRE tvertex DXSSD -1.8400302 0.0714744 hypo thalamus_striatum ds000030 tvertex DXSSD -3.1958438 0.0017418 hypo thalamus_striatum ZHH tvertex DXSSD -4.3307761 0.0000241 hypo thalamus_striatum CMH tvolume DXSSD -1.3411883 0.1828093 hypo thalamus_striatum COBRE tvolume DXSSD -1.8400302 0.0714744 hypo thalamus_striatum ds000030 tvolume DXSSD -3.1958438 0.0017418 hypo thalamus_striatum ZHH tvolume DXSSD -4.3307761 0.0000241 FC_gscores_lmfitbySite %&gt;% mutate(node_class = if_else(str_detect(edge_group,&#39;_Cort&#39;), &quot;Within_Cortical&quot;, &quot;Subcortical_to&quot;)) %&gt;% filter(term == &quot;DXSSD&quot;, node_class == &quot;Subcortical_to&quot;) %&gt;% ggplot(aes(y = abs(statistic), x = rev(vertex_type), color = effect_direction)) + geom_point() + geom_line(aes(group = edge_group)) + facet_wrap(~Site) FC_gscores_lmfitbySite_mFC &lt;- all_subject_FC_weights %&gt;% inner_join(pheno, by = c(&quot;subject&quot;, &quot;dataset&quot;)) %&gt;% ungroup() %&gt;% group_by(effect_direction, edge_group, vertex_type, Site) %&gt;% do(tidy(lm(mFC_score ~ DX + Age_pt + Sex + fd_mean_pt,.))) FC_gscores_lmfitbySite_mFC %&gt;% select(effect_direction, edge_group, Site, vertex_type, term, statistic, p.value) %&gt;% filter(term == &quot;DXSSD&quot;) %&gt;% knitr::kable() effect_direction edge_group Site vertex_type term statistic p.value hyper CortDA_cerebellum CMH pvertex DXSSD 1.7041489 0.0913683 hyper CortDA_cerebellum COBRE pvertex DXSSD 2.1395474 0.0371050 hyper CortDA_cerebellum ds000030 pvertex DXSSD 0.9890094 0.3244544 hyper CortDA_cerebellum ZHH pvertex DXSSD 2.2281242 0.0270513 hyper CortDA_cerebellum CMH tvertex DXSSD 2.2320632 0.0277763 hyper CortDA_cerebellum COBRE tvertex DXSSD 2.5145384 0.0150508 hyper CortDA_cerebellum ds000030 tvertex DXSSD 2.0079366 0.0466757 hyper CortDA_cerebellum ZHH tvertex DXSSD 2.3232617 0.0212292 hyper CortDA_cerebellum CMH tvolume DXSSD 3.0511193 0.0028997 hyper CortDA_cerebellum COBRE tvolume DXSSD 2.8725457 0.0058811 hyper CortDA_cerebellum ds000030 tvolume DXSSD 2.3824032 0.0186154 hyper CortDA_cerebellum ZHH tvolume DXSSD 1.8972552 0.0593190 hyper CortDA_CortSM CMH pvertex DXSSD 2.9083298 0.0044513 hyper CortDA_CortSM COBRE pvertex DXSSD 0.5528093 0.5827628 hyper CortDA_CortSM ds000030 pvertex DXSSD -0.5840160 0.5601987 hyper CortDA_CortSM ZHH pvertex DXSSD 4.2892733 0.0000286 hyper CortDA_CortSM CMH tvertex DXSSD 3.3633193 0.0010823 hyper CortDA_CortSM COBRE tvertex DXSSD -0.0353173 0.9719619 hyper CortDA_CortSM ds000030 tvertex DXSSD -0.6547818 0.5137391 hyper CortDA_CortSM ZHH tvertex DXSSD 5.1700251 0.0000006 hyper CortDA_CortSM CMH tvolume DXSSD 1.4324888 0.1550320 hyper CortDA_CortSM COBRE tvolume DXSSD -0.1983390 0.8435532 hyper CortDA_CortSM ds000030 tvolume DXSSD 0.9367734 0.3505730 hyper CortDA_CortSM ZHH tvolume DXSSD 3.8500636 0.0001615 hyper CortDA_thalamus CMH pvertex DXSSD 2.6159763 0.0102342 hyper CortDA_thalamus COBRE pvertex DXSSD 1.5772290 0.1208076 hyper CortDA_thalamus ds000030 pvertex DXSSD 1.4869712 0.1393893 hyper CortDA_thalamus ZHH pvertex DXSSD 2.5956016 0.0101841 hyper CortDA_thalamus CMH tvertex DXSSD 2.9061504 0.0044800 hyper CortDA_thalamus COBRE tvertex DXSSD 2.8304850 0.0065921 hyper CortDA_thalamus ds000030 tvertex DXSSD 1.8233346 0.0704982 hyper CortDA_thalamus ZHH tvertex DXSSD 3.4192867 0.0007691 hyper CortDA_thalamus CMH tvolume DXSSD 3.7832142 0.0002601 hyper CortDA_thalamus COBRE tvolume DXSSD 2.3478947 0.0227194 hyper CortDA_thalamus ds000030 tvolume DXSSD 2.6468036 0.0091066 hyper CortDA_thalamus ZHH tvolume DXSSD 2.6664642 0.0083297 hyper CortDM_cerebellum CMH pvertex DXSSD 0.8170876 0.4157643 hyper CortDM_cerebellum COBRE pvertex DXSSD 1.7048081 0.0941987 hyper CortDM_cerebellum ds000030 pvertex DXSSD 2.3324496 0.0211783 hyper CortDM_cerebellum ZHH pvertex DXSSD 2.3694880 0.0188205 hyper CortDM_cerebellum CMH tvertex DXSSD 2.1814384 0.0314253 hyper CortDM_cerebellum COBRE tvertex DXSSD 1.6177444 0.1117684 hyper CortDM_cerebellum ds000030 tvertex DXSSD 2.5412822 0.0121926 hyper CortDM_cerebellum ZHH tvertex DXSSD 2.7987352 0.0056623 hyper CortDM_cerebellum CMH tvolume DXSSD 2.3391471 0.0212579 hyper CortDM_cerebellum COBRE tvolume DXSSD 0.6609114 0.5115868 hyper CortDM_cerebellum ds000030 tvolume DXSSD 3.3090747 0.0012046 hyper CortDM_cerebellum ZHH tvolume DXSSD 2.9722361 0.0033410 hyper CortDM_CortDM CMH pvertex DXSSD 3.8929815 0.0001760 hyper CortDM_CortDM COBRE pvertex DXSSD 0.5552437 0.5811089 hyper CortDM_CortDM ds000030 pvertex DXSSD 1.1203390 0.2645883 hyper CortDM_CortDM ZHH pvertex DXSSD 2.0961342 0.0374016 hyper CortDM_CortDM CMH tvertex DXSSD 3.3524537 0.0011212 hyper CortDM_CortDM COBRE tvertex DXSSD 0.3368415 0.7375921 hyper CortDM_CortDM ds000030 tvertex DXSSD 1.5735263 0.1179729 hyper CortDM_CortDM ZHH tvertex DXSSD 3.6010417 0.0004050 hyper CortDM_CortDM CMH tvolume DXSSD 3.2322586 0.0016500 hyper CortDM_CortDM COBRE tvolume DXSSD 0.2014585 0.8411261 hyper CortDM_CortDM ds000030 tvolume DXSSD 1.2329240 0.2197789 hyper CortDM_CortDM ZHH tvolume DXSSD 2.3464214 0.0199905 hyper CortDM_striatum CMH pvertex DXSSD 1.0813133 0.2820830 hyper CortDM_striatum COBRE pvertex DXSSD 1.2410348 0.2201626 hyper CortDM_striatum ds000030 pvertex DXSSD 3.1544829 0.0019883 hyper CortDM_striatum ZHH pvertex DXSSD 2.5193329 0.0125863 hyper CortDM_striatum CMH tvertex DXSSD 1.2675873 0.2078036 hyper CortDM_striatum COBRE tvertex DXSSD 1.4313427 0.1583150 hyper CortDM_striatum ds000030 tvertex DXSSD 3.0308128 0.0029319 hyper CortDM_striatum ZHH tvertex DXSSD 2.3925341 0.0177123 hyper CortDM_striatum CMH tvolume DXSSD 1.8250408 0.0708930 hyper CortDM_striatum COBRE tvolume DXSSD 0.2286594 0.8200306 hyper CortDM_striatum ds000030 tvolume DXSSD 2.0820081 0.0392583 hyper CortDM_striatum ZHH tvolume DXSSD 1.9960242 0.0473670 hyper CortDM_thalamus CMH pvertex DXSSD 0.4847816 0.6288607 hyper CortDM_thalamus COBRE pvertex DXSSD 2.1641338 0.0350687 hyper CortDM_thalamus ds000030 pvertex DXSSD 1.2192904 0.2248920 hyper CortDM_thalamus ZHH pvertex DXSSD 2.4376350 0.0157091 hyper CortDM_thalamus CMH tvertex DXSSD 1.2820041 0.2027193 hyper CortDM_thalamus COBRE tvertex DXSSD 1.3627677 0.1788285 hyper CortDM_thalamus ds000030 tvertex DXSSD 1.0094589 0.3145876 hyper CortDM_thalamus ZHH tvertex DXSSD 3.1291867 0.0020308 hyper CortDM_thalamus CMH tvolume DXSSD 0.8775881 0.3822097 hyper CortDM_thalamus COBRE tvolume DXSSD 1.5011162 0.1393737 hyper CortDM_thalamus ds000030 tvolume DXSSD 1.8781654 0.0625479 hyper CortDM_thalamus ZHH tvolume DXSSD 2.5308566 0.0121936 hyper CortFP_CortDA CMH pvertex DXSSD 0.4616531 0.6453037 hyper CortFP_CortDA COBRE pvertex DXSSD 1.0229568 0.3110638 hyper CortFP_CortDA ds000030 pvertex DXSSD 2.0106942 0.0463796 hyper CortFP_CortDA ZHH pvertex DXSSD 2.7985529 0.0056654 hyper CortFP_CortDA CMH tvertex DXSSD 3.1137101 0.0023924 hyper CortFP_CortDA COBRE tvertex DXSSD 2.1501901 0.0362112 hyper CortFP_CortDA ds000030 tvertex DXSSD 3.1495313 0.0020199 hyper CortFP_CortDA ZHH tvertex DXSSD 2.7952415 0.0057214 hyper CortFP_CortDA CMH tvolume DXSSD 3.3445116 0.0011506 hyper CortFP_CortDA COBRE tvolume DXSSD 0.0210175 0.9833121 hyper CortFP_CortDA ds000030 tvolume DXSSD 2.6877596 0.0081128 hyper CortFP_CortDA ZHH tvolume DXSSD 2.7009063 0.0075434 hyper CortFP_CortSM CMH pvertex DXSSD 3.5763655 0.0005324 hyper CortFP_CortSM COBRE pvertex DXSSD 1.2446850 0.2188282 hyper CortFP_CortSM ds000030 pvertex DXSSD 1.9618571 0.0518674 hyper CortFP_CortSM ZHH pvertex DXSSD 2.7230303 0.0070744 hyper CortFP_CortSM CMH tvertex DXSSD 3.7277787 0.0003160 hyper CortFP_CortSM COBRE tvertex DXSSD 1.8950435 0.0636523 hyper CortFP_CortSM ds000030 tvertex DXSSD 2.0572553 0.0416158 hyper CortFP_CortSM ZHH tvertex DXSSD 3.3585673 0.0009475 hyper CortFP_CortSM CMH tvolume DXSSD 2.0388116 0.0440303 hyper CortFP_CortSM COBRE tvolume DXSSD 1.1769423 0.2445779 hyper CortFP_CortSM ds000030 tvolume DXSSD 2.4926174 0.0139088 hyper CortFP_CortSM ZHH tvolume DXSSD 2.7335373 0.0068610 hyper CortFP_CortVA CMH pvertex DXSSD 2.1044432 0.0377735 hyper CortFP_CortVA COBRE pvertex DXSSD 1.9183948 0.0605589 hyper CortFP_CortVA ds000030 pvertex DXSSD 0.7690444 0.4432305 hyper CortFP_CortVA ZHH pvertex DXSSD 2.9605383 0.0034646 hyper CortFP_CortVA CMH tvertex DXSSD 2.7047406 0.0080000 hyper CortFP_CortVA COBRE tvertex DXSSD 1.1854063 0.2412458 hyper CortFP_CortVA ds000030 tvertex DXSSD 1.7129179 0.0890578 hyper CortFP_CortVA ZHH tvertex DXSSD 4.4590389 0.0000141 hyper CortFP_CortVA CMH tvolume DXSSD 3.1257076 0.0023051 hyper CortFP_CortVA COBRE tvolume DXSSD 0.1984910 0.8434350 hyper CortFP_CortVA ds000030 tvolume DXSSD 2.5108790 0.0132410 hyper CortFP_CortVA ZHH tvolume DXSSD 3.0580249 0.0025512 hyper CortSM_cerebellum CMH pvertex DXSSD 2.5168336 0.0133836 hyper CortSM_cerebellum COBRE pvertex DXSSD 2.3488196 0.0226686 hyper CortSM_cerebellum ds000030 pvertex DXSSD 1.6179033 0.1080526 hyper CortSM_cerebellum ZHH pvertex DXSSD 2.9934868 0.0031268 hyper CortSM_cerebellum CMH tvertex DXSSD 3.0012296 0.0033735 hyper CortSM_cerebellum COBRE tvertex DXSSD 2.9672189 0.0045330 hyper CortSM_cerebellum ds000030 tvertex DXSSD 2.1594854 0.0326063 hyper CortSM_cerebellum ZHH tvertex DXSSD 3.1946879 0.0016404 hyper CortSM_cerebellum CMH tvolume DXSSD 3.0292771 0.0030990 hyper CortSM_cerebellum COBRE tvolume DXSSD 1.5340527 0.1310790 hyper CortSM_cerebellum ds000030 tvolume DXSSD 1.0567099 0.2925596 hyper CortSM_cerebellum ZHH tvolume DXSSD 3.5761318 0.0004429 hyper CortSM_CortVI CMH pvertex DXSSD 0.1622000 0.8714662 hyper CortSM_CortVI COBRE pvertex DXSSD 1.1996311 0.2357202 hyper CortSM_CortVI ds000030 pvertex DXSSD 2.1939221 0.0299780 hyper CortSM_CortVI ZHH pvertex DXSSD 1.7874050 0.0754744 hyper CortSM_CortVI CMH tvertex DXSSD 0.5529251 0.5815128 hyper CortSM_CortVI COBRE tvertex DXSSD 2.1926653 0.0328292 hyper CortSM_CortVI ds000030 tvertex DXSSD 2.2097029 0.0288364 hyper CortSM_CortVI ZHH tvertex DXSSD 2.3184187 0.0214965 hyper CortSM_CortVI CMH tvolume DXSSD -0.6370507 0.5255052 hyper CortSM_CortVI COBRE tvolume DXSSD 1.6373859 0.1075882 hyper CortSM_CortVI ds000030 tvolume DXSSD 1.4749940 0.1425775 hyper CortSM_CortVI ZHH tvolume DXSSD 2.8060374 0.0055407 hyper CortSM_striatum CMH pvertex DXSSD 0.2805678 0.7796047 hyper CortSM_striatum COBRE pvertex DXSSD 2.0612353 0.0442969 hyper CortSM_striatum ds000030 pvertex DXSSD 1.5191265 0.1311043 hyper CortSM_striatum ZHH pvertex DXSSD 1.6142919 0.1081324 hyper CortSM_striatum CMH tvertex DXSSD 0.8057249 0.4222577 hyper CortSM_striatum COBRE tvertex DXSSD 2.4593275 0.0172831 hyper CortSM_striatum ds000030 tvertex DXSSD 1.6918035 0.0930251 hyper CortSM_striatum ZHH tvertex DXSSD 1.1073241 0.2695611 hyper CortSM_striatum CMH tvolume DXSSD 1.7364706 0.0854706 hyper CortSM_striatum COBRE tvolume DXSSD 1.7723448 0.0821956 hyper CortSM_striatum ds000030 tvolume DXSSD 1.8941231 0.0603802 hyper CortSM_striatum ZHH tvolume DXSSD 2.1569819 0.0322697 hyper CortSM_thalamus CMH pvertex DXSSD 3.2193583 0.0017188 hyper CortSM_thalamus COBRE pvertex DXSSD 3.6747241 0.0005637 hyper CortSM_thalamus ds000030 pvertex DXSSD 2.5636935 0.0114680 hyper CortSM_thalamus ZHH pvertex DXSSD 2.5502237 0.0115583 hyper CortSM_thalamus CMH tvertex DXSSD 3.3136582 0.0012715 hyper CortSM_thalamus COBRE tvertex DXSSD 4.2908063 0.0000777 hyper CortSM_thalamus ds000030 tvertex DXSSD 2.9539752 0.0037109 hyper CortSM_thalamus ZHH tvertex DXSSD 3.0493966 0.0026220 hyper CortSM_thalamus CMH tvolume DXSSD 3.3051020 0.0013071 hyper CortSM_thalamus COBRE tvolume DXSSD 3.2857460 0.0018253 hyper CortSM_thalamus ds000030 tvolume DXSSD 3.3652661 0.0009997 hyper CortSM_thalamus ZHH tvolume DXSSD 2.8726849 0.0045354 hyper CortVA_CortDA CMH pvertex DXSSD 0.2992271 0.7653697 hyper CortVA_CortDA COBRE pvertex DXSSD 0.8381811 0.4057653 hyper CortVA_CortDA ds000030 pvertex DXSSD 2.5048433 0.0134585 hyper CortVA_CortDA ZHH pvertex DXSSD 3.9970354 0.0000919 hyper CortVA_CortDA CMH tvertex DXSSD 1.3019324 0.1958436 hyper CortVA_CortDA COBRE tvertex DXSSD 1.9580026 0.0556051 hyper CortVA_CortDA ds000030 tvertex DXSSD 2.3108891 0.0223774 hyper CortVA_CortDA ZHH tvertex DXSSD 5.5386799 0.0000001 hyper CortVA_CortDA CMH tvolume DXSSD 0.5892500 0.5569838 hyper CortVA_CortDA COBRE tvolume DXSSD 1.0102980 0.3170306 hyper CortVA_CortDA ds000030 tvolume DXSSD 2.1326851 0.0347876 hyper CortVA_CortDA ZHH tvolume DXSSD 4.1205387 0.0000565 hyper CortVA_CortSM CMH pvertex DXSSD 1.6153599 0.1092919 hyper CortVA_CortSM COBRE pvertex DXSSD 1.5024253 0.1390363 hyper CortVA_CortSM ds000030 pvertex DXSSD 1.3767705 0.1708964 hyper CortVA_CortSM ZHH pvertex DXSSD 2.6075617 0.0098472 hyper CortVA_CortSM CMH tvertex DXSSD 2.2490751 0.0266362 hyper CortVA_CortSM COBRE tvertex DXSSD 2.1582143 0.0355498 hyper CortVA_CortSM ds000030 tvertex DXSSD 1.9500228 0.0532770 hyper CortVA_CortSM ZHH tvertex DXSSD 3.1850716 0.0016930 hyper CortVA_CortSM CMH tvolume DXSSD 2.0241833 0.0455400 hyper CortVA_CortSM COBRE tvolume DXSSD 1.0814293 0.2844960 hyper CortVA_CortSM ds000030 tvolume DXSSD 2.3857152 0.0184556 hyper CortVA_CortSM ZHH tvolume DXSSD 2.7749333 0.0060759 hyper CortVA_CortVA CMH pvertex DXSSD 2.1372824 0.0349418 hyper CortVA_CortVA COBRE pvertex DXSSD 0.3699214 0.7129434 hyper CortVA_CortVA ds000030 pvertex DXSSD 1.3116572 0.1918955 hyper CortVA_CortVA ZHH pvertex DXSSD 1.8901839 0.0602638 hyper CortVA_CortVA CMH tvertex DXSSD 2.4551448 0.0157576 hyper CortVA_CortVA COBRE tvertex DXSSD 1.1507836 0.2550857 hyper CortVA_CortVA ds000030 tvertex DXSSD 1.9664282 0.0513315 hyper CortVA_CortVA ZHH tvertex DXSSD 2.1283381 0.0346044 hyper CortVA_CortVA CMH tvolume DXSSD 3.2968060 0.0013424 hyper CortVA_CortVA COBRE tvolume DXSSD 0.9239841 0.3597625 hyper CortVA_CortVA ds000030 tvolume DXSSD 1.9892648 0.0487236 hyper CortVA_CortVA ZHH tvolume DXSSD 2.7604507 0.0063408 hyper CortVA_CortVI CMH pvertex DXSSD 0.5588492 0.5774776 hyper CortVA_CortVI COBRE pvertex DXSSD 0.9161408 0.3638223 hyper CortVA_CortVI ds000030 pvertex DXSSD 2.9314519 0.0039730 hyper CortVA_CortVI ZHH pvertex DXSSD 1.3241213 0.1870619 hyper CortVA_CortVI CMH tvertex DXSSD 2.0369499 0.0442201 hyper CortVA_CortVI COBRE tvertex DXSSD 1.4368822 0.1567414 hyper CortVA_CortVI ds000030 tvertex DXSSD 2.9004484 0.0043616 hyper CortVA_CortVI ZHH tvertex DXSSD 1.8544161 0.0652376 hyper CortVA_CortVI CMH tvolume DXSSD 0.9415708 0.3486156 hyper CortVA_CortVI COBRE tvolume DXSSD 1.2382158 0.2211972 hyper CortVA_CortVI ds000030 tvolume DXSSD 2.5586346 0.0116281 hyper CortVA_CortVI ZHH tvolume DXSSD 2.3273490 0.0210058 hyper CortVI_cerebellum CMH pvertex DXSSD 2.2787608 0.0247447 hyper CortVI_cerebellum COBRE pvertex DXSSD 1.5018198 0.1391923 hyper CortVI_cerebellum ds000030 pvertex DXSSD 1.7930824 0.0752324 hyper CortVI_cerebellum ZHH pvertex DXSSD 2.5000908 0.0132673 hyper CortVI_cerebellum CMH tvertex DXSSD 2.6449713 0.0094490 hyper CortVI_cerebellum COBRE tvertex DXSSD 2.2157861 0.0311078 hyper CortVI_cerebellum ds000030 tvertex DXSSD 1.4820312 0.1406975 hyper CortVI_cerebellum ZHH tvertex DXSSD 2.6113165 0.0097435 hyper CortVI_cerebellum CMH tvolume DXSSD 2.3025141 0.0233173 hyper CortVI_cerebellum COBRE tvolume DXSSD 2.5327720 0.0143731 hyper CortVI_cerebellum ds000030 tvolume DXSSD 0.6903728 0.4911628 hyper CortVI_cerebellum ZHH tvolume DXSSD 2.1089153 0.0362691 hyper CortVI_striatum CMH pvertex DXSSD 2.1041169 0.0378026 hyper CortVI_striatum COBRE pvertex DXSSD 2.3129868 0.0247127 hyper CortVI_striatum ds000030 pvertex DXSSD 0.8651578 0.3885100 hyper CortVI_striatum ZHH pvertex DXSSD 2.6957528 0.0076566 hyper CortVI_striatum CMH tvertex DXSSD 2.5190951 0.0133030 hyper CortVI_striatum COBRE tvertex DXSSD 1.8755302 0.0663393 hyper CortVI_striatum ds000030 tvertex DXSSD 0.3711250 0.7111349 hyper CortVI_striatum ZHH tvertex DXSSD 3.3376546 0.0010175 hyper CortVI_striatum CMH tvolume DXSSD 2.4910229 0.0143349 hyper CortVI_striatum COBRE tvolume DXSSD 2.0765706 0.0428000 hyper CortVI_striatum ds000030 tvolume DXSSD -0.2333819 0.8158237 hyper CortVI_striatum ZHH tvolume DXSSD 2.9649067 0.0034179 hyper CortVI_thalamus CMH pvertex DXSSD 2.8413063 0.0054165 hyper CortVI_thalamus COBRE pvertex DXSSD 3.3199867 0.0016504 hyper CortVI_thalamus ds000030 pvertex DXSSD 2.8797013 0.0046407 hyper CortVI_thalamus ZHH pvertex DXSSD 4.3317063 0.0000240 hyper CortVI_thalamus CMH tvertex DXSSD 3.5259834 0.0006313 hyper CortVI_thalamus COBRE tvertex DXSSD 2.9895612 0.0042599 hyper CortVI_thalamus ds000030 tvertex DXSSD 2.5927574 0.0105861 hyper CortVI_thalamus ZHH tvertex DXSSD 4.4414525 0.0000152 hyper CortVI_thalamus CMH tvolume DXSSD 2.7877410 0.0063218 hyper CortVI_thalamus COBRE tvolume DXSSD 2.6026136 0.0120259 hyper CortVI_thalamus ds000030 tvolume DXSSD 1.5882270 0.1146095 hyper CortVI_thalamus ZHH tvolume DXSSD 3.4112535 0.0007908 hypo cerebellum_striatum CMH pvertex DXSSD -3.0963067 0.0025245 hypo cerebellum_striatum COBRE pvertex DXSSD -1.7046852 0.0942218 hypo cerebellum_striatum ds000030 pvertex DXSSD -2.9317301 0.0039697 hypo cerebellum_striatum ZHH pvertex DXSSD -2.6933717 0.0077095 hypo cerebellum_striatum CMH tvertex DXSSD -3.0963067 0.0025245 hypo cerebellum_striatum COBRE tvertex DXSSD -1.7046852 0.0942218 hypo cerebellum_striatum ds000030 tvertex DXSSD -2.9317301 0.0039697 hypo cerebellum_striatum ZHH tvertex DXSSD -2.6933717 0.0077095 hypo cerebellum_striatum CMH tvolume DXSSD -3.0963067 0.0025245 hypo cerebellum_striatum COBRE tvolume DXSSD -1.7046852 0.0942218 hypo cerebellum_striatum ds000030 tvolume DXSSD -2.9317301 0.0039697 hypo cerebellum_striatum ZHH tvolume DXSSD -2.6933717 0.0077095 hypo cerebellum_thalamus CMH pvertex DXSSD -4.4093631 0.0000255 hypo cerebellum_thalamus COBRE pvertex DXSSD -2.7128837 0.0090232 hypo cerebellum_thalamus ds000030 pvertex DXSSD -4.9151729 0.0000026 hypo cerebellum_thalamus ZHH pvertex DXSSD -3.3185502 0.0010855 hypo cerebellum_thalamus CMH tvertex DXSSD -4.4093631 0.0000255 hypo cerebellum_thalamus COBRE tvertex DXSSD -2.7128837 0.0090232 hypo cerebellum_thalamus ds000030 tvertex DXSSD -4.9151729 0.0000026 hypo cerebellum_thalamus ZHH tvertex DXSSD -3.3185502 0.0010855 hypo cerebellum_thalamus CMH tvolume DXSSD -4.4093631 0.0000255 hypo cerebellum_thalamus COBRE tvolume DXSSD -2.7128837 0.0090232 hypo cerebellum_thalamus ds000030 tvolume DXSSD -4.9151729 0.0000026 hypo cerebellum_thalamus ZHH tvolume DXSSD -3.3185502 0.0010855 hypo CortDM_CortDA CMH pvertex DXSSD -2.2633220 0.0257132 hypo CortDM_CortDA COBRE pvertex DXSSD -0.5518928 0.5833860 hypo CortDM_CortDA ds000030 pvertex DXSSD -2.5942432 0.0105427 hypo CortDM_CortDA ZHH pvertex DXSSD -3.0115844 0.0029544 hypo CortDM_CortDA CMH tvertex DXSSD -2.9727421 0.0036752 hypo CortDM_CortDA COBRE tvertex DXSSD -0.7169275 0.4766268 hypo CortDM_CortDA ds000030 tvertex DXSSD -2.3672312 0.0193631 hypo CortDM_CortDA ZHH tvertex DXSSD -3.4046095 0.0008091 hypo CortDM_CortDA CMH tvolume DXSSD -2.5547593 0.0120884 hypo CortDM_CortDA COBRE tvolume DXSSD -2.8642430 0.0060155 hypo CortDM_CortDA ds000030 tvolume DXSSD -2.1526593 0.0331503 hypo CortDM_CortDA ZHH tvolume DXSSD -0.7317792 0.4652097 hypo CortDM_CortSM CMH pvertex DXSSD -1.2227402 0.2242183 hypo CortDM_CortSM COBRE pvertex DXSSD -1.7926330 0.0788494 hypo CortDM_CortSM ds000030 pvertex DXSSD -2.4579947 0.0152579 hypo CortDM_CortSM ZHH pvertex DXSSD -3.2721498 0.0012689 hypo CortDM_CortSM CMH tvertex DXSSD -1.7064379 0.0909400 hypo CortDM_CortSM COBRE tvertex DXSSD -2.4694162 0.0168541 hypo CortDM_CortSM ds000030 tvertex DXSSD -2.6823457 0.0082383 hypo CortDM_CortSM ZHH tvertex DXSSD -3.5906619 0.0004204 hypo CortDM_CortSM CMH tvolume DXSSD -1.8754587 0.0635618 hypo CortDM_CortSM COBRE tvolume DXSSD -2.6711976 0.0100665 hypo CortDM_CortSM ds000030 tvolume DXSSD -2.5253502 0.0127323 hypo CortDM_CortSM ZHH tvolume DXSSD -0.7356404 0.4628615 hypo CortDM_CortVA CMH pvertex DXSSD -1.5536565 0.1233337 hypo CortDM_CortVA COBRE pvertex DXSSD -1.3633770 0.1786377 hypo CortDM_CortVA ds000030 pvertex DXSSD -2.3778204 0.0188385 hypo CortDM_CortVA ZHH pvertex DXSSD -2.5782813 0.0106903 hypo CortDM_CortVA CMH tvertex DXSSD -3.1938009 0.0018632 hypo CortDM_CortVA COBRE tvertex DXSSD -1.6096112 0.1135376 hypo CortDM_CortVA ds000030 tvertex DXSSD -2.5482363 0.0119635 hypo CortDM_CortVA ZHH tvertex DXSSD -3.5584969 0.0004717 hypo CortDM_CortVA CMH tvolume DXSSD -2.6095904 0.0104148 hypo CortDM_CortVA COBRE tvolume DXSSD -2.6460322 0.0107487 hypo CortDM_CortVA ds000030 tvolume DXSSD -2.2605360 0.0254127 hypo CortDM_CortVA ZHH tvolume DXSSD -1.5431111 0.1244765 hypo CortFP_cerebellum CMH pvertex DXSSD -1.8640329 0.0651650 hypo CortFP_cerebellum COBRE pvertex DXSSD -2.5639438 0.0132784 hypo CortFP_cerebellum ds000030 pvertex DXSSD -2.2399346 0.0267548 hypo CortFP_cerebellum ZHH pvertex DXSSD -2.9427926 0.0036601 hypo CortFP_cerebellum CMH tvertex DXSSD -2.2907139 0.0240171 hypo CortFP_cerebellum COBRE tvertex DXSSD -2.4153505 0.0192704 hypo CortFP_cerebellum ds000030 tvertex DXSSD -2.8915977 0.0044787 hypo CortFP_cerebellum ZHH tvertex DXSSD -3.6513489 0.0003376 hypo CortFP_cerebellum CMH tvolume DXSSD -2.8755374 0.0049018 hypo CortFP_cerebellum COBRE tvolume DXSSD -1.8974105 0.0633327 hypo CortFP_cerebellum ds000030 tvolume DXSSD -1.7251933 0.0868154 hypo CortFP_cerebellum ZHH tvolume DXSSD -4.2257289 0.0000370 hypo CortFP_CortFP CMH pvertex DXSSD -1.6731597 0.0973305 hypo CortFP_CortFP COBRE pvertex DXSSD 0.3493518 0.7282360 hypo CortFP_CortFP ds000030 pvertex DXSSD -0.7434515 0.4585197 hypo CortFP_CortFP ZHH pvertex DXSSD -3.6065586 0.0003970 hypo CortFP_CortFP CMH tvertex DXSSD -1.8360996 0.0692274 hypo CortFP_CortFP COBRE tvertex DXSSD -0.2780994 0.7820388 hypo CortFP_CortFP ds000030 tvertex DXSSD -2.8573028 0.0049604 hypo CortFP_CortFP ZHH tvertex DXSSD -3.0638281 0.0025046 hypo CortFP_CortFP CMH tvolume DXSSD -3.3101909 0.0012858 hypo CortFP_CortFP COBRE tvolume DXSSD -2.4271889 0.0187161 hypo CortFP_CortFP ds000030 tvolume DXSSD -2.3062922 0.0226406 hypo CortFP_CortFP ZHH tvolume DXSSD -1.0110559 0.3132823 hypo CortFP_striatum CMH pvertex DXSSD -2.4147377 0.0175098 hypo CortFP_striatum COBRE pvertex DXSSD -1.8834410 0.0652386 hypo CortFP_striatum ds000030 pvertex DXSSD -1.1380990 0.2571251 hypo CortFP_striatum ZHH pvertex DXSSD -2.2468438 0.0258066 hypo CortFP_striatum CMH tvertex DXSSD -2.7568944 0.0069038 hypo CortFP_striatum COBRE tvertex DXSSD -1.6221875 0.1108114 hypo CortFP_striatum ds000030 tvertex DXSSD -1.5316896 0.1279742 hypo CortFP_striatum ZHH tvertex DXSSD -3.0340831 0.0027522 hypo CortFP_striatum CMH tvolume DXSSD -2.6833867 0.0084927 hypo CortFP_striatum COBRE tvolume DXSSD -1.7291973 0.0897069 hypo CortFP_striatum ds000030 tvolume DXSSD -1.8493262 0.0666307 hypo CortFP_striatum ZHH tvolume DXSSD -3.4132667 0.0007853 hypo CortFP_thalamus CMH pvertex DXSSD -1.9009225 0.0601075 hypo CortFP_thalamus COBRE pvertex DXSSD -0.7720949 0.4435532 hypo CortFP_thalamus ds000030 pvertex DXSSD -1.9223307 0.0567024 hypo CortFP_thalamus ZHH pvertex DXSSD -2.5039691 0.0131274 hypo CortFP_thalamus CMH tvertex DXSSD -2.4140058 0.0175430 hypo CortFP_thalamus COBRE tvertex DXSSD -1.5225140 0.1339389 hypo CortFP_thalamus ds000030 tvertex DXSSD -1.9850730 0.0491937 hypo CortFP_thalamus ZHH tvertex DXSSD -2.9610832 0.0034587 hypo CortFP_thalamus CMH tvolume DXSSD -2.2441952 0.0269590 hypo CortFP_thalamus COBRE tvolume DXSSD -1.7469572 0.0865490 hypo CortFP_thalamus ds000030 tvolume DXSSD -2.4916303 0.0139457 hypo CortFP_thalamus ZHH tvolume DXSSD -4.2368316 0.0000354 hypo CortSM_CortSM CMH pvertex DXSSD -1.0052551 0.3171298 hypo CortSM_CortSM COBRE pvertex DXSSD -2.3501482 0.0225958 hypo CortSM_CortSM ds000030 pvertex DXSSD -1.3614729 0.1756663 hypo CortSM_CortSM ZHH pvertex DXSSD -3.5478244 0.0004899 hypo CortSM_CortSM CMH tvertex DXSSD -1.1561610 0.2502900 hypo CortSM_CortSM COBRE tvertex DXSSD -1.7990767 0.0778107 hypo CortSM_CortSM ds000030 tvertex DXSSD -1.4335279 0.1540537 hypo CortSM_CortSM ZHH tvertex DXSSD -3.3772053 0.0008890 hypo CortSM_CortSM CMH tvolume DXSSD -0.8402091 0.4027373 hypo CortSM_CortSM COBRE tvolume DXSSD -2.9399465 0.0048884 hypo CortSM_CortSM ds000030 tvolume DXSSD -1.0223597 0.3084667 hypo CortSM_CortSM ZHH tvolume DXSSD -2.8804466 0.0044298 hypo CortVA_cerebellum CMH pvertex DXSSD -2.0409770 0.0438105 hypo CortVA_cerebellum COBRE pvertex DXSSD -1.5409779 0.1293861 hypo CortVA_cerebellum ds000030 pvertex DXSSD -0.3592037 0.7200123 hypo CortVA_cerebellum ZHH pvertex DXSSD -3.1014579 0.0022207 hypo CortVA_cerebellum CMH tvertex DXSSD -2.6714910 0.0087790 hypo CortVA_cerebellum COBRE tvertex DXSSD -1.5870681 0.1185601 hypo CortVA_cerebellum ds000030 tvertex DXSSD -0.9364176 0.3507555 hypo CortVA_cerebellum ZHH tvertex DXSSD -3.3229864 0.0010693 hypo CortVA_cerebellum CMH tvolume DXSSD -2.9829351 0.0035645 hypo CortVA_cerebellum COBRE tvolume DXSSD -1.8215710 0.0742745 hypo CortVA_cerebellum ds000030 tvolume DXSSD -1.1524774 0.2511922 hypo CortVA_cerebellum ZHH tvolume DXSSD -3.2275577 0.0014719 hypo CortVA_striatum CMH pvertex DXSSD -1.4469438 0.1509492 hypo CortVA_striatum COBRE pvertex DXSSD -1.7172511 0.0918844 hypo CortVA_striatum ds000030 pvertex DXSSD -1.6619461 0.0988788 hypo CortVA_striatum ZHH pvertex DXSSD -2.5904398 0.0103326 hypo CortVA_striatum CMH tvertex DXSSD -1.5609376 0.1216059 hypo CortVA_striatum COBRE tvertex DXSSD -1.1787276 0.2438723 hypo CortVA_striatum ds000030 tvertex DXSSD -1.9159367 0.0575191 hypo CortVA_striatum ZHH tvertex DXSSD -3.4643171 0.0006577 hypo CortVA_striatum CMH tvolume DXSSD -2.0800496 0.0400032 hypo CortVA_striatum COBRE tvolume DXSSD -1.6429324 0.1064310 hypo CortVA_striatum ds000030 tvolume DXSSD -2.7928557 0.0059958 hypo CortVA_striatum ZHH tvolume DXSSD -3.9148156 0.0001262 hypo CortVI_CortVI CMH pvertex DXSSD -1.6274546 0.1066960 hypo CortVI_CortVI COBRE pvertex DXSSD -1.7971835 0.0781147 hypo CortVI_CortVI ds000030 pvertex DXSSD -0.6112232 0.5420951 hypo CortVI_CortVI ZHH pvertex DXSSD -4.0672489 0.0000698 hypo CortVI_CortVI CMH tvertex DXSSD -2.6039224 0.0105776 hypo CortVI_CortVI COBRE tvertex DXSSD -1.5946657 0.1168477 hypo CortVI_CortVI ds000030 tvertex DXSSD -0.6962678 0.4874762 hypo CortVI_CortVI ZHH tvertex DXSSD -4.0623396 0.0000712 hypo CortVI_CortVI CMH tvolume DXSSD -1.3924146 0.1667957 hypo CortVI_CortVI COBRE tvolume DXSSD -3.0038151 0.0040938 hypo CortVI_CortVI ds000030 tvolume DXSSD -0.7798490 0.4368653 hypo CortVI_CortVI ZHH tvolume DXSSD -2.3588096 0.0193544 hypo thalamus_striatum CMH pvertex DXSSD -1.1485601 0.2533978 hypo thalamus_striatum COBRE pvertex DXSSD -1.7359431 0.0884964 hypo thalamus_striatum ds000030 pvertex DXSSD -3.0191939 0.0030391 hypo thalamus_striatum ZHH pvertex DXSSD -3.8137435 0.0001852 hypo thalamus_striatum CMH tvertex DXSSD -1.1485601 0.2533978 hypo thalamus_striatum COBRE tvertex DXSSD -1.7359431 0.0884964 hypo thalamus_striatum ds000030 tvertex DXSSD -3.0191939 0.0030391 hypo thalamus_striatum ZHH tvertex DXSSD -3.8137435 0.0001852 hypo thalamus_striatum CMH tvolume DXSSD -1.1485601 0.2533978 hypo thalamus_striatum COBRE tvolume DXSSD -1.7359431 0.0884964 hypo thalamus_striatum ds000030 tvolume DXSSD -3.0191939 0.0030391 hypo thalamus_striatum ZHH tvolume DXSSD -3.8137435 0.0001852 FC_gscores_lmfitbySite_mFC %&gt;% mutate(node_class = if_else(str_detect(edge_group,&#39;_Cort&#39;), &quot;Within_Cortical&quot;, &quot;Subcortical_to&quot;)) %&gt;% filter(term == &quot;DXSSD&quot;, node_class == &quot;Subcortical_to&quot;) %&gt;% ggplot(aes(y = abs(statistic), x = rev(vertex_type), color = effect_direction)) + geom_point() + geom_line(aes(group = edge_group)) + facet_wrap(~Site) wFC_corrs &lt;- all_subject_FC_weights %&gt;% filter(vertex_type == &quot;pvertex&quot;) %&gt;% select(subject, dataset, edge_group, wFC_score) %&gt;% spread(edge_group, wFC_score) %&gt;% select(-subject, -dataset) %&gt;% cor(.) heatmap(abs(wFC_corrs)) "]
]

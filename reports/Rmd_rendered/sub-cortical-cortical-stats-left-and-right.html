<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 7 Sub-cortical Cortical Stats Left and Right | SSD PINT analyses</title>
  <meta name="description" content="This contains the analysis reported with the SSD pint paper">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 7 Sub-cortical Cortical Stats Left and Right | SSD PINT analyses" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This contains the analysis reported with the SSD pint paper" />
  <meta name="github-repo" content="https://github.com/TIGRLab/STOP-PD_ACNP" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Sub-cortical Cortical Stats Left and Right | SSD PINT analyses" />
  
  <meta name="twitter:description" content="This contains the analysis reported with the SSD pint paper" />
  

<meta name="author" content="Erin Dickie">


<meta name="date" content="2020-02-13">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="seedcorr-area-stats.html">
<link rel="next" href="is-pint-focusing-cortical-subcortical-connectivity.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-stats in SSD PINT paper</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> The index page</a></li>
<li class="chapter" data-level="2" data-path="mangle-participant-demographics.html"><a href="mangle-participant-demographics.html"><i class="fa fa-check"></i><b>2</b> Mangle participant demographics</a><ul>
<li class="chapter" data-level="2.1" data-path="mangle-participant-demographics.html"><a href="mangle-participant-demographics.html#coding-zhh-data-by-session"><i class="fa fa-check"></i><b>2.1</b> Coding ZHH data by session</a></li>
<li class="chapter" data-level="2.2" data-path="mangle-participant-demographics.html"><a href="mangle-participant-demographics.html#note---re-picking-motion-cutoffs"><i class="fa fa-check"></i><b>2.2</b> Note - re picking motion cutoffs</a></li>
<li class="chapter" data-level="2.3" data-path="mangle-participant-demographics.html"><a href="mangle-participant-demographics.html#now-looking-at-what-we-have-from-cobre"><i class="fa fa-check"></i><b>2.3</b> Now looking at what we have from COBRE</a></li>
<li class="chapter" data-level="2.4" data-path="mangle-participant-demographics.html"><a href="mangle-participant-demographics.html#now-looking-at-the-cnp-we-have.."><i class="fa fa-check"></i><b>2.4</b> Now looking at the CNP we have..</a></li>
<li class="chapter" data-level="2.5" data-path="mangle-participant-demographics.html"><a href="mangle-participant-demographics.html#add-where-are-is-the-cmh-demographic-info.."><i class="fa fa-check"></i><b>2.5</b> add where are is the CMH demographic info..</a></li>
<li class="chapter" data-level="2.6" data-path="mangle-participant-demographics.html"><a href="mangle-participant-demographics.html#extra-little-bit-for-traking-down-missing-cobre"><i class="fa fa-check"></i><b>2.6</b> extra little bit for traking down “missing” COBRE</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html"><i class="fa fa-check"></i><b>3</b> Check completion and add MR QA</a><ul>
<li class="chapter" data-level="3.1" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#get-a-list-of-available-bold-and-t1w-files-from-the-mriqc-outputs"><i class="fa fa-check"></i><b>3.1</b> Get a list of available bold and T1w files (from the mriqc outputs)</a><ul>
<li class="chapter" data-level="3.1.1" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#the-list-of-usable-scans-is-all-participants-with-both-t1w-and-bold-data"><i class="fa fa-check"></i><b>3.1.1</b> the list of usable scans is all participants with both T1w and bold data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#now-glob-for-all-of-the-pint-outputs"><i class="fa fa-check"></i><b>3.2</b> now glob for all of the PINT outputs</a></li>
<li class="chapter" data-level="3.3" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#read-in-the-combined-demographics-from-the-last-chapter"><i class="fa fa-check"></i><b>3.3</b> read in the combined demographics from the last chapter</a></li>
<li class="chapter" data-level="3.4" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#also-read-in-an-concatenate-all-the-surface-area-info-from-freesurfer"><i class="fa fa-check"></i><b>3.4</b> also read in an concatenate all the surface area info from freesurfer</a></li>
<li class="chapter" data-level="3.5" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#anti-join-the-pheno-data-with-the-usable-scan-data-to-see-if-we-have-everything.."><i class="fa fa-check"></i><b>3.5</b> anti-join the pheno data with the usable scan data to see if we have everything..</a></li>
<li class="chapter" data-level="3.6" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#setting-the-motion-threshold"><i class="fa fa-check"></i><b>3.6</b> Setting the motion threshold:</a></li>
<li class="chapter" data-level="3.7" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#who-is-still-missing-a-pint-output"><i class="fa fa-check"></i><b>3.7</b> who is still missing a PINT output?</a></li>
<li class="chapter" data-level="3.8" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#selecting-scans-with-least-motion"><i class="fa fa-check"></i><b>3.8</b> Selecting scans with least motion</a></li>
<li class="chapter" data-level="3.9" data-path="check-completion-and-add-mr-qa.html"><a href="check-completion-and-add-mr-qa.html#final-mangle-of-the-phenotypic-data-transforming-variables"><i class="fa fa-check"></i><b>3.9</b> final mangle of the phenotypic data (transforming variables)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stats-on-the-pint-summary-displacement-values.html"><a href="stats-on-the-pint-summary-displacement-values.html"><i class="fa fa-check"></i><b>4</b> Stats on the PINT summary displacement values</a><ul>
<li class="chapter" data-level="4.1" data-path="stats-on-the-pint-summary-displacement-values.html"><a href="stats-on-the-pint-summary-displacement-values.html#the-paths-to-data"><i class="fa fa-check"></i><b>4.1</b> The paths to data</a></li>
<li class="chapter" data-level="4.2" data-path="stats-on-the-pint-summary-displacement-values.html"><a href="stats-on-the-pint-summary-displacement-values.html#run-for-the-whole-head"><i class="fa fa-check"></i><b>4.2</b> run for the whole head</a></li>
<li class="chapter" data-level="4.3" data-path="stats-on-the-pint-summary-displacement-values.html"><a href="stats-on-the-pint-summary-displacement-values.html#run-linear-model-per-edge"><i class="fa fa-check"></i><b>4.3</b> run linear model per edge</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multi-dimensional-scaling-stats-on-pint-roi-locations.html"><a href="multi-dimensional-scaling-stats-on-pint-roi-locations.html"><i class="fa fa-check"></i><b>5</b> Multi-Dimensional Scaling Stats on PINT ROI locations</a></li>
<li class="chapter" data-level="6" data-path="seedcorr-area-stats.html"><a href="seedcorr-area-stats.html"><i class="fa fa-check"></i><b>6</b> Seedcorr Area Stats</a><ul>
<li class="chapter" data-level="6.1" data-path="seedcorr-area-stats.html"><a href="seedcorr-area-stats.html#the-paths-to-data-1"><i class="fa fa-check"></i><b>6.1</b> The paths to data</a></li>
<li class="chapter" data-level="6.2" data-path="seedcorr-area-stats.html"><a href="seedcorr-area-stats.html#known-issues"><i class="fa fa-check"></i><b>6.2</b> Known issues</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sub-cortical-cortical-stats-left-and-right.html"><a href="sub-cortical-cortical-stats-left-and-right.html"><i class="fa fa-check"></i><b>7</b> Sub-cortical Cortical Stats Left and Right</a><ul>
<li class="chapter" data-level="7.1" data-path="sub-cortical-cortical-stats-left-and-right.html"><a href="sub-cortical-cortical-stats-left-and-right.html#the-paths-to-data-2"><i class="fa fa-check"></i><b>7.1</b> The paths to data</a><ul>
<li class="chapter" data-level="7.1.1" data-path="sub-cortical-cortical-stats-left-and-right.html"><a href="sub-cortical-cortical-stats-left-and-right.html#this-reads-all-the-subcortical-files-it-can-find"><i class="fa fa-check"></i><b>7.1.1</b> This reads all the subcortical files it can find</a></li>
<li class="chapter" data-level="7.1.2" data-path="sub-cortical-cortical-stats-left-and-right.html"><a href="sub-cortical-cortical-stats-left-and-right.html#merge-with-the-phenotypic-data"><i class="fa fa-check"></i><b>7.1.2</b> merge with the phenotypic data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sub-cortical-cortical-stats-left-and-right.html"><a href="sub-cortical-cortical-stats-left-and-right.html#make-a-subject-table-from-resuts-pheno"><i class="fa fa-check"></i><b>7.2</b> make a subject table from resuts pheno</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="is-pint-focusing-cortical-subcortical-connectivity.html"><a href="is-pint-focusing-cortical-subcortical-connectivity.html"><i class="fa fa-check"></i><b>8</b> Is PINT “focusing” cortical subcortical connectivity</a></li>
<li class="chapter" data-level="9" data-path="trying-to-calculate-an-vs-off-diagonal-term.html"><a href="trying-to-calculate-an-vs-off-diagonal-term.html"><i class="fa fa-check"></i><b>9</b> trying to calculate an vs off diagonal term</a></li>
<li class="chapter" data-level="10" data-path="cortical-cortical-results.html"><a href="cortical-cortical-results.html"><i class="fa fa-check"></i><b>10</b> Cortical-cortical results</a><ul>
<li class="chapter" data-level="10.1" data-path="cortical-cortical-results.html"><a href="cortical-cortical-results.html#to-do---rainclouds-for-withing-between-changes-in-cortical-cortical"><i class="fa fa-check"></i><b>10.1</b> To do - rainclouds for withing between changes in cortical cortical??</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="whole-connectome-results.html"><a href="whole-connectome-results.html"><i class="fa fa-check"></i><b>11</b> Whole Connectome Results</a><ul>
<li class="chapter" data-level="11.1" data-path="whole-connectome-results.html"><a href="whole-connectome-results.html#the-paths-to-data-3"><i class="fa fa-check"></i><b>11.1</b> The paths to data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="code-for-reading-in-all-the-timeseries-.html"><a href="code-for-reading-in-all-the-timeseries-.html"><i class="fa fa-check"></i><b>12</b> Code for reading in all the timeseries..</a><ul>
<li class="chapter" data-level="12.1" data-path="code-for-reading-in-all-the-timeseries-.html"><a href="code-for-reading-in-all-the-timeseries-.html#this-was-run-once-in-order-to-detemine-the-too-small-subcortical-rois"><i class="fa fa-check"></i><b>12.1</b> This was run once in order to detemine the too small subcortical ROIs</a><ul>
<li class="chapter" data-level="12.1.1" data-path="code-for-reading-in-all-the-timeseries-.html"><a href="code-for-reading-in-all-the-timeseries-.html#this-reads-all-the-subcortical-files-it-can-find-1"><i class="fa fa-check"></i><b>12.1.1</b> This reads all the subcortical files it can find</a></li>
<li class="chapter" data-level="12.1.2" data-path="code-for-reading-in-all-the-timeseries-.html"><a href="code-for-reading-in-all-the-timeseries-.html#merge-with-the-phenotypic-data-1"><i class="fa fa-check"></i><b>12.1.2</b> merge with the phenotypic data</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="code-for-reading-in-all-the-timeseries-.html"><a href="code-for-reading-in-all-the-timeseries-.html#filters-out-some-unwanted-edges-before-fdr-correction"><i class="fa fa-check"></i><b>12.2</b> filters out some unwanted edges before FDR correction</a></li>
<li class="chapter" data-level="12.3" data-path="code-for-reading-in-all-the-timeseries-.html"><a href="code-for-reading-in-all-the-timeseries-.html#make-co"><i class="fa fa-check"></i><b>12.3</b> Make co</a></li>
<li class="chapter" data-level="12.4" data-path="code-for-reading-in-all-the-timeseries-.html"><a href="code-for-reading-in-all-the-timeseries-.html#make-table-fdr-corrected-edges-that-survive-correction"><i class="fa fa-check"></i><b>12.4</b> make table FDR corrected Edges that survive correction</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="calculate-weighted-subject-scores-by-chopping-up-the-matrix.html"><a href="calculate-weighted-subject-scores-by-chopping-up-the-matrix.html"><i class="fa fa-check"></i><b>13</b> calculate weighted subject scores by chopping up the matrix</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SSD PINT analyses</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sub-cortical-cortical-stats-left-and-right" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Sub-cortical Cortical Stats Left and Right</h1>
<p>This analysis tries to combine timeseries data from PINT outputs with subcortical timeseries to ask two questions</p>
<ol style="list-style-type: decimal">
<li>“External” validation of PINT. If PINT is indeed helping us better target meaningful resting state networks than we should see “cleaner” patterns of between the PINT output cortical ROIs and parcels of the subcortical structure that have been associated with these networks in literature.</li>
</ol>
<ul>
<li>i.e. connectivity of the cortical ROIS with “expected” subcortical parcel should increae and correlation with other parcels should decrease after PINT.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>To interograte SSD related differences in Cortical-Subcortical connectivity - and to see if they persist after PINT.</li>
</ol>
<p>Some work Ji (in prep) kinda suggests that there might be differences between left and right subcortical structures. AND spliting the left and right seemed to make more sense for whole brain correlations (because our cortical nodes have a hemisphere). So in this analysis have separate left and right ROIs</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.1.0       ✔ purrr   0.2.5  
## ✔ tibble  2.0.1       ✔ dplyr   0.8.0.1
## ✔ tidyr   0.8.2       ✔ stringr 1.3.1  
## ✔ readr   1.3.0       ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(tableone)
<span class="kw">library</span>(cowplot)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggridges)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;ggridges&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     scale_discrete_manual</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(here)</code></pre></div>
<pre><code>## here() starts at /mnt/tigrlab/projects/edickie/code/SZ_PINT</code></pre>
<div id="the-paths-to-data-2" class="section level2">
<h2><span class="header-section-number">7.1</span> The paths to data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&#39;code/R/settings_helpers.R&#39;</span>))
pheno &lt;-<span class="st"> </span><span class="kw">read_pheno_file</span>()</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   dataset = col_character(),
##   subject_id = col_character(),
##   session_id = col_character(),
##   task_id = col_character(),
##   run_id = col_character(),
##   acq_id = col_character(),
##   subject = col_character(),
##   session = col_character(),
##   cmh_session_id = col_character(),
##   DX = col_character(),
##   Sex = col_character(),
##   Site = col_character(),
##   Scanner = col_character(),
##   isFEP = col_character(),
##   ghost_NoGhost = col_character(),
##   filename = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">YeoNet_colours &lt;-<span class="st"> </span><span class="kw">define_Yeo7_colours</span>()
Yeo7_2011_80verts &lt;-<span class="st"> </span><span class="kw">read_Yeo72011_template</span>()
the_subcortical_guide &lt;-<span class="st"> </span><span class="kw">get_subcortical_guide</span>()</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   subcort_hemi = col_character(),
##   subcort_ROI = col_character(),
##   numvx = col_double(),
##   network = col_character()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">node_annotations &lt;-<span class="st"> </span><span class="kw">get_node_annotations</span>(Yeo7_2011_80verts, the_subcortical_guide)
<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&#39;code/R/custom_plot_helpers.R&#39;</span>))

<span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&#39;code/R/file_reading_helpers.R&#39;</span>))</code></pre></div>
<p>This reads all files and generate PINT to subcortical correlation values for a given subject</p>
<div id="this-reads-all-the-subcortical-files-it-can-find" class="section level3">
<h3><span class="header-section-number">7.1.1</span> This reads all the subcortical files it can find</h3>
<p>Write a func_base and outputprefix cols into the pheno file for the file reading step</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pheno &lt;-<span class="st"> </span>pheno <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">func_base =</span> <span class="kw">get_func_base_from_pint_summary_filename</span>(filename,subject, session), 
         <span class="dt">outputprefix =</span> <span class="kw">construct_output_prefix</span>(subject, session, func_base)) </code></pre></div>
<p>a litle chunck I use to test if test if the reader is working…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">run_read_all_subject_timeseries_and_subcortcort_corZ</span>(pheno<span class="op">$</span>outputprefix[<span class="dv">1</span>], pheno<span class="op">$</span>dataset[<span class="dv">1</span>])</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all_subcort_results &lt;-<span class="st"> </span>pheno <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(subject, outputprefix, dataset) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subcort_corrs =</span> <span class="kw">map2</span>(outputprefix, dataset,
                              <span class="op">~</span><span class="kw">run_read_all_subject_timeseries_and_subcortcort_corZ</span>(.x, .y)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(all_subcort_results, <span class="dt">file =</span> <span class="kw">here</span>(<span class="st">&quot;data/processed/Rdata_cache/03_subcort_results_cache.Rdata&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">here</span>(<span class="st">&quot;data/processed/Rdata_cache/03_subcort_results_cache.Rdata&quot;</span>))</code></pre></div>
</div>
<div id="merge-with-the-phenotypic-data" class="section level3">
<h3><span class="header-section-number">7.1.2</span> merge with the phenotypic data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results_pheno &lt;-<span class="st"> </span>all_subcort_results <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(pheno, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;subject&quot;</span>, <span class="st">&quot;dataset&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(the_subcortical_guide, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;combined_name&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">YeoNet =</span> <span class="kw">str_sub</span>(PINT_ROI, <span class="dv">1</span>,<span class="dv">2</span>),
         <span class="dt">hemisphere =</span> <span class="kw">str_sub</span>(PINT_ROI, <span class="dv">5</span>,<span class="dv">5</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">conn_type =</span> <span class="kw">if_else</span>(YeoNet <span class="op">==</span><span class="st"> </span>subcort_NET, <span class="st">&quot;same_net&quot;</span>, <span class="st">&quot;diff_net&quot;</span>),
         <span class="dt">YeoNet =</span> <span class="kw">factor</span>(YeoNet, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;VI&quot;</span>, <span class="st">&quot;SM&quot;</span>, <span class="st">&quot;DA&quot;</span>, <span class="st">&quot;VA&quot;</span>, <span class="st">&quot;FP&quot;</span>, <span class="st">&quot;DM&quot;</span>)),
         <span class="dt">subcort_NET =</span> <span class="kw">factor</span>(subcort_NET, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;VI&quot;</span>, <span class="st">&quot;SM&quot;</span>, <span class="st">&quot;DA&quot;</span>, <span class="st">&quot;VA&quot;</span>, <span class="st">&quot;FP&quot;</span>, <span class="st">&quot;DM&quot;</span>, <span class="st">&quot;LI&quot;</span>))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(subject, dataset, PINT_ROI, subcort_ROI, subcort_NET,subcort_hemi, 
         pvertex_corr, tvertex_corr, tvolume_corr,
         DX, Sex, fd_mean, Age, Site, Scanner, Age_pt, fd_mean_pt,  
         YeoNet, hemisphere, conn_type) </code></pre></div>
</div>
</div>
<div id="make-a-subject-table-from-resuts-pheno" class="section level2">
<h2><span class="header-section-number">7.2</span> make a subject table from resuts pheno</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tableone)
therealtable1 &lt;-<span class="st"> </span><span class="kw">CreateTableOne</span>(
  <span class="dt">strata =</span> <span class="kw">c</span>(<span class="st">&quot;DX&quot;</span>, <span class="st">&quot;Site&quot;</span>),
  <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;fd_mean&quot;</span>, <span class="st">&quot;fd_perc&quot;</span>),
  <span class="dt">data =</span> <span class="kw">filter</span>(results_pheno, PINT_ROI<span class="op">==</span><span class="st">&quot;DMP1L&quot;</span>,subcort_ROI<span class="op">==</span><span class="st">&quot;thalamus&quot;</span>, subcort_NET<span class="op">==</span><span class="st">&quot;VA&quot;</span>, subcort_hemi <span class="op">==</span><span class="st"> &quot;L&quot;</span>)
)</code></pre></div>
<pre><code>## Warning in ModuleReturnVarsExist(vars, data): The data frame does not have:
## fd_perc Dropped</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabMat &lt;-<span class="st"> </span><span class="kw">print</span>(therealtable1, <span class="dt">quote =</span> <span class="ot">FALSE</span>, <span class="dt">noSpaces =</span> <span class="ot">TRUE</span>, <span class="dt">printToggle =</span> <span class="ot">FALSE</span>)
<span class="kw">kable</span>(tabMat)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">CTRL:CMH</th>
<th align="left">SSD:CMH</th>
<th align="left">CTRL:COBRE</th>
<th align="left">SSD:COBRE</th>
<th align="left">CTRL:ds000030</th>
<th align="left">SSD:ds000030</th>
<th align="left">CTRL:ZHH</th>
<th align="left">SSD:ZHH</th>
<th align="left">p</th>
<th align="left">test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td align="left">41</td>
<td align="left">67</td>
<td align="left">35</td>
<td align="left">22</td>
<td align="left">107</td>
<td align="left">31</td>
<td align="left">111</td>
<td align="left">83</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>Age (mean (SD))</td>
<td align="left">26.37 (6.67)</td>
<td align="left">32.19 (8.47)</td>
<td align="left">33.17 (9.01)</td>
<td align="left">29.55 (12.14)</td>
<td align="left">30.42 (8.14)</td>
<td align="left">35.23 (9.32)</td>
<td align="left">25.07 (6.55)</td>
<td align="left">25.83 (8.98)</td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>Sex = M (%)</td>
<td align="left">22 (53.7)</td>
<td align="left">40 (59.7)</td>
<td align="left">23 (65.7)</td>
<td align="left">19 (86.4)</td>
<td align="left">55 (51.4)</td>
<td align="left">24 (77.4)</td>
<td align="left">48 (43.2)</td>
<td align="left">63 (75.9)</td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
</tr>
<tr class="even">
<td>fd_mean (mean (SD))</td>
<td align="left">0.10 (0.04)</td>
<td align="left">0.12 (0.06)</td>
<td align="left">0.18 (0.04)</td>
<td align="left">0.21 (0.08)</td>
<td align="left">0.14 (0.07)</td>
<td align="left">0.18 (0.07)</td>
<td align="left">0.12 (0.04)</td>
<td align="left">0.12 (0.06)</td>
<td align="left">&lt;0.001</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tableone)
therealtable1 &lt;-<span class="st"> </span><span class="kw">CreateTableOne</span>(
  <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;DX&quot;</span>, <span class="st">&quot;fd_mean&quot;</span>, <span class="st">&quot;fd_perc&quot;</span>),
  <span class="dt">data =</span> <span class="kw">filter</span>(results_pheno, PINT_ROI<span class="op">==</span><span class="st">&quot;DMP1L&quot;</span>,subcort_ROI<span class="op">==</span><span class="st">&quot;thalamus&quot;</span>, subcort_NET<span class="op">==</span><span class="st">&quot;VA&quot;</span>, subcort_hemi <span class="op">==</span><span class="st"> &quot;L&quot;</span>)
)</code></pre></div>
<pre><code>## Warning in ModuleReturnVarsExist(vars, data): The data frame does not have:
## fd_perc Dropped</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabMat &lt;-<span class="st"> </span><span class="kw">print</span>(therealtable1, <span class="dt">quote =</span> <span class="ot">FALSE</span>, <span class="dt">noSpaces =</span> <span class="ot">TRUE</span>, <span class="dt">printToggle =</span> <span class="ot">FALSE</span>)
<span class="kw">kable</span>(tabMat)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Overall</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td align="left">497</td>
</tr>
<tr class="even">
<td>Age (mean (SD))</td>
<td align="left">28.82 (8.85)</td>
</tr>
<tr class="odd">
<td>Sex = M (%)</td>
<td align="left">294 (59.2)</td>
</tr>
<tr class="even">
<td>DX = SSD (%)</td>
<td align="left">203 (40.8)</td>
</tr>
<tr class="odd">
<td>fd_mean (mean (SD))</td>
<td align="left">0.14 (0.06)</td>
</tr>
</tbody>
</table>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="seedcorr-area-stats.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="is-pint-focusing-cortical-subcortical-connectivity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TIGRLab/SZ_PINT/edit/master/03_subcortical_cortical_stats_hemi.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["SSD_PINT_full.pdf"],
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
